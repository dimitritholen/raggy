[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.12.11
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:10:38
Run started:2025-11-16 11:54:49.530423

Test results:
>> Issue: [B413:blacklist] The pyCrypto library and its module AES are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:60:4
59	try:
60	    from Crypto.Cipher import AES, ARC4  # type: ignore[import]
61	    from Crypto.Util.Padding import pad  # type: ignore[import]

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module pad are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:61:4
60	    from Crypto.Cipher import AES, ARC4  # type: ignore[import]
61	    from Crypto.Util.Padding import pad  # type: ignore[import]
62	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:293:17
292	        a = _padding(password)
293	        u_hash = hashlib.md5(a)
294	        u_hash.update(o_entry)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:303:32
302	            for _ in range(50):
303	                u_hash_digest = hashlib.md5(u_hash_digest[:length]).digest()
304	        return u_hash_digest[:length]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:340:24
339	        a = _padding(owner_password)
340	        o_hash_digest = hashlib.md5(a).digest()
341	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:344:32
343	            for _ in range(50):
344	                o_hash_digest = hashlib.md5(o_hash_digest).digest()
345	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:404:17
403	        """
404	        u_hash = hashlib.md5(_PADDING)
405	        u_hash.update(id1_entry)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_encryption.py:747:19
746	        key_data = key[:n] + pack1 + pack2
747	        key_hash = hashlib.md5(key_data)
748	        rc4_key = key_hash.digest()[: min(n + 5, 16)]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_security.py:76:8
75	    # input to this function.
76	    m = md5(password_bytes)
77	    # 3. Pass the value of the encryption dictionary's /O entry to the MD5 hash

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_security.py:100:23
99	        for _ in range(50):
100	            md5_hash = md5(md5_hash[:keylen]).digest()
101	    # 9. Set the encryption key to the first n bytes of the output from the

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_security.py:148:8
147	    # input to this function.
148	    m = md5(password_bytes)
149	    # 3. (Revision 3 or greater) Do the following 50 times: Take the output

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_security.py:154:23
153	        for _ in range(50):
154	            md5_hash = md5(md5_hash).digest()
155	    # 4. Create an RC4 encryption key using the first n bytes of the output

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_security.py:207:8
206	    # shown in step 1 of Algorithm 3.2 as input to this function.
207	    m = md5()
208	    m.update(_encryption_padding)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_writer.py:925:32
924	        O = ByteStringObject(_alg33(owner_password, user_password, rev, keylen))  # type: ignore[arg-type]
925	        ID_1 = ByteStringObject(md5((repr(time.time())).encode("utf8")).digest())
926	        ID_2 = ByteStringObject(md5((repr(random.random())).encode("utf8")).digest())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_writer.py:926:32
925	        ID_1 = ByteStringObject(md5((repr(time.time())).encode("utf8")).digest())
926	        ID_2 = ByteStringObject(md5((repr(random.random())).encode("utf8")).digest())
927	        self._ID = ArrayObject((ID_1, ID_2))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/_writer.py:1014:31
1013	                    assert len(key) == (len(self._encrypt_key) + 5)
1014	                    md5_hash = md5(key).digest()
1015	                    key = md5_hash[: min(16, len(self._encrypt_key) + 5)]

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: ./.venv/lib/python3.11/site-packages/PyPDF2/xmp.py:223:33
222	            data = self.stream.get_data()
223	            doc_root: Document = parseString(data)
224	        except ExpatError as e:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/anyio/_backends/_trio.py:1144:28
1143	                stderr=stderr,
1144	                shell=True,
1145	                **kwargs,
1146	            )
1147	        else:
1148	            process = await trio.lowlevel.open_process(
1149	                [convert_item(item) for item in command],
1150	                stdin=stdin,
1151	                stdout=stdout,
1152	                stderr=stderr,

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.11/site-packages/anyio/_core/_sockets.py:490:25
489	    else:
490	        local_address = ("0.0.0.0", 0)
491	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/anyio/streams/tls.py:247:22
246	    async def send_eof(self) -> None:
247	        tls_version = self.extra(TLSAttribute.tls_version)
248	        match = re.match(r"TLSv(\d+)(?:\.(\d+))?", tls_version)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/anyio/to_interpreter.py:123:22
122	            if fmt == FMT_PICKLED:
123	                res = pickle.loads(res)
124	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/anyio/to_process.py:86:17
85	
86	        retval = pickle.loads(pickled_response)
87	        if status == b"EXCEPTION":

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/anyio/to_process.py:210:29
209	        try:
210	            command, *args = pickle.load(stdin.buffer)
211	        except EOFError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/attr/_make.py:227:4
226	    bytecode = compile(script, filename, "exec")
227	    eval(bytecode, globs, locs)
228	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to httpx with timeout set to None
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/api/async_fastapi.py:134:39
133	            limits = httpx.Limits(keepalive_expiry=self.keepalive_secs)
134	            self._clients[loop_hash] = httpx.AsyncClient(
135	                timeout=None,
136	                headers=headers,
137	                verify=self._settings.chroma_server_ssl_verify or False,
138	                limits=limits,
139	            )
140	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to httpx with timeout set to None
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/api/fastapi.py:83:24
82	        limits = httpx.Limits(keepalive_expiry=self.keepalive_secs)
83	        self._session = httpx.Client(timeout=None, limits=limits)
84	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/cli/cli.py:25:19
24	        url = f"https://api.github.com/repos/chroma-core/chroma/releases"
25	        response = requests.get(url)
26	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/db/migrations.py:262:17
261	            if sys.version_info >= (3, 9)
262	            else hashlib.md5(sql.encode("utf-8")).hexdigest()
263	        )

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/chromadb/segment/impl/vector/local_persistent_hnsw.py:75:39
74	        with open(filename, "rb") as f:
75	            ret = cast(PersistentData, pickle.load(f))
76	            return ret

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/test/conftest.py:246:13
245	        server.app(),
246	        host="0.0.0.0",
247	        port=port,

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/chromadb/test/property/test_cross_version_persist.py:47:21
46	    url = "https://pypi.org/pypi/chromadb/json"
47	    data = json.load(request.urlopen(request.Request(url)))
48	    versions = list(data["releases"].keys())

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.11/site-packages/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:322:20
321	                    # In versions prior to 3.12, this provides the same behavior as filter="data"
322	                    tar.extractall(path=self.DOWNLOAD_PATH)
323	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/click/_termui_impl.py:453:8
452	        [str(cmd_path)] + cmd_params,
453	        shell=True,
454	        stdin=subprocess.PIPE,
455	        env=env,
456	        errors="replace",
457	        text=True,
458	    )
459	    assert c.stdin is not None
460	    try:
461	        for text in generator:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/docx/image/image.py:151:15
150	        """SHA1 hash digest of the image blob."""
151	        return hashlib.sha1(self._blob).hexdigest()
152	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/docx/parts/image.py:80:15
79	        """SHA1 hash digest of the blob of this image part."""
80	        return hashlib.sha1(self.blob).hexdigest()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/fsspec/implementations/cache_metadata.py:64:25
63	            with open(fn, "rb") as f:
64	                loaded = pickle.load(f)
65	        for c in loaded.values():

--------------------------------------------------
>> Issue: [B402:blacklist] A FTP-related module is being imported.  FTP is considered insecure. Use SSH/SFTP/SCP or some other encrypted protocol.
   Severity: High   Confidence: High
   CWE: CWE-319 (https://cwe.mitre.org/data/definitions/319.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b402-import-ftplib
   Location: ./.venv/lib/python3.11/site-packages/fsspec/implementations/ftp.py:3:0
2	import uuid
3	from ftplib import FTP, FTP_TLS, Error, error_perm
4	from typing import Any

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/implementations/ftp.py:64:34
63	        self.port = port
64	        self.tempdir = tempdir or "/tmp"
65	        self.cred = username or "", password or "", acct or ""

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/implementations/sftp.py:45:51
44	        super().__init__(**ssh_kwargs)
45	        self.temppath = ssh_kwargs.pop("temppath", "/tmp")  # remote temp directory
46	        self.host = host

--------------------------------------------------
>> Issue: [B507:ssh_no_host_key_verification] Paramiko call with policy set to automatically trust the unknown host key.
   Severity: High   Confidence: Medium
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b507_ssh_no_host_key_verification.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/implementations/sftp.py:53:8
52	        self.client = paramiko.SSHClient()
53	        self.client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
54	        self.client.connect(self.host, **self.ssh_kwargs)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/__init__.py:228:23
227	        for i in range(10):
228	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
229	            path = some_join(source, f"{hashed_i}.txt")

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/copy.py:548:23
547	        for i in range(10):
548	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
549	            source_files.append(fs_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/get.py:576:23
575	        for i in range(10):
576	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
577	            source_files.append(fs_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/mv.py:36:8
35	    if os.name == "nt":
36	        os.system(f'icacls "{protected_path}" /deny Everyone:(W)')
37	    else:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o555 on file (protected_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/mv.py:38:8
37	    else:
38	        os.chmod(protected_path, 0o555)  # Sets the directory to read-only
39	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/mv.py:55:8
54	    if os.name == "nt":
55	        os.system(f'icacls "{protected_path}" /remove:d Everyone')
56	    else:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (protected_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/mv.py:57:8
56	    else:
57	        os.chmod(protected_path, 0o755)  # Restore write permission for cleanup

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/tests/abstract/put.py:582:23
581	        for i in range(10):
582	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
583	            source_files.append(local_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/fsspec/utils.py:320:12
319	    try:
320	        h = md5(str(args).encode())
321	    except ValueError:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/functorch/dim/magic_trace.py:13:54
12	@contextmanager
13	def magic_trace(output="trace.fxt", magic_trace_cache="/tmp/magic-trace"):
14	    pid = os.getpid()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/functorch/einops/rearrange.py:149:4
148	
149	    exec(custom_rearrange_callable_code)
150	    return locals()[custom_rearrange_callable_name]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/google/protobuf/proto_builder.py:68:16
67	  # proto files.
68	  fields_hash = hashlib.sha1()
69	  for f_name, f_type in field_items:

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/httpcore/_backends/anyio.py:84:19
83	        if info == "ssl_object":
84	            return self._stream.extra(anyio.streams.tls.TLSAttribute.ssl_object, None)
85	        if info == "client_addr":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/httpcore/_backends/anyio.py:86:19
85	        if info == "client_addr":
86	            return self._stream.extra(anyio.abc.SocketAttribute.local_address, None)
87	        if info == "server_addr":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/httpcore/_backends/anyio.py:88:19
87	        if info == "server_addr":
88	            return self._stream.extra(anyio.abc.SocketAttribute.remote_address, None)
89	        if info == "socket":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/httpcore/_backends/anyio.py:90:19
89	        if info == "socket":
90	            return self._stream.extra(anyio.abc.SocketAttribute.raw_socket, None)
91	        if info == "is_readable":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.11/site-packages/httpcore/_backends/anyio.py:92:19
91	        if info == "is_readable":
92	            sock = self._stream.extra(anyio.abc.SocketAttribute.raw_socket, None)
93	            return is_socket_readable(sock)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/httpx/_auth.py:309:15
308	
309	        return hashlib.sha1(s).hexdigest()[:16].encode()
310	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/_local_folder.py:447:36
446	def _short_hash(filename: str) -> str:
447	    return base64.urlsafe_b64encode(hashlib.sha1(filename.encode()).digest()).decode()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/cli/download.py:149:19
148	        if len(self.filenames) == 1:
149	            return hf_hub_download(
150	                repo_id=self.repo_id,
151	                repo_type=self.repo_type,
152	                revision=self.revision,
153	                filename=self.filenames[0],
154	                cache_dir=self.cache_dir,
155	                force_download=self.force_download,
156	                token=self.token,
157	                local_dir=self.local_dir,
158	                library_name="huggingface-cli",
159	            )
160	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/cli/download.py:169:15
168	
169	        return snapshot_download(
170	            repo_id=self.repo_id,
171	            repo_type=self.repo_type,
172	            revision=self.revision,
173	            allow_patterns=allow_patterns,
174	            ignore_patterns=ignore_patterns,
175	            force_download=self.force_download,
176	            cache_dir=self.cache_dir,
177	            token=self.token,
178	            local_dir=self.local_dir,
179	            library_name="huggingface-cli",
180	            max_workers=self.max_workers,
181	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/commands/download.py:170:19
169	        if len(self.filenames) == 1:
170	            return hf_hub_download(
171	                repo_id=self.repo_id,
172	                repo_type=self.repo_type,
173	                revision=self.revision,
174	                filename=self.filenames[0],
175	                cache_dir=self.cache_dir,
176	                resume_download=self.resume_download,
177	                force_download=self.force_download,
178	                token=self.token,
179	                local_dir=self.local_dir,
180	                library_name="huggingface-cli",
181	            )
182	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/commands/download.py:191:15
190	
191	        return snapshot_download(
192	            repo_id=self.repo_id,
193	            repo_type=self.repo_type,
194	            revision=self.revision,
195	            allow_patterns=allow_patterns,
196	            ignore_patterns=ignore_patterns,
197	            resume_download=self.resume_download,
198	            force_download=self.force_download,
199	            cache_dir=self.cache_dir,
200	            token=self.token,
201	            local_dir=self.local_dir,
202	            library_name="huggingface-cli",
203	            max_workers=self.max_workers,
204	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/fastai_utils.py:319:25
318	    if not os.path.isdir(repo_id):
319	        storage_folder = snapshot_download(
320	            repo_id=repo_id,
321	            revision=revision,
322	            library_name="fastai",
323	            library_version=get_fastai_version(),
324	        )
325	    else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/hf_api.py:6504:15
6503	        headers = self._build_hf_headers(token=token)
6504	        resp = requests.post(path, headers=headers, json=body)
6505	        hf_raise_for_status(resp)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/hf_api.py:10861:49
10860	            pre_command = ["python", "-c", '"' + "; ".join(pre_command) + '"']
10861	            command = ["uv", "run"] + uv_args + ["/tmp/script.py"] + script_args
10862	            command = ["bash", "-c", " ".join(pre_command) + " && " + " ".join(command)]

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/inference/_mcp/utils.py:118:12
117	        repo_dir = Path(
118	            snapshot_download(
119	                repo_id=DEFAULT_REPO_ID,
120	                allow_patterns=f"{agent_path}/*",
121	                repo_type="dataset",
122	            )
123	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/keras_mixin.py:481:29
480	        if not os.path.isdir(model_id):
481	            storage_folder = snapshot_download(
482	                repo_id=model_id,
483	                revision=revision,
484	                cache_dir=cache_dir,
485	                library_name="keras",
486	                library_version=get_tf_version(),
487	            )
488	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/repocard.py:176:16
175	            card_path = Path(
176	                hf_hub_download(
177	                    repo_id_or_path,
178	                    constants.REPOCARD_NAME,
179	                    repo_type=repo_type or cls.repo_type,
180	                    token=token,
181	                )
182	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/huggingface_hub/serialization/_torch.py:645:11
644	
645	    return load(
646	        checkpoint_file,
647	        map_location=map_location,
648	        **additional_kwargs,
649	    )
650	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (pathname).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.11/site-packages/humanfriendly/testing.py:528:8
527	            handle.write('exit %i\n' % self.program_returncode)
528	        os.chmod(pathname, 0o755)
529	        return directory

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/jinja2/bccache.py:73:19
72	        # the source code of the file changed, we need to reload
73	        checksum = pickle.load(f)
74	        if self.checksum != checksum:

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b302-marshal
   Location: ./.venv/lib/python3.11/site-packages/jinja2/bccache.py:79:24
78	        try:
79	            self.code = marshal.load(f)
80	        except (EOFError, ValueError, TypeError):

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/bccache.py:156:15
155	        """Returns the unique hash key for this template name."""
156	        hash = sha1(name.encode("utf-8"))
157	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/bccache.py:165:15
164	        """Returns a checksum for the source."""
165	        return sha1(source.encode("utf-8")).hexdigest()
166	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/debug.py:145:8
144	    try:
145	        exec(code, globals, locals)
146	    except BaseException:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/environment.py:1228:8
1227	        namespace = {"environment": environment, "__file__": code.co_filename}
1228	        exec(code, namespace)
1229	        rv = cls._from_namespace(environment, namespace, globals)

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/environment.py:1544:15
1543	    def __html__(self) -> Markup:
1544	        return Markup(concat(self._body_stream))
1545	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/ext.py:176:17
175	        if __context.eval_ctx.autoescape:
176	            rv = Markup(rv)
177	        # Always treat as a format string, even if there are no

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/ext.py:197:17
196	        if __context.eval_ctx.autoescape:
197	            rv = Markup(rv)
198	        # Always treat as a format string, see gettext comment above.

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/ext.py:213:17
212	        if __context.eval_ctx.autoescape:
213	            rv = Markup(rv)
214	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/ext.py:238:17
237	        if __context.eval_ctx.autoescape:
238	            rv = Markup(rv)
239	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:316:13
315	    if eval_ctx.autoescape:
316	        rv = Markup(rv)
317	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:820:13
819	    if eval_ctx.autoescape:
820	        rv = Markup(rv)
821	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:851:20
850	    if isinstance(s, Markup):
851	        indention = Markup(indention)
852	        newline = Markup(newline)

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:852:18
851	        indention = Markup(indention)
852	        newline = Markup(newline)
853	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:1056:11
1055	
1056	    return Markup(str(value)).striptags()
1057	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/filters.py:1377:11
1376	    """
1377	    return Markup(value)
1378	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/loaders.py:661:25
660	    def get_template_key(name: str) -> str:
661	        return "tmpl_" + sha1(name.encode("utf-8")).hexdigest()
662	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/nodes.py:619:19
618	        if eval_ctx.autoescape:
619	            return Markup(self.data)
620	        return self.data

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/nodes.py:1091:15
1090	        eval_ctx = get_eval_context(self, eval_ctx)
1091	        return Markup(self.expr.as_const(eval_ctx))
1092	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/nodes.py:1112:19
1111	        if eval_ctx.autoescape:
1112	            return Markup(expr)
1113	        return expr

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/runtime.py:375:19
374	        if self._context.eval_ctx.autoescape:
375	            return Markup(rv)
376	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/runtime.py:389:19
388	        if self._context.eval_ctx.autoescape:
389	            return Markup(rv)
390	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/runtime.py:776:19
775	        if autoescape:
776	            return Markup(rv)
777	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/runtime.py:787:17
786	        if autoescape:
787	            rv = Markup(rv)
788	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/utils.py:403:11
402	        return "\n\n".join(result)
403	    return markupsafe.Markup(
404	        "\n".join(f"<p>{markupsafe.escape(x)}</p>" for x in result)
405	    )
406	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.11/site-packages/jinja2/utils.py:668:11
667	
668	    return markupsafe.Markup(
669	        dumps(obj, **kwargs)
670	        .replace("<", "\\u003c")
671	        .replace(">", "\\u003e")
672	        .replace("&", "\\u0026")
673	        .replace("'", "\\u0027")
674	    )
675	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/_memmapping_reducer.py:40:23
39	# as the default folder to dump big arrays to share with subprocesses.
40	SYSTEM_SHARED_MEM_FS = "/dev/shm"
41	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/externals/loky/backend/popen_loky_posix.py:174:28
173	            try:
174	                prep_data = pickle.load(from_parent)
175	                spawn.prepare(prep_data)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/externals/loky/backend/popen_loky_posix.py:176:30
175	                spawn.prepare(prep_data)
176	                process_obj = pickle.load(from_parent)
177	            finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/externals/loky/backend/popen_loky_win32.py:166:31
165	        try:
166	            preparation_data = load(from_parent)
167	            spawn.prepare(preparation_data, parent_sentinel)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/externals/loky/backend/popen_loky_win32.py:168:19
167	            spawn.prepare(preparation_data, parent_sentinel)
168	            self = load(from_parent)
169	        finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/numpy_pickle.py:175:20
174	            # The array contained Python objects. We need to unpickle the data.
175	            array = pickle.load(unpickler.file_handle)
176	        else:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/common.py:78:23
77	with_dev_shm = skipif(
78	    not os.path.exists("/dev/shm"),
79	    reason="This test requires a large /dev/shm shared memory fs.",

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_hashing.py:228:15
227	    def md5_hash(x):
228	        return hashlib.md5(memoryview(x)).hexdigest()
229	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_hashing.py:350:8
349	    b = {string: "bar"}
350	    c = pickle.loads(pickle.dumps(b))
351	    assert hash([a, b]) == hash([a, c])

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_hashing.py:370:23
369	
370	    dt1_roundtripped = pickle.loads(pickle.dumps(dt1))
371	    assert dt1 is not dt1_roundtripped

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_hashing.py:383:31
382	
383	    complex_dt1_roundtripped = pickle.loads(pickle.dumps(complex_dt1))
384	    assert complex_dt1_roundtripped is not complex_dt1

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memmapping.py:937:28
936	            pool_temp_folder = p._temp_folder
937	            folder_prefix = "/dev/shm/joblib_memmapping_folder_"
938	            assert pool_temp_folder.startswith(folder_prefix)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memmapping.py:993:51
992	            pool_temp_folder = p._temp_folder
993	            assert not pool_temp_folder.startswith("/dev/shm")
994	        finally:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:164:8
163	        my_locals = {}
164	        exec(
165	            compile(
166	                textwrap.dedent(ipython_cell_source),
167	                filename=ipython_cell_id,
168	                mode="exec",
169	            ),
170	            # TODO when Python 3.11 is the minimum supported version, use
171	            # locals=my_locals instead of passing globals and locals in the
172	            # next two lines as positional arguments
173	            None,
174	            my_locals,
175	        )
176	        f = my_locals["f"]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:334:9
333	    memory = Memory(location=tmpdir.strpath, verbose=0)
334	    a1 = eval("lambda x: x")
335	    a1 = memory.cache(a1)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:336:9
335	    a1 = memory.cache(a1)
336	    b1 = eval("lambda x: x+1")
337	    b1 = memory.cache(b1)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:368:8
367	
368	    m = eval("lambda x: x")
369	    mm = memory.cache(m)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:598:8
597	
598	    h = pickle.loads(pickle.dumps(g))
599	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:604:14
603	    assert output == h.store_backend.load_item([h.func_id, args_id])
604	    memory2 = pickle.loads(pickle.dumps(memory))
605	    assert memory.store_backend.location == memory2.store_backend.location

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:609:4
608	    memory = Memory(location=None, verbose=0)
609	    pickle.loads(pickle.dumps(memory))
610	    g = memory.cache(f)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:611:9
610	    g = memory.cache(f)
611	    gp = pickle.loads(pickle.dumps(g))
612	    gp(1)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:704:22
703	        with open(filename, "rb") as fp:
704	            result2 = pickle.load(fp)
705	        assert result2.get() == result.get()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:1219:24
1218	    with raises(TypeError) as excinfo:
1219	        Memory(location="/tmp/joblib", backend="unknown")
1220	    excinfo.match(r"Unknown location*")

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:1340:29
1339	    memorized_result_pickle = pickle.dumps(memorized_result)
1340	    memorized_result_loads = pickle.loads(memorized_result_pickle)
1341	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:1374:22
1373	
1374	    memory_reloaded = pickle.loads(pickle.dumps(memory))
1375	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:1387:27
1386	
1387	    func_cached_reloaded = pickle.loads(pickle.dumps(func_cached))
1388	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_memory.py:1400:32
1399	    memorized_result = func_cached.call_and_shelve(1)
1400	    memorized_result_reloaded = pickle.loads(pickle.dumps(memorized_result))
1401	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/joblib/test/test_store_backends.py:33:27
32	            with open(filename, "rb") as f:
33	                reloaded = cpickle.load(f)
34	            break

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/jsonschema/validators.py:113:9
112	    request = Request(uri, headers=headers)  # noqa: S310
113	    with urlopen(request) as response:  # noqa: S310
114	        warnings.warn(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/jsonschema/validators.py:1225:21
1224	            # json over http
1225	            result = requests.get(uri).json()
1226	        else:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/jsonschema/validators.py:1228:17
1227	            # Otherwise, pass off to urllib and assume utf-8
1228	            with urlopen(uri) as url:  # noqa: S310
1229	                result = json.loads(url.read().decode("utf-8"))

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/kubernetes/config/exec_provider.py:99:18
98	            universal_newlines=True,
99	            shell=self.shell)
100	        (stdout, stderr) = process.communicate()
101	        exit_code = process.wait()
102	        if exit_code != 0:
103	            msg = 'exec: process returned %d' % exit_code
104	            stderr = stderr.strip()
105	            if stderr:
106	                msg += '. %s' % stderr
107	            raise ConfigException(msg)
108	        try:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/kubernetes/dynamic/discovery.py:53:61
52	            # usedforsecurity is only supported in 3.9+
53	            default_cachefile_name = 'osrcp-{0}.json'.format(hashlib.md5(default_cache_id).hexdigest())
54	        self.__cache_file = cache_file or os.path.join(tempfile.gettempdir(), default_cachefile_name)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/lxml/ElementInclude.py:118:16
117	        if "://" in href:
118	            f = urlopen(href)
119	        else:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/lxml/html/__init__.py:1120:11
1119	            data = data.encode('ASCII')
1120	    return urlopen(url, data)
1121	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/lxml/html/html5parser.py:230:13
229	    elif _looks_like_url(filename_url_or_file):
230	        fp = urlopen(filename_url_or_file)
231	        if guess_charset is None:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/identification.py:777:26
776	            namespace = dict((name, getattr(ctx,name)) for name in dir(ctx))
777	            constants = [(eval(p, namespace), p) for p in constants]
778	    else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/mpmath/libmp/backend.py:47:8
46	            _locs_ = _globs_
47	        exec("""exec _code_ in _globs_, _locs_""")
48	else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/extratest_gamma.py:56:8
55	    mp.dps = 1010
56	    z = eval(z)
57	    mp.dps = maxdps + 50

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/extratest_gamma.py:64:23
63	    else:
64	        loggamma_val = eval(result)
65	        gamma_val = exp(loggamma_val)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/runtests.py:159:66
158	        r = tracer.results()
159	        r.write_results(show_missing=True, summary=True, coverdir="/tmp")
160	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_convert.py:88:19
87	            a = mpf(random.random())**0.5 * 10**random.randint(-100, 100)
88	            assert eval(repr(a)) == a
89	    mp.dps = 15

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_linalg.py:181:63
180	              'qr_solve(%s, %s)' % (A, b), 'qr_solve(%s, %s)' % (B, b)]:
181	        pytest.raises((ZeroDivisionError, ValueError), lambda: eval(i))
182	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_matrices.py:25:17
24	    assert A6.tolist() == l
25	    assert A6 == eval(repr(A6))
26	    A6 = fp.matrix(A6)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_matrices.py:27:17
26	    A6 = fp.matrix(A6)
27	    assert A6 == eval(repr(A6))
28	    assert A6*1j == eval(repr(A6*1j))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_matrices.py:28:20
27	    assert A6 == eval(repr(A6))
28	    assert A6*1j == eval(repr(A6*1j))
29	    assert A3 * 10 == 10 * A3 == A6

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_matrices.py:63:4
62	    A5 = matrix([[6, -1], [3, 2], [0, -3]])
63	    exec("assert A4 @ A5 == A4 * A5")
64	

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_pickle.py:8:9
7	def pickler(obj):
8	    fn = tempfile.mktemp()
9	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/mpmath/tests/test_pickle.py:15:11
14	    f = open(fn, 'rb')
15	    obj2 = pickle.load(f)
16	    f.close()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/algorithms/flow/tests/test_maxflow_large_graph.py:56:12
55	    with bz2.BZ2File(fname, "rb") as f:
56	        G = pickle.load(f)
57	    return G

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/algorithms/flow/tests/test_mincost.py:469:16
468	        with bz2.BZ2File(fname, "rb") as f:
469	            G = pickle.load(f)
470	        flowCost, flowDict = nx.network_simplex(G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/algorithms/flow/tests/test_networksimplex.py:180:12
179	    with bz2.BZ2File(fname, "rb") as f:
180	        G = pickle.load(f)
181	    flowCost, flowDict = nx.network_simplex(G)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/networkx/algorithms/operators/tests/test_all.py:28:31
27	        graph, node = n
28	        assert ghj.nodes[n] == eval(graph).nodes[int(node)]
29	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/networkx/algorithms/operators/tests/test_binary.py:23:30
22	        graph, node = n
23	        assert gh.nodes[n] == eval(graph).nodes[int(node)]
24	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_coreviews.py:16:16
15	        view = self.av
16	        pview = pickle.loads(pickle.dumps(view, -1))
17	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_coreviews.py:19:16
18	        assert view.__slots__ == pview.__slots__
19	        pview = pickle.loads(pickle.dumps(view))
20	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_coreviews.py:73:16
72	        view = self.adjview
73	        pview = pickle.loads(pickle.dumps(view, -1))
74	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_coreviews.py:153:16
152	        view = self.av
153	        pview = pickle.loads(pickle.dumps(view, -1))
154	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_coreviews.py:211:16
210	        view = self.adjview
211	        pview = pickle.loads(pickle.dumps(view, -1))
212	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graph.py:610:13
609	        G = self.K3
610	        pg = pickle.loads(pickle.dumps(G, -1))
611	        self.graphs_equal(pg, G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graph.py:612:13
611	        self.graphs_equal(pg, G)
612	        pg = pickle.loads(pickle.dumps(G))
613	        self.graphs_equal(pg, G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graphviews.py:18:14
17	        rv = self.rv
18	        prv = pickle.loads(pickle.dumps(rv, -1))
19	        assert rv._node == prv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graphviews.py:65:14
64	        rv = self.rv
65	        prv = pickle.loads(pickle.dumps(rv, -1))
66	        assert rv._node == prv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graphviews.py:118:14
117	        dv = self.dv
118	        pdv = pickle.loads(pickle.dumps(dv, -1))
119	        assert dv._node == pdv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graphviews.py:157:14
156	        uv = self.uv
157	        puv = pickle.loads(pickle.dumps(uv, -1))
158	        assert uv._node == puv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_graphviews.py:206:16
205	        for G in self.graphs:
206	            H = pickle.loads(pickle.dumps(G, -1))
207	            assert edges_equal(H.edges, G.edges)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:22:14
21	        nv = self.nv
22	        pnv = pickle.loads(pickle.dumps(nv, -1))
23	        assert nv == pnv

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:93:14
92	        nv = self.nv
93	        pnv = pickle.loads(pickle.dumps(nv, -1))
94	        assert nv == pnv

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:278:14
277	        ev = self.eview(self.G)(data=True)
278	        pev = pickle.loads(pickle.dumps(ev, -1))
279	        assert list(ev) == list(pev)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:568:14
567	        ev = self.eview(self.G)
568	        pev = pickle.loads(pickle.dumps(ev, -1))
569	        assert ev == pev

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:1023:15
1022	        deg = self.G.degree
1023	        pdeg = pickle.loads(pickle.dumps(deg, -1))
1024	        assert dict(deg) == dict(pdeg)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/classes/tests/test_reportviews.py:1412:4
1411	    # Raises error if the cached properties and views do not work
1412	    pickle.loads(pickle.dumps(G, -1))
1413	    deepcopy(G)

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/networkx/readwrite/graphml.py:855:23
854	        elif string is not None:
855	            self.xml = fromstring(string)
856	        else:

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/networkx/readwrite/tests/test_graphml.py:1155:14
1154	
1155	        xml = parse(fh)
1156	        # Children are the key elements, and the graph element

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/networkx/readwrite/tests/test_graphml.py:1200:14
1199	
1200	        xml = parse(fh)
1201	        # Children are the key elements, and the graph element

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/networkx/readwrite/tests/test_graphml.py:1327:15
1326	
1327	        tree = parse(fname)
1328	        children = list(tree.getroot())

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/networkx/readwrite/tests/test_graphml.py:1376:15
1375	
1376	        tree = parse(fname)
1377	        children = list(tree.getroot())

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/networkx/tests/test_lazy_imports.py:83:4
82	
83	    exec(s, {}, locls)
84	    expected = {

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/decorators.py:912:8
911	        compiled = compile(code, filename, "exec")
912	        exec(compiled, globl, locl)
913	        func = locl[sig.name]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/tests/test_backends.py:28:15
27	        pickled = pickle.dumps(func.__wrapped__)
28	        assert pickle.loads(pickled) is func.__wrapped__
29	        try:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/tests/test_backends.py:34:15
33	            continue
34	        assert pickle.loads(pickled) is func
35	        count += 1

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/tests/test_backends.py:37:11
36	    assert count > 0
37	    assert pickle.loads(pickle.dumps(nx.inverse_line_graph)) is nx.inverse_line_graph
38	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/tests/test_config.py:47:11
46	    assert set(cfg.items()) == set()
47	    cfg2 = pickle.loads(pickle.dumps(cfg))
48	    assert cfg == cfg2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/networkx/utils/tests/test_config.py:102:11
101	        cfg["z"]
102	    cfg2 = pickle.loads(pickle.dumps(cfg))
103	    assert cfg == cfg2

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/__config__.py:96:20
95	        "Python Information": {
96	            "path": r"/tmp/build-env-c1pjigx9/bin/python",
97	            "version": "3.11",
98	        },
99	        "SIMD Extensions": {
100	            "baseline": __cpu_baseline__,

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test__exceptions.py:19:14
18	        error = _ArrayMemoryError((1023,), np.dtype(np.uint8))
19	        res = pickle.loads(pickle.dumps(error))
20	        assert res._total_size == error._total_size

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test__exceptions.py:84:15
83	        exc = AxisError(*args)
84	        exc2 = pickle.loads(pickle.dumps(exc))
85	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_arrayprint.py:340:21
339	
340	        assert_equal(eval(repr(a), vars(np)), a)
341	        assert_equal(eval(repr(a[0]), {'np': np}), a[0])

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_arrayprint.py:341:21
340	        assert_equal(eval(repr(a), vars(np)), a)
341	        assert_equal(eval(repr(a[0]), {'np': np}), a[0])
342	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_custom_dtypes.py:308:10
307	    s = pickle.dumps(SF)
308	    res = pickle.loads(s)
309	    assert res is SF

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:866:25
865	            dt = np.dtype('M8[7D]')
866	            assert_equal(pickle.loads(pickle.dumps(dt, protocol=proto)), dt)
867	            dt = np.dtype('M8[W]')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:868:25
867	            dt = np.dtype('M8[W]')
868	            assert_equal(pickle.loads(pickle.dumps(dt, protocol=proto)), dt)
869	            scalar = np.datetime64('2016-01-01T00:00:00.000000000')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:870:25
869	            scalar = np.datetime64('2016-01-01T00:00:00.000000000')
870	            assert_equal(pickle.loads(pickle.dumps(scalar, protocol=proto)),
871	                         scalar)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:873:25
872	            delta = scalar - np.datetime64('2015-01-01T00:00:00.000000000')
873	            assert_equal(pickle.loads(pickle.dumps(delta, protocol=proto)),
874	                         delta)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:880:21
879	              b"I7\nI1\nI1\ntp7\ntp8\ntp9\nb."
880	        assert_equal(pickle.loads(pkl), np.dtype('<M8[7D]'))
881	        pkl = b"cnumpy\ndtype\np0\n(S'M8'\np1\nI0\nI1\ntp2\nRp3\n"\

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:884:21
883	              b"I1\nI1\nI1\ntp7\ntp8\ntp9\nb."
884	        assert_equal(pickle.loads(pkl), np.dtype('<M8[W]'))
885	        pkl = b"cnumpy\ndtype\np0\n(S'M8'\np1\nI0\nI1\ntp2\nRp3\n"\

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:888:21
887	              b"I1\nI1\nI1\ntp7\ntp8\ntp9\nb."
888	        assert_equal(pickle.loads(pkl), np.dtype('>M8[us]'))
889	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_datetime.py:895:18
894	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
895	            res = pickle.loads(pickle.dumps(dt, protocol=proto))
896	            assert_equal(res, dt)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_dtype.py:1065:30
1064	                         "'aligned':True}")
1065	        assert_equal(np.dtype(eval(str(dt))), dt)
1066	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_dtype.py:1366:22
1365	            assert b"dtype" in buf
1366	            pickled = pickle.loads(buf)
1367	            assert_equal(pickled, dtype)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_dtype.py:1428:30
1427	        for proto in range(pickle.HIGHEST_PROTOCOL + 1):
1428	            roundtrip_DType = pickle.loads(pickle.dumps(DType, proto))
1429	            assert roundtrip_DType is DType

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_dtype.py:1439:27
1438	        for proto in range(pickle.HIGHEST_PROTOCOL + 1):
1439	            roundtrip_dt = pickle.loads(pickle.dumps(dt, proto))
1440	            assert roundtrip_dt == dt

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:189:19
188	        for v in range(pickle.HIGHEST_PROTOCOL):
189	            vals = pickle.loads(pickle.dumps(a, v))
190	            assert_(vals.flags.writeable)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1549:27
1548	        assert_equal(xx[:].dtype, xx.dtype)
1549	        assert_array_equal(eval(repr(xx), {"np": np, "array": np.array}), xx)
1550	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1701:17
1700	        # It is not easy to create one, one method is to use pickle:
1701	        scalar = pickle.loads(pickle.dumps(scalar))
1702	        assert scalar.flags.owndata

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1855:25
1854	        zs = self._zeros(10, int)
1855	        assert_equal(zs, pickle.loads(zs.dumps()))
1856	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1862:22
1861	                p = pickle.dumps(zs, protocol=proto)
1862	                zs2 = pickle.loads(p)
1863	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1871:18
1870	        pk_dmp = pickle.dumps(arr)
1871	        pk_load = pickle.loads(pk_dmp)
1872	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:1882:28
1881	                                    protocol=5)
1882	        array_from_buffer = pickle.loads(bytes_string, buffers=buffers)
1883	        # when using pickle protocol 5 with buffer callbacks,

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:3939:21
3938	                              }
3939	            MyType = eval("type('MyType', (base,), class_namespace)",
3940	                          eval_namespace)
3941	            if issubclass(MyType, np.ndarray):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4404:40
4403	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
4404	            depickled_arr_with_object = pickle.loads(
4405	                    pickle.dumps(arr_with_object, protocol=proto))
4406	            depickled_arr_without_object = pickle.loads(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4406:43
4405	                    pickle.dumps(arr_with_object, protocol=proto))
4406	            depickled_arr_without_object = pickle.loads(
4407	                    pickle.dumps(arr_without_object, protocol=proto))
4408	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4427:39
4426	
4427	        depickled_f_contiguous_array = pickle.loads(bytes_string,
4428	                                                    buffers=buffers)
4429	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4446:48
4445	
4446	        depickled_transposed_contiguous_array = pickle.loads(bytes_string,
4447	                                                    buffers=buffers)
4448	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4459:24
4458	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2)
4459	        assert_equal(x, pickle.loads(c_contiguous_dumped))
4460	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2, order='F')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4461:24
4460	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2, order='F')
4461	        assert_equal(x, pickle.loads(f_contiguous_dumped))
4462	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2).transpose((1, 0, 2))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4463:24
4462	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2).transpose((1, 0, 2))
4463	        assert_equal(x, pickle.loads(transposed_contiguous_dumped))
4464	        x = np.arange(12, dtype='uint8').reshape(3, 4)[:, :2]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4465:24
4464	        x = np.arange(12, dtype='uint8').reshape(3, 4)[:, :2]
4465	        assert_equal(x, pickle.loads(no_contiguous_dumped))
4466	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4476:45
4475	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
4476	            depickled_non_contiguous_array = pickle.loads(
4477	                    pickle.dumps(non_contiguous_array, protocol=proto,
4478	                                 buffer_callback=buffers.append if proto >= 5 else None))
4479	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4496:27
4495	                assert_equal(
4496	                        a, pickle.loads(pickle.dumps(a, protocol=proto)),
4497	                        err_msg=f"{a!r}")

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4505:15
4504	    def _loads(self, obj):
4505	        return pickle.loads(obj, encoding='latin1')
4506	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:4559:14
4558	
4559	        new = pickle.loads(pickle.dumps(original_byte_reversed))
4560	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_multiarray.py:8312:14
8311	        pickle_obj = pickle.dumps(obj)
8312	        res = pickle.loads(pickle_obj)
8313	        assert_array_equal(res, obj)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_overrides.py:221:27
220	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
221	            roundtripped = pickle.loads(
222	                    pickle.dumps(dispatched_one_arg, protocol=proto))
223	            assert_(roundtripped is dispatched_one_arg)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:170:22
169	
170	        recordarr_r = eval("np." + repr(recordarr), {'np': np})
171	        recarr_r = eval("np." + repr(recarr), {'np': np})

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:171:19
170	        recordarr_r = eval("np." + repr(recordarr), {'np': np})
171	        recarr_r = eval("np." + repr(recarr), {'np': np})
172	        # Prints the type `numpy.record` as part of the dtype:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:173:23
172	        # Prints the type `numpy.record` as part of the dtype:
173	        recordview_r = eval("np." + repr(recordview), {'np': np, 'numpy': np})
174	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:414:28
413	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
414	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
415	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:415:31
414	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
415	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],
416	                                                         protocol=proto)))
417	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:421:28
420	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
421	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
422	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:422:31
421	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
422	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],
423	                                                         protocol=proto)))
424	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:429:17
428	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
429	            pa = pickle.loads(pickle.dumps(a[0], protocol=proto))
430	            assert_(pa.flags.c_contiguous)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_records.py:453:20
452	        dump = pickle.dumps(a[0])
453	        unpickled = pickle.loads(dump)
454	        assert a[0] == unpickled

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:52:20
51	                f.seek(0)
52	                b = pickle.load(f)
53	            assert_array_equal(a, b)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:363:22
362	                f.seek(0)
363	                dt_ = pickle.load(f)
364	            assert_equal(dt, dt_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:489:21
488	        for original, data in test_data:
489	            result = pickle.loads(data, encoding='bytes')
490	            assert_equal(result, original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:833:18
832	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
833	            new = pickle.loads(pickle.dumps(el, protocol=proto))
834	            assert_equal(new, el)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1069:16
1068	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
1069	            y = pickle.loads(pickle.dumps(x, protocol=proto))
1070	            # y is now typically not aligned on a 8-byte boundary

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1082:17
1081	        with open(filename, 'rb') as f:
1082	            xp = pickle.load(f, encoding='latin1')
1083	        xpd = xp.astype(np.float64)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1275:20
1274	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
1275	            assert_(pickle.loads(
1276	                pickle.dumps(test_string, protocol=proto)) == test_string)
1277	            assert_(pickle.loads(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1277:20
1276	                pickle.dumps(test_string, protocol=proto)) == test_string)
1277	            assert_(pickle.loads(
1278	                pickle.dumps(test_record, protocol=proto)) == test_record)
1279	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1907:15
1906	        blob = pickle.dumps(data, protocol=1)
1907	        data = pickle.loads(blob)
1908	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1919:19
1918	            data = np.array([1], dtype='b')
1919	            data = pickle.loads(pickle.dumps(data, protocol=proto))
1920	            data[0] = 0x7d

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1931:17
1930	        # This should work:
1931	        result = pickle.loads(data, encoding='latin1')
1932	        assert_array_equal(result, np.array([129]).astype('b'))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1957:21
1956	        for original, data, koi8r_validity in datas:
1957	            result = pickle.loads(data, encoding='latin1')
1958	            assert_equal(result, original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:1966:25
1965	                # bogus results
1966	                result = pickle.loads(data, encoding='koi8-r')
1967	                assert_(result != original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:2212:25
2211	            test_string = np.bytes_('')
2212	            assert_equal(pickle.loads(
2213	                pickle.dumps(test_string, protocol=proto)), test_string)
2214	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:2436:25
2435	            dumped = pickle.dumps(arr, protocol=proto)
2436	            assert_equal(pickle.loads(dumped), arr)
2437	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_regression.py:2567:17
2566	        test_data = b'\x80\x04\x95(\x00\x00\x00\x00\x00\x00\x00\x8c\x1cnumpy.core._multiarray_umath\x94\x8c\x03add\x94\x93\x94.'
2567	        result = pickle.loads(test_data, encoding='bytes')
2568	        assert result is np.add

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_scalarmath.py:654:21
653	            val_repr = repr(val)
654	            val2 = t(eval(val_repr))
655	            if not (val2 == 0 and val < 1e-100):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:244:15
243	        data_a = self._load_b(data * self._nlanes())
244	        func = eval(intrin)
245	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:510:15
509	        chk_nan = {"xp": 1, "np": 1, "nn": 2, "xn": 2}.get(intrin[-2:], 0)
510	        func = eval(intrin[:3])
511	        reduce_intrin = getattr(self, "reduce_" + intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:640:15
639	        data_a = self.load(data * self.nlanes)
640	        func = eval(intrin)
641	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:701:42
700	            return
701	        npyv_load_tillz, npyv_load_till = eval(intrin)
702	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:721:26
720	            return
721	        npyv_store_till = eval(intrin)
722	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:741:21
740	            return
741	        npyv_loadn = eval(intrin)
742	        for stride in range(-64, 64):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:767:44
766	            return
767	        npyv_loadn_tillz, npyv_loadn_till = eval(intrin)
768	        lanes = list(range(1, self.nlanes + 1))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:804:22
803	            return
804	        npyv_storen = eval(intrin)
805	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:843:27
842	            return
843	        npyv_storen_till = eval(intrin)
844	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:895:17
894	            return
895	        intrin = eval(intrin)
896	        idx_itrin = getattr(self.npyv, f"setall_u{elsize}")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_simd.py:1102:15
1101	        data_a = self.load(data * self.nlanes)
1102	        func = eval(intrin)
1103	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_stringdtype.py:366:14
365	    with open(f.name, "rb") as f:
366	        res = pickle.load(f)
367	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_ufunc.py:204:20
203	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
204	            assert_(pickle.loads(pickle.dumps(np.sin,
205	                                              protocol=proto)) is np.sin)
206	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_ufunc.py:209:18
208	            # such as numpy._core._rational_tests.test_add can also be pickled
209	            res = pickle.loads(pickle.dumps(_rational_tests.test_add,
210	                                            protocol=proto))
211	            assert_(res is _rational_tests.test_add)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_ufunc.py:216:16
215	                   b"(S'numpy._core.umath'\np1\nS'cos'\np2\ntp3\nRp4\n.")
216	        assert_(pickle.loads(astring) is np.cos)
217	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_ufunc.py:226:14
225	
226	        obj = pickle.loads(pickle.dumps(_pickleable_module_global.ufunc))
227	        assert obj is umt._pickleable_module_global_ufunc

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_ufunc.py:501:18
500	        int64 = np.dtype("int64")
501	        int64_2 = pickle.loads(pickle.dumps(int64))
502	        # Relies on pickling behavior, if assert fails just remove test...

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_umath.py:513:25
512	        lsize = 512 + 7
513	        a, b, divisors = eval(ex_val)
514	        a_lst, b_lst = a.tolist(), b.tolist()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_umath.py:577:12
576	        fo = np.iinfo(dtype)
577	        a = eval(ex_val)
578	        lst = a.tolist()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_umath_accuracy.py:71:128
70	                        data_subset = data[data['type'] == datatype]
71	                        inval = np.array(str_to_float(data_subset['input'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
72	                        outval = np.array(str_to_float(data_subset['output'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/_core/tests/test_umath_accuracy.py:72:130
71	                        inval = np.array(str_to_float(data_subset['input'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
72	                        outval = np.array(str_to_float(data_subset['output'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
73	                        perm = np.random.permutation(len(inval))

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/cpuinfo.py:29:25
28	    try:
29	        status, output = getstatusoutput(cmd)
30	    except OSError as e:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/exec_command.py:283:15
282	        # it encounters an invalid character; rather, we simply replace it
283	        proc = subprocess.Popen(command, shell=use_shell, env=env, text=False,
284	                                stdout=subprocess.PIPE,
285	                                stderr=subprocess.STDOUT)
286	    except OSError:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/fcompiler/gnu.py:402:12
401	    def _hash_files(self, filenames):
402	        h = hashlib.sha1()
403	        for fn in filenames:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/lib2def.py:66:8
65	nm_output = getnm(nm_cmd = 'nm -Cs py_lib')"""
66	    p = subprocess.Popen(nm_cmd, shell=shell, stdout=subprocess.PIPE,
67	                         stderr=subprocess.PIPE, text=True)
68	    nm_output, nm_err = p.communicate()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/misc_util.py:157:22
156	    try:
157	        caller_file = eval('__file__', frame.f_globals, frame.f_locals)
158	        d = os.path.dirname(os.path.abspath(caller_file))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/misc_util.py:163:22
162	        # sys.modules['__main__'] might be something else, like easy_install(1).
163	        caller_name = eval('__name__', frame.f_globals, frame.f_locals)
164	        __import__(caller_name)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/misc_util.py:847:34
846	            try:
847	                caller_instance = eval('self', f.f_globals, f.f_locals)
848	                break

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/tests/test_ccompiler_opt.py:805:8
804	    for cc in compilers:
805	        exec(new_test(arch, cc))
806	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/distutils/tests/test_shell_utils.py:48:27
47	        # posix has no non-shell string parsing
48	        return lambda cmd: subprocess.check_output(cmd, shell=True)
49	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/auxfuncs.py:632:11
631	        l2.append('f%d(v)' % (i))
632	    return eval(f"{l1}:{' and '.join(l2)}")
633	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/auxfuncs.py:640:11
639	        l2.append('f%d(v)' % (i))
640	    return eval(f"{l1}:{' or '.join(l2)}")
641	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/auxfuncs.py:644:11
643	def l_not(f):
644	    return eval('lambda v,f=f:not f(v)')
645	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/capi_maps.py:159:16
158	        with open(f2cmap_file) as f:
159	            d = eval(f.read().lower(), {}, {})
160	        f2cmap_all, f2cmap_mapped = process_f2cmap_dict(f2cmap_all, d, c2py_map, True)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/capi_maps.py:296:31
295	        try:
296	            ret['size'] = repr(eval(ret['size']))
297	        except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/capi_maps.py:449:24
448	                else:
449	                    v = eval(v, {}, {})
450	                    ret['init.r'], ret['init.i'] = str(v.real), str(v.imag)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:1329:20
1328	            try:
1329	                v = eval(initexpr, {}, params)
1330	            except (SyntaxError, NameError, TypeError) as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2271:8
2270	    """ Like `eval` but returns only integers and floats """
2271	    r = eval(e, g, l)
2272	    if type(r) in [int, float]:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2559:16
2558	        # TODO: use symbolic from PR #19805
2559	        value = eval(value, {}, params)
2560	        value = (repr if isinstance(value, str) else str)(value)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2637:28
2636	                try:
2637	                    l = str(eval(l, {}, params))
2638	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2646:28
2645	                try:
2646	                    l = str(eval(l, {}, params))
2647	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2914:57
2913	                                try:
2914	                                    kindselect['kind'] = eval(
2915	                                        kindselect['kind'], {}, params)
2916	                                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:2985:16
2984	        try:
2985	            p = eval(v, g_params, params)
2986	        except Exception as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:3016:19
3015	        try:
3016	            item = eval(item, g_params, params)
3017	        except Exception as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/f2py/crackfortran.py:3468:24
3467	                try:
3468	                    v = eval(v)
3469	                    v = f'({v.real},{v.imag})'

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/numpy/lib/_datasource.py:333:17
332	        if self._isurl(path):
333	            with urlopen(path) as openedurl:
334	                with _open(upath, 'wb') as f:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/numpy/lib/_datasource.py:475:26
474	            try:
475	                netfile = urlopen(path)
476	                netfile.close()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/lib/_format_impl.py:838:20
837	        try:
838	            array = pickle.load(fp, **pickle_kwargs)
839	        except UnicodeError as err:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/lib/_npyio_impl.py:494:23
493	            try:
494	                return pickle.load(fid, **pickle_kwargs)
495	            except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:733:32
732	                    a.mask = mask
733	                    a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
734	                    assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:748:24
747	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
748	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
749	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:757:25
756	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
757	            mc_pickled = pickle.loads(pickle.dumps(mc, protocol=proto))
758	            assert_equal(mc_pickled._baseclass, mc._baseclass)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:767:24
766	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
767	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
768	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:777:19
776	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
777	            test = pickle.loads(pickle.dumps(b, protocol=proto))
778	            assert_equal(test, b)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_core.py:5547:22
5546	                f.seek(0)
5547	                res = pickle.load(f)
5548	            assert_(res is np.ma.masked)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_mrecords.py:293:20
292	            _ = pickle.dumps(mrec, protocol=proto)
293	            mrec_ = pickle.loads(_)
294	            assert_equal(mrec_.dtype, mrec.dtype)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/ma/tests/test_old_ma.py:621:16
620	            s = pickle.dumps(x, protocol=proto)
621	            y = pickle.loads(s)
622	            assert_(eq(x, y))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/matrixlib/tests/test_masked_matrix.py:89:24
88	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
89	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
90	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/polynomial/tests/test_polynomial.py:62:12
61	        x = poly.Polynomial([1, 2, 3])
62	        y = pickle.loads(pickle.dumps(x))
63	        assert_equal(x, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_direct.py:303:19
302	        bitgen_pkl = pickle.dumps(bit_generator)
303	        reloaded = pickle.loads(bitgen_pkl)
304	        reloaded_state = reloaded.state

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_direct.py:311:13
310	        ss = SeedSequence(100)
311	        aa = pickle.loads(pickle.dumps(ss))
312	        assert_equal(ss.state, aa.state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_direct.py:321:17
320	        ss = bit_generator.seed_seq
321	        bg_plk = pickle.loads(pickle.dumps(bit_generator))
322	        ss_plk = bg_plk.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_direct.py:327:17
326	        bit_generator.seed_seq.spawn(10)
327	        bg_plk = pickle.loads(pickle.dumps(bit_generator))
328	        ss_plk = bg_plk.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_direct.py:555:18
554	        with gzip.open(pkl_file) as gz:
555	            sfc = pickle.load(gz)
556	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_generator_mt19937.py:2781:13
2780	    ss = rg.bit_generator.seed_seq
2781	    rg_plk = pickle.loads(pickle.dumps(rg))
2782	    ss_plk = rg_plk.bit_generator.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_generator_mt19937.py:2787:13
2786	    rg.bit_generator.seed_seq.spawn(10)
2787	    rg_plk = pickle.loads(pickle.dumps(rg))
2788	    ss_plk = rg_plk.bit_generator.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_generator_mt19937.py:2803:13
2802	    with gzip.open(pkl_file) as gz:
2803	        rg = pickle.load(gz)
2804	    state = rg.bit_generator.state['state']

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_randomstate.py:268:20
267	        assert_equal(pickled['has_gauss'], 1)
268	        rs_unpick = pickle.loads(pickle.dumps(self.random_state))
269	        unpickled = rs_unpick.get_state(legacy=False)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_smoke.py:437:17
436	        pick = pickle.dumps(self.rg)
437	        unpick = pickle.loads(pick)
438	        assert_(type(self.rg) == type(unpick))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/random/tests/test_smoke.py:443:17
442	        pick = pickle.dumps(self.rg)
443	        unpick = pickle.loads(pick)
444	        assert_(type(self.rg) == type(unpick))

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/testing/_private/utils.py:1297:4
1296	def runstring(astr, dict):
1297	    exec(astr, dict)
1298	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/numpy/testing/_private/utils.py:1583:8
1582	        i += 1
1583	        exec(code, globs, locs)
1584	    elapsed = jiffies() - elapsed

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/numpy/tests/test_public_api.py:407:12
406	        try:
407	            eval(module_name)
408	        except AttributeError:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/numpy/tests/test_reloading.py:45:16
44	        assert_equal(repr(np._NoValue), '<no value>')
45	        assert_(pickle.loads(pickle.dumps(np._NoValue,
46	                                          protocol=proto)) is np._NoValue)
47	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/oauthlib/oauth1/rfc5849/__init__.py:223:63
222	        if request.body is not None and content_type_eligible:
223	            params.append(('oauth_body_hash', base64.b64encode(hashlib.sha1(request.body.encode('utf-8')).digest()).decode('utf-8')))  # noqa: S324
224	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/matmul_nbits_quantizer.py:456:23
455	        if "cnn" in dataset_name:
456	            dataset2 = load_dataset("cnn_dailymail", name="3.0.0", split="train").select(range(max_calib_rows_to_load))
457	            column = "article"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/matmul_nbits_quantizer.py:459:23
458	        elif "pile" in dataset_name:
459	            dataset2 = load_dataset("mit-han-lab/pile-val-backup", split="validation")
460	            column = "text"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/neural_compressor/onnx_model.py:63:27
62	
63	            self._config = AutoConfig.from_pretrained(Path(model).parent.as_posix())
64	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/quant_utils.py:990:14
989	        logging.warning(
990	            f"The original model opset version is {opset_version}, which does not support quantization to float 8. "
991	            "Please update the model to opset >= 19. Automatically update the model to opset 19. "
992	            "Please verify the quantized model."
993	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/quant_utils.py:998:14
997	        logging.warning(
998	            f"The original model opset version is {opset_version}, which does not support node fusions. "
999	            "Please update the model to opset >= 11 for better performance."
1000	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/quantization/quant_utils.py:1004:14
1003	        logging.warning(
1004	            f"The original model opset version is {opset_version}, which does not support quantization. "
1005	            "Please update the model to opset >= 11. Automatically update the model to opset 11. "
1006	            "Please verify the quantized model."
1007	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/benchmark.py:224:21
223	            device = "cuda" if use_gpu else "cpu"
224	            config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
225	            max_last_state_size = numpy.prod(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/benchmark.py:337:17
336	    for model_name in model_names:
337	        config = AutoConfig.from_pretrained(model_name, torchscript=torchscript, cache_dir=cache_dir)
338	        config_modifier.modify(config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/benchmark.py:350:24
349	        else:
350	            tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
351	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/benchmark.py:491:17
490	    for model_name in model_names:
491	        config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
492	        config_modifier.modify(config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/benchmark.py:502:20
501	
502	        tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
503	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:2694:17
2693	    if is_gpt2:
2694	        config = GPT2Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2695	    elif args.model_type == "t5":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:2696:17
2695	    elif args.model_type == "t5":
2696	        config = T5Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2697	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:2698:17
2697	    else:
2698	        config = MT5Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2699	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:3157:16
3156	
3157	    tokenizer = GPT2Tokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
3158	    tokenizer.padding_side = "left"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:3161:12
3160	
3161	    model = GPT2LMHeadModel.from_pretrained(
3162	        args.model_name_or_path,
3163	        cache_dir=args.cache_dir,
3164	        pad_token_id=tokenizer.eos_token_id,
3165	    )
3166	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:3372:16
3371	
3372	    tokenizer = T5Tokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
3373	    tokenizer.padding_side = "left"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:3376:16
3375	    if args.model_type == "t5":
3376	        model = T5ForConditionalGeneration.from_pretrained(
3377	            args.model_name_or_path,
3378	            cache_dir=args.cache_dir,
3379	        )
3380	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_generation.py:3381:16
3380	    else:
3381	        model = MT5ForConditionalGeneration.from_pretrained(
3382	            args.model_name_or_path,
3383	            cache_dir=args.cache_dir,
3384	        )
3385	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:58:8
57	def download_compressed_file(tf_ckpt_url, ckpt_dir):
58	    r = requests.get(tf_ckpt_url)
59	    compressed_file_name = tf_ckpt_url.split("/")[-1]

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:112:12
111	        with tarfile.open(tar_dir, "r") as tar_ref:
112	            tar_ref.extractall(ckpt_dir)
113	            os.remove(tar_dir)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:124:16
123	        ]:
124	            r = requests.get(tf_ckpt_url + "/" + filename)
125	            with open(os.path.join(ckpt_dir, filename), "wb") as f:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/large_model_exporter.py:60:12
59	
60	    model = transformers.AutoModelForCausalLM.from_pretrained(  # type: ignore
61	        hf_model, torch_dtype=torch.float16, cache_dir=cache_dir, trust_remote_code=True
62	    )
63	    if tokenizer is None:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/large_model_exporter.py:65:16
64	        tokenizer = hf_model
65	    tokenizer = transformers.AutoTokenizer.from_pretrained(tokenizer)  # type: ignore
66	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/bert/eval_squad.py:220:16
219	    all_results = []
220	    tokenizer = AutoTokenizer.from_pretrained(pretrained_model_name)
221	    for sequence_length in args.sequence_lengths:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/bert/eval_squad.py:242:24
241	        start_time = time.time()
242	        squad_dataset = load_dataset("squad", split=f"validation[:{args.total}]" if args.total > 0 else "validation")
243	        latency = time.time() - start_time

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/gpt2/benchmark_gpt2.py:193:13
192	    gpt2helper = Gpt2Helper
193	    config = AutoConfig.from_pretrained(args.model_name_or_path, torchscript=args.torchscript, cache_dir=cache_dir)
194	    model = model_class.from_pretrained(args.model_name_or_path, config=config, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/gpt2/convert_to_onnx.py:280:13
279	    gpt2helper = Gpt2Helper
280	    config = AutoConfig.from_pretrained(args.model_name_or_path, cache_dir=cache_dir)
281	    model = model_class.from_pretrained(args.model_name_or_path, config=config, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark.py:197:16
196	        start_time = time.time()
197	        model = AutoModelForCausalLM.from_pretrained(
198	            source,
199	            torch_dtype=torch.float16 if args.use_fp16 else torch.float32,
200	            use_auth_token=args.auth,
201	            trust_remote_code=args.auth,
202	            use_cache=True,
203	            cache_dir=args.cache_dir,
204	        ).to(args.target_device)
205	        end_time = time.time()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark.py:663:16
662	    args.world_size = world_size
663	    tokenizer = AutoTokenizer.from_pretrained(
664	        args.model_name, cache_dir=args.cache_dir, use_auth_token=args.auth, trust_remote_code=args.auth
665	    )
666	    config = AutoConfig.from_pretrained(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark.py:666:13
665	    )
666	    config = AutoConfig.from_pretrained(
667	        args.model_name, cache_dir=args.cache_dir, use_auth_token=args.auth, trust_remote_code=args.auth
668	    )
669	    target_device = f"cuda:{args.rank}" if args.device != "cpu" else args.device

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:67:20
66	
67	            model = AutoModelForCausalLM.from_pretrained(
68	                args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
69	                cache_dir=args.cache_dir,
70	                torch_dtype=args.torch_dtype,
71	                use_auth_token=args.auth,
72	                trust_remote_code=args.trust,
73	                use_cache=True,
74	                attn_implementation="flash_attention_2",
75	                quantization_config=bnb_config,
76	                max_memory={args.device_id: "80GB"},
77	            )
78	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:80:24
79	            try:
80	                model = AutoModelForCausalLM.from_pretrained(
81	                    args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
82	                    cache_dir=args.cache_dir,
83	                    torch_dtype=args.torch_dtype,
84	                    use_auth_token=args.auth,
85	                    trust_remote_code=args.trust,
86	                    use_cache=True,
87	                    attn_implementation=("flash_attention_2" if args.device == "cuda" else "sdpa"),
88	                ).to(args.target_device)
89	            except Exception as e:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:93:24
92	                print("Try to load a model using eager mode: ", e)
93	                model = AutoModelForCausalLM.from_pretrained(
94	                    args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
95	                    cache_dir=args.cache_dir,
96	                    torch_dtype=args.torch_dtype,
97	                    use_auth_token=args.auth,
98	                    trust_remote_code=args.trust,
99	                    use_cache=True,
100	                    attn_implementation="eager",
101	                ).to(args.target_device)
102	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:365:13
364	    # Get config, tokenizer, and model
365	    config = AutoConfig.from_pretrained(
366	        args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
367	        cache_dir=args.cache_dir,
368	        use_auth_token=args.auth,
369	        trust_remote_code=args.trust,
370	    )
371	    tokenizer = AutoTokenizer.from_pretrained(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:371:16
370	    )
371	    tokenizer = AutoTokenizer.from_pretrained(
372	        args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
373	        cache_dir=args.cache_dir,
374	        use_auth_token=args.auth,
375	        trust_remote_code=args.trust,
376	    )
377	    model = get_model(args)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/convert_to_onnx.py:831:17
830	    if args.optimize_optimum:
831	        config = AutoConfig.from_pretrained(args.original_model_name, cache_dir=args.cache_dir)
832	        optimize_optimum(config, args)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/llama_torch.py:27:23
26	        if i == rank % (world_size):
27	            l_config = AutoConfig.from_pretrained(
28	                location, use_auth_token=auth, cache_dir=args.cache_dir, trust_remote_code=auth
29	            )
30	            l_config.use_cache = True

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/llama_torch.py:32:20
31	            l_config._attn_implementation = "eager"  # "eager" uses LlamaAttention for attention layer
32	            llama = AutoModelForCausalLM.from_pretrained(
33	                location,
34	                use_auth_token=auth,
35	                trust_remote_code=auth,
36	                config=l_config,
37	                torch_dtype=torch_dtype,
38	                cache_dir=args.cache_dir,
39	            )
40	            if world_size > 1:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/quant_kv_dataloader.py:23:20
22	
23	        tokenizer = LlamaTokenizer.from_pretrained(args.original_model_name, use_auth_token=args.use_auth_token)
24	        dataset = load_dataset(args.smooth_quant_dataset, split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/llama/quant_kv_dataloader.py:24:18
23	        tokenizer = LlamaTokenizer.from_pretrained(args.original_model_name, use_auth_token=args.use_auth_token)
24	        dataset = load_dataset(args.smooth_quant_dataset, split="train")
25	        dataset = dataset.map(lambda examples: tokenizer(examples["text"]), batched=True)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/longformer/benchmark_longformer.py:293:12
292	    torch_model_name_or_dir = PRETRAINED_LONGFORMER_MODELS.get(model_name, model_name)
293	    model = LongformerModel.from_pretrained(torch_model_name_or_dir)
294	    model.to(device)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/longformer/convert_to_onnx.py:401:12
400	
401	    model = LongformerModel.from_pretrained(PRETRAINED_LONGFORMER_MODELS[model_name])
402	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/phi2/convert_to_onnx.py:38:26
37	        self.cache_dir = cache_dir
38	        self.phi_config = AutoConfig.from_pretrained(self.model_class, trust_remote_code=True, cache_dir=self.cache_dir)
39	        self.phi_model = None

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/phi2/convert_to_onnx.py:77:25
76	            return
77	        self.phi_model = AutoModelForCausalLM.from_pretrained(
78	            self.model_class, trust_remote_code=True, cache_dir=self.cache_dir
79	        )
80	        self.phi_model.eval()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/phi2/inference_example.py:223:25
222	
223	        self.tokenizer = AutoTokenizer.from_pretrained("microsoft/phi-2", trust_remote_code=True)
224	        self.tokenizer.pad_token = "[PAD]"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_txt2img_xl.py:225:14
224	
225	    dataset = load_dataset("Gustavosta/Stable-Diffusion-Prompts")
226	    num_rows = dataset["test"].num_rows

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_utils.py:615:22
614	
615	    depth_estimator = DPTForDepthEstimation.from_pretrained("Intel/dpt-hybrid-midas").to("cuda")
616	    feature_extractor = DPTFeatureExtractor.from_pretrained("Intel/dpt-hybrid-midas")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_utils.py:616:24
615	    depth_estimator = DPTForDepthEstimation.from_pretrained("Intel/dpt-hybrid-midas").to("cuda")
616	    feature_extractor = DPTFeatureExtractor.from_pretrained("Intel/dpt-hybrid-midas")
617	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/stable_diffusion/diffusion_models.py:1242:16
1241	    if not os.path.exists(tokenizer_dir):
1242	        model = CLIPTokenizer.from_pretrained(
1243	            pipeline_info.name(),
1244	            subfolder=subfolder,
1245	            use_safetensors=pipeline_info.is_xl(),
1246	        )
1247	        model.save_pretrained(tokenizer_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/stable_diffusion/diffusion_models.py:1250:16
1249	        print(f"[I] Load tokenizer pytorch model from: {tokenizer_dir}")
1250	        model = CLIPTokenizer.from_pretrained(tokenizer_dir)
1251	    return model

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:84:20
83	        if model_type == "t5":
84	            model = T5ForConditionalGeneration.from_pretrained(model_name_or_path, cache_dir=cache_dir)
85	        elif model_type == "mt5":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:86:20
85	        elif model_type == "mt5":
86	            model = MT5ForConditionalGeneration.from_pretrained(model_name_or_path, cache_dir=cache_dir)
87	        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:91:34
90	        if state_dict_path:
91	            model.load_state_dict(torch.load(state_dict_path))
92	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:116:16
115	        start_time = time.time()
116	        model = AutoModelForSpeechSeq2Seq.from_pretrained(
117	            source,
118	            torch_dtype=torch.float16 if args.use_fp16 else torch.float32,
119	            use_cache=True,
120	        ).to(args.target_device)
121	        end_time = time.time()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:579:13
578	
579	    config = WhisperConfig.from_pretrained(args.model_name)
580	    processor = WhisperProcessor.from_pretrained(args.model_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:580:16
579	    config = WhisperConfig.from_pretrained(args.model_name)
580	    processor = WhisperProcessor.from_pretrained(args.model_name)
581	    target_device = f"cuda:{args.device_id}" if args.device != "cpu" else args.device

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/benchmark_all.py:370:13
369	
370	    config = WhisperConfig.from_pretrained(args.model_name)
371	    processor = WhisperProcessor.from_pretrained(args.model_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/benchmark_all.py:371:16
370	    config = WhisperConfig.from_pretrained(args.model_name)
371	    processor = WhisperProcessor.from_pretrained(args.model_name)
372	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_chain.py:54:13
53	
54	    config = WhisperConfig.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
55	    tokenizer = WhisperTokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_chain.py:55:16
54	    config = WhisperConfig.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
55	    tokenizer = WhisperTokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
56	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:82:17
81	    ) -> None:
82	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
83	        config.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:85:20
84	
85	        tokenizer = AutoTokenizer.from_pretrained(model_name_or_path, cache_dir=cache_dir)
86	        tokenizer.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:88:20
87	
88	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
89	        processor.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:649:20
648	            # Load from Hugging Face
649	            model = WhisperForConditionalGeneration.from_pretrained(
650	                model_name_or_path, cache_dir=cache_dir, attn_implementation="eager"
651	            )
652	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:666:17
665	            model.to(dtype=dtype)
666	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
667	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:812:12
811	            logger.warning(f"Could not import `datasets`. Attempting to install `datasets` via `{install_cmd}`.")
812	            os.system(install_cmd)
813	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:816:13
815	
816	        ds = load_dataset("hf-internal-testing/librispeech_asr_dummy", "clean", split="validation")
817	        input_features_ = []

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:937:19
936	        """Compare the result from PyTorch and ONNX Runtime to verify the ONNX model is good."""
937	        pt_model = WhisperForConditionalGeneration.from_pretrained(
938	            model_name_or_path, cache_dir=cache_dir, attn_implementation="eager"
939	        ).to(device)
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:940:20
939	        ).to(device)
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
941	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:941:17
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
941	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
942	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/models/whisper/whisper_jump_times.py:206:12
205	            logger.warning(f"Could not import `ninja`. Attempting to install `ninja` via `{install_cmd}`.")
206	            os.system(install_cmd)
207	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:308:19
307	        if is_tf_model:
308	            return TFGPT2ModelNoPastState.from_pretrained(model_name, config=config, cache_dir=cache_dir)
309	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:310:19
309	        else:
310	            return GPT2ModelNoPastState.from_pretrained(model_name, config=config, cache_dir=cache_dir)
311	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:323:13
322	def load_pt_model(model_name, model_class, cache_dir, config_modifier):
323	    config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
324	    if hasattr(config, "return_dict"):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:335:13
334	def load_tf_model(model_name, model_class, cache_dir, config_modifier):
335	    config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
336	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:489:26
488	    if model_type in ["vit", "swin"]:
489	        image_processor = AutoFeatureExtractor.from_pretrained(model_name, cache_dir=cache_dir)
490	        data = numpy.random.randint(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:496:20
495	    else:
496	        tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
497	        max_input_size = tokenizer.model_max_length

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/onnxruntime/transformers/onnx_exporter.py:597:16
596	
597	    tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
598	    # Fix "Using pad_token, but it is not set yet" error.

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/packaging/licenses/__init__.py:100:18
99	    try:
100	        invalid = eval(python_expression, globals(), locals())
101	    except Exception:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/posthog/feature_flags.py:31:19
30	    hash_key = f"{key}.{distinct_id}{salt}"
31	    hash_val = int(hashlib.sha1(hash_key.encode("utf-8")).hexdigest()[:15], 16)
32	    return hash_val / __LONG_SCALE__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/pydantic/deprecated/parse.py:54:15
53	        bb = b if isinstance(b, bytes) else b.encode()  # type: ignore
54	        return pickle.loads(bb)
55	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/pydantic/v1/parse.py:42:15
41	        bb = b if isinstance(b, bytes) else b.encode()
42	        return pickle.loads(bb)
43	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/pydantic/v1/utils.py:195:8
194	    try:
195	        eval('__IPYTHON__')
196	    except NameError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/pygments/formatters/__init__.py:103:12
102	        with open(filename, 'rb') as f:
103	            exec(f.read(), custom_namespace)
104	        # Retrieve the class `formattername` from that namespace

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/__init__.py:154:12
153	        with open(filename, 'rb') as f:
154	            exec(f.read(), custom_namespace)
155	        # Retrieve the class `lexername` from that namespace

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_lua_builtins.py:225:12
224	    def get_newest_version():
225	        f = urlopen('http://www.lua.org/manual/')
226	        r = re.compile(r'^<A HREF="(\d\.\d)/">(Lua )?\1</A>')

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_lua_builtins.py:233:12
232	    def get_lua_functions(version):
233	        f = urlopen(f'http://www.lua.org/manual/{version}/')
234	        r = re.compile(r'^<A HREF="manual.html#pdf-(?!lua|LUA)([^:]+)">\1</A>')

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_mysql_builtins.py:1248:19
1247	        # Pull content from lex.h.
1248	        lex_file = urlopen(LEX_URL).read().decode('utf8', errors='ignore')
1249	        keywords = parse_lex_keywords(lex_file)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_mysql_builtins.py:1254:27
1253	        # Parse content in item_create.cc.
1254	        item_create_file = urlopen(ITEM_CREATE_URL).read().decode('utf8', errors='ignore')
1255	        functions.update(parse_item_create_functions(item_create_file))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_php_builtins.py:3299:19
3298	    def get_php_references():
3299	        download = urlretrieve(PHP_MANUAL_URL)
3300	        with tarfile.open(download[0]) as tar:

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_php_builtins.py:3301:12
3300	        with tarfile.open(download[0]) as tar:
3301	            tar.extractall()
3302	        yield from glob.glob(f"{PHP_MANUAL_DIR}{PHP_REFERENCE_GLOB}")

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_postgres_builtins.py:642:18
641	    def update_myself():
642	        content = urlopen(DATATYPES_URL).read().decode('utf-8', errors='ignore')
643	        data_file = list(content.splitlines())

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/pygments/lexers/_postgres_builtins.py:647:18
646	
647	        content = urlopen(KEYWORDS_URL).read().decode('utf-8', errors='ignore')
648	        keywords = parse_keywords(content)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/pypika/dialects.py:559:25
558	                    )
559	            action_sql = " DO UPDATE SET {updates}".format(updates=",".join(updates))
560	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/pypika/queries.py:1100:33
1099	        if 0 == len(self._from):
1100	            raise QueryException("Cannot select {term}, no FROM table specified.".format(term=term))
1101	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/regex/tests/test_regex.py:3775:12
3774	        p = pickle.dumps(r)
3775	        r = pickle.loads(p)
3776	        self.assertEqual(r.match('foo').span(), (0, 3))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/requests/auth.py:148:23
147	                    x = x.encode("utf-8")
148	                return hashlib.md5(x).hexdigest()
149	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/requests/auth.py:156:23
155	                    x = x.encode("utf-8")
156	                return hashlib.sha1(x).hexdigest()
157	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/requests/auth.py:205:17
204	
205	        cnonce = hashlib.sha1(s).hexdigest()[:16]
206	        if _algorithm == "MD5-SESS":

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/rich/style.py:471:66
470	        """Get meta information (can not be changed after construction)."""
471	        return {} if self._meta is None else cast(Dict[str, Any], loads(self._meta))
472	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/__config__.py:109:20
108	        "Python Information": {
109	            "path": r"/tmp/build-env-b9dts1ag/bin/python",
110	            "version": "3.11",
111	        },
112	    }
113	)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/_bunch.py:160:4
159	                 '__name__': f'namedtuple_{typename}'}
160	    exec(s, namespace)
161	    __new__ = namespace['__new__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/array_api_compat/cupy/fft.py:6:0
5	_n = {}
6	exec('from cupy.fft import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/array_api_compat/cupy/linalg.py:6:0
5	_n = {}
6	exec('from cupy.linalg import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/array_api_compat/dask/array/fft.py:6:0
5	_n = {}
6	exec('from dask.array.fft import *', _n)
7	for k in ("__builtins__", "Sequence", "annotations", "warnings"):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/array_api_compat/dask/array/linalg.py:22:0
21	_n = {}
22	exec('from dask.array.linalg import *', _n)
23	for k in ('__builtins__', 'annotations', 'operator', 'warnings', 'Array'):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/array_api_compat/torch/__init__.py:12:4
11	        continue
12	    exec(f"{n} = torch.{n}")
13	del n

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/decorator.py:166:12
165	            code = compile(src, filename, 'single')
166	            exec(code, evaldict)
167	        except:  # noqa: E722

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/_lib/tests/test_bunch.py:59:14
58	        s = pickle.dumps(self.result)
59	        obj = pickle.loads(s)
60	        assert isinstance(obj, Result)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/datasets/_fetchers.py:80:23
79	    with open(fname, 'rb') as f:
80	        ascent = array(pickle.load(f))
81	    return ascent

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/interpolate/tests/test_interpnd.py:172:14
171	        ip = interpnd.LinearNDInterpolator(x, y)
172	        ip2 = pickle.loads(pickle.dumps(ip))
173	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/interpolate/tests/test_interpnd.py:411:14
410	        ip = interpnd.CloughTocher2DInterpolator(x, y)
411	        ip2 = pickle.loads(pickle.dumps(ip))
412	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/interpolate/tests/test_rbfinterp.py:418:16
417	        yitp1 = interp(xitp)
418	        yitp2 = pickle.loads(pickle.dumps(interp))(xitp)
419	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/odr/tests/test_odr.py:576:8
575	        del data
576	        pickle.loads(obj_pickle)
577	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/odr/tests/test_odr.py:585:8
584	        del data
585	        pickle.loads(obj_pickle)
586	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/odr/tests/test_odr.py:589:8
588	        obj_pickle = pickle.dumps(unilinear)
589	        pickle.loads(obj_pickle)
590	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/odr/tests/test_odr.py:598:8
597	        del odr_obj
598	        pickle.loads(obj_pickle)
599	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/odr/tests/test_odr.py:607:8
606	        del output
607	        pickle.loads(obj_pickle)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/optimize/_nonlin.py:1621:4
1620	    ns.update(globals())
1621	    exec(wrapper, ns)
1622	    func = ns[name]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/optimize/tests/test_constraints.py:183:22
182	            bounds = Bounds(*args)
183	            bounds2 = eval(repr(Bounds(*args)))
184	            assert_array_equal(bounds.lb, bounds2.lb)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:44:14
43	    if not hasattr(mat, 'shape'):
44	        mat = eval(mat, dict(np=np, sparse=sparse))
45	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:300:19
299	        if form == "array":
300	            d[L] = eval(L)
301	        else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:302:19
301	        else:
302	            d[L] = eval(L)(np.eye(n, dtype=mat.dtype))
303	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/sparse/linalg/tests/test_interface.py:397:12
396	        s = pickle.dumps(A, protocol=protocol)
397	        B = pickle.loads(s)
398	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/sparse/tests/test_base.py:2255:27
2254	            for protocol in range(pickle.HIGHEST_PROTOCOL):
2255	                sploaded = pickle.loads(pickle.dumps(datsp, protocol=protocol))
2256	                assert_equal(datsp.shape, sploaded.shape)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:445:37
444	            with maybe_deprecated(metric):
445	                cdist(X1, X2, metric=eval(metric), **kwargs)
446	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:452:33
451	        with pytest.raises(TypeError):
452	            cdist(X1, X2, metric=eval(metric), *args)
453	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:559:38
558	            y1 = cdist(X1, X2, metric=metric, **kwargs)
559	            y2 = cdist(X1, X2, metric=eval(metric), **kwargs)
560	            y3 = cdist(X1, X2, metric="test_" + metric, **kwargs)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:569:37
568	            with pytest.raises(e_cls):
569	                cdist(X1, X2, metric=eval(metric), **kwargs)
570	            with pytest.raises(e_cls):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:755:33
754	            with maybe_deprecated(metric):
755	                pdist(X1, metric=eval(metric), **kwargs)
756	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:762:29
761	        with pytest.raises(TypeError):
762	            pdist(X1, metric=eval(metric), *args)
763	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:1394:33
1393	            y1 = pdist(X, metric=metric, **kwargs)
1394	            y2 = pdist(X, metric=eval(metric), **kwargs)
1395	            y3 = pdist(X, metric="test_" + metric, **kwargs)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:1404:32
1403	            with pytest.raises(e_cls):
1404	                pdist(X, metric=eval(metric), **kwargs)
1405	            with pytest.raises(e_cls):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_distance.py:2137:22
2136	
2137	    for m in [metric, eval(metric), "test_" + metric]:
2138	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_kdtree.py:855:9
854	    tmp = pickle.dumps(T1)
855	    T2 = pickle.loads(tmp)
856	    T1 = T1.query(points, k=5)[-1]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/tests/test_kdtree.py:869:9
868	    tmp = pickle.dumps(T1)
869	    T2 = pickle.loads(tmp)
870	    T1 = T1.query(points, k=5)[-1]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/spatial/transform/tests/test_rotation.py:2118:16
2117	    pkl = pickle.dumps(r)
2118	    unpickled = pickle.loads(pkl)
2119	    xp_assert_close(r.as_matrix(), unpickled.as_matrix(), atol=1e-15)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/special/tests/test_orthogonal.py:280:20
279	            for pstr in poly:
280	                p = eval(pstr)
281	                assert_almost_equal(p(0.315), np.poly1d(p.coef)(0.315),

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/special/tests/test_support_alternative_backends.py:194:16
193	def test_pickle(func):
194	    roundtrip = pickle.loads(pickle.dumps(func))
195	    assert roundtrip is func

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/_distn_infrastructure.py:368:4
367	for obj in [s for s in dir() if s.startswith('_doc_')]:
368	    exec('del ' + obj)
369	del obj

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/_distn_infrastructure.py:744:8
743	        ns = {}
744	        exec(self._parse_arg_template, ns)
745	        # NB: attach to the instance, not class

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/common_tests.py:303:16
302	
303	    unpickled = pickle.loads(s)
304	    r1 = unpickled.rvs(*args, size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/common_tests.py:316:16
315	    pkl = pickle.dumps(frozen_dist)
316	    unpickled = pickle.loads(pkl)
317	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/common_tests.py:326:33
325	        pickled_fit_function = pickle.dumps(fit_function)
326	        unpickled_fit_function = pickle.loads(pickled_fit_function)
327	        assert fit_function.__name__ == unpickled_fit_function.__name__ == "fit"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_axis_nan_policy.py:764:25
763	    pickled_hypotest = pickle.dumps(hypotest)
764	    unpickled_hypotest = pickle.loads(pickled_hypotest)
765	    res1 = unpacker(hypotest(*data, *args, axis=-1, **kwds))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_continuous.py:89:14
88	        right_comparison = '<=' if inclusive_b else '<'
89	        ref = eval(f'(a {left_comparison} x) & (x {right_comparison} b)')
90	        assert_equal(res, ref)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_continuous.py:974:12
973	    dist2 = deepcopy(dist1)
974	    dist3 = pickle.loads(pickle.dumps(dist1))
975	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_continuous.py:2047:19
2046	        from scipy.stats._new_distributions import Uniform # noqa: F401
2047	        new_dist = eval(repr(dist))
2048	        # A basic check that the distributions are the same

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_distributions.py:6876:24
6875	
6876	            unpickled = pickle.loads(s)
6877	            r1 = unpickled.rvs(size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_multivariate.py:3723:16
3722	
3723	    unpickled = pickle.loads(s)
3724	    r1 = unpickled.rvs(*args, size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/scipy/stats/tests/test_sampling.py:258:11
257	    obj = pickle.dumps(rng1)
258	    rng2 = pickle.loads(obj)
259	    assert_equal(rng1.rvs(100), rng2.rvs(100))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:149:35
148	
149	        config: PretrainedConfig = AutoConfig.from_pretrained(
150	            model_name_or_path,
151	            cache_dir=cache_folder,
152	            trust_remote_code=trust_remote_code,
153	            revision=revision,
154	            local_files_only=local_files_only,
155	            token=token,
156	            **config_kwargs,
157	        )
158	        if hasattr(config, "sentence_transformers") and "version" in config.sentence_transformers:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:190:46
189	            tokenizer_kwargs["model_max_length"] = max_length
190	        self.tokenizer: PreTrainedTokenizer = AutoTokenizer.from_pretrained(
191	            model_name_or_path,
192	            cache_dir=cache_folder,
193	            trust_remote_code=trust_remote_code,
194	            revision=revision,
195	            local_files_only=local_files_only,
196	            token=token,
197	            **tokenizer_kwargs,
198	        )
199	        if "model_max_length" not in tokenizer_kwargs and hasattr(self.config, "max_position_embeddings"):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:237:42
236	        if backend == "torch":
237	            self.model: PreTrainedModel = AutoModelForSequenceClassification.from_pretrained(
238	                model_name_or_path,
239	                config=config,
240	                **model_kwargs,
241	            )
242	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:302:17
301	        dataset_path = dataset_name_to_id[dataset_name.lower()]
302	        corpus = load_dataset(dataset_path, "corpus", split="train")
303	        corpus_mapping = dict(zip(corpus["_id"], corpus["text"]))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:304:18
303	        corpus_mapping = dict(zip(corpus["_id"], corpus["text"]))
304	        queries = load_dataset(dataset_path, "queries", split="train")
305	        query_mapping = dict(zip(queries["_id"], queries["text"]))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:306:20
305	        query_mapping = dict(zip(queries["_id"], queries["text"]))
306	        relevance = load_dataset(dataset_path, "relevance", split="train")
307	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:413:17
412	        dataset_path = dataset_name_to_id[dataset_name.lower()]
413	        corpus = load_dataset(dataset_path, "corpus", split="train")
414	        queries = load_dataset(dataset_path, "queries", split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:414:18
413	        corpus = load_dataset(dataset_path, "corpus", split="train")
414	        queries = load_dataset(dataset_path, "queries", split="train")
415	        qrels = load_dataset(dataset_path, "qrels", split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:415:16
414	        queries = load_dataset(dataset_path, "queries", split="train")
415	        qrels = load_dataset(dataset_path, "qrels", split="train")
416	        corpus_dict = {sample["_id"]: sample["text"] for sample in corpus if len(sample["text"]) > 0}

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:96:33
95	
96	        self.tokenizer_decoder = AutoTokenizer.from_pretrained(decoder_name_or_path)
97	        self.need_retokenization = not isinstance(self.tokenizer_encoder, type(self.tokenizer_decoder))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:99:25
98	
99	        decoder_config = AutoConfig.from_pretrained(decoder_name_or_path)
100	        decoder_config.is_decoder = True

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:104:27
103	        try:
104	            self.decoder = AutoModelForCausalLM.from_pretrained(decoder_name_or_path, **kwargs_decoder)
105	        except ValueError as e:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:116:15
115	
116	        if len(AutoTokenizer.from_pretrained(encoder_name_or_path)) != len(self.tokenizer_encoder):
117	            logger.warning(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/CLIPModel.py:24:21
23	
24	        self.model = transformers.CLIPModel.from_pretrained(model_name)
25	        self.processor = transformers.CLIPProcessor.from_pretrained(processor_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/CLIPModel.py:25:25
24	        self.model = transformers.CLIPModel.from_pretrained(model_name)
25	        self.processor = transformers.CLIPProcessor.from_pretrained(processor_name)
26	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/Transformer.py:102:25
101	            tokenizer_args["model_max_length"] = max_seq_length
102	        self.tokenizer = AutoTokenizer.from_pretrained(
103	            tokenizer_name_or_path if tokenizer_name_or_path is not None else model_name_or_path,
104	            cache_dir=cache_dir,
105	            **tokenizer_args,
106	        )
107	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/Transformer.py:162:15
161	
162	        return AutoConfig.from_pretrained(model_name_or_path, **config_args, cache_dir=cache_dir), False
163	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/Transformer.py:196:34
195	            else:
196	                self.auto_model = AutoModel.from_pretrained(
197	                    model_name_or_path, config=config, cache_dir=cache_dir, **model_args
198	                )
199	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/Transformer.py:221:26
220	        T5EncoderModel._keys_to_ignore_on_load_unexpected = ["decoder.*"]
221	        self.auto_model = T5EncoderModel.from_pretrained(
222	            model_name_or_path, config=config, cache_dir=cache_dir, **model_args
223	        )
224	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/Transformer.py:230:26
229	        MT5EncoderModel._keys_to_ignore_on_load_unexpected = ["decoder.*"]
230	        self.auto_model = MT5EncoderModel.from_pretrained(
231	            model_name_or_path, config=config, cache_dir=cache_dir, **model_args
232	        )
233	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/models/tokenizer/WordTokenizer.py:441:44
440	    def load(input_path: str):
441	        return TransformersTokenizerWrapper(AutoTokenizer.from_pretrained(input_path, use_fast=True))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/SparseEncoder.py:1006:17
1005	
1006	        config = AutoConfig.from_pretrained(model_name_or_path, cache_dir=cache_folder, **config_kwargs)
1007	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:97:25
96	
97	        self.tokenizer = AutoTokenizer.from_pretrained(
98	            (tokenizer_name_or_path if tokenizer_name_or_path is not None else model_name_or_path),
99	            cache_dir=cache_dir,
100	            **tokenizer_args,
101	        )
102	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:149:15
148	
149	        return AutoConfig.from_pretrained(model_name_or_path, **config_args, cache_dir=cache_dir), False
150	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:178:30
177	
178	            self.auto_model = AutoModelForMaskedLM.from_pretrained(model_name_or_path, config=config, **model_args)
179	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/models/SparseStaticEmbedding.py:120:28
119	
120	                json_path = hf_hub_download(
121	                    repo_id=json_path,
122	                    filename="idf.json",
123	                    token=token,
124	                    cache_dir=cache_folder,
125	                    revision=revision,
126	                    local_files_only=local_files_only,
127	                )
128	            except ValueError:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/sparse_encoder/models/SparseStaticEmbedding.py:181:20
180	        # Load tokenizer
181	        tokenizer = AutoTokenizer.from_pretrained(
182	            model_name_or_path,
183	            subfolder=subfolder,
184	            token=token,
185	            cache_dir=cache_folder,
186	            revision=revision,
187	            local_files_only=local_files_only,
188	        )
189	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/util/file_io.py:96:15
95	    try:
96	        return hf_hub_download(
97	            model_name_or_path,
98	            filename=file_path.name,
99	            subfolder=file_path.parent.as_posix(),
100	            revision=revision,
101	            library_name="sentence-transformers",
102	            token=token,
103	            cache_dir=cache_folder,
104	            local_files_only=local_files_only,
105	        )
106	    except Exception:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/util/file_io.py:152:20
151	    try:
152	        repo_path = snapshot_download(**download_kwargs)
153	    except Exception:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/util/file_io.py:156:20
155	        download_kwargs["local_files_only"] = True
156	        repo_path = snapshot_download(**download_kwargs)
157	    return Path(repo_path, subfolder)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/sentence_transformers/util/file_io.py:177:10
176	
177	    req = requests.get(url, stream=True)
178	    if req.status_code != 200:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/six.py:740:8
739	            _locs_ = _globs_
740	        exec("""exec _code_ in _globs_, _locs_""")
741	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/_loss/tests/test_loss.py:1310:21
1309	    pickled_loss = pickle.dumps(loss)
1310	    unpickled_loss = pickle.loads(pickled_loss)
1311	    assert loss(y_true=y_true, raw_prediction=raw_prediction) == approx(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/cluster/tests/test_dbscan.py:294:16
293	    s = pickle.dumps(obj)
294	    assert type(pickle.loads(s)) is obj.__class__
295	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/cluster/tests/test_spectral.py:71:21
70	
71	        model_copy = pickle.loads(pickle.dumps(model))
72	        assert model_copy.n_clusters == model.n_clusters

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/compose/tests/test_column_transformer.py:1469:22
1468	    selector = make_column_selector(dtype_include=[object])
1469	    selector_picked = pickle.loads(pickle.dumps(selector))
1470	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/_base.py:1512:16
1511	            try:
1512	                urlretrieve(remote.url, temp_file_path)
1513	                break

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/_lfw.py:121:12
120	        with tarfile.open(archive_path, "r:gz") as fp:
121	            tarfile_extractall(fp, path=lfw_home)
122	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/_openml.py:526:14
525	    with closing(gzip_file):
526	        md5 = hashlib.md5()
527	        for chunk in iter(lambda: gzip_file.read(4096), b""):

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/_twenty_newsgroups.py:85:8
84	    with tarfile.open(archive_path, "r:gz") as fp:
85	        tarfile_extractall(fp, path=target_dir)
86	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/_twenty_newsgroups.py:310:20
309	            uncompressed_content = codecs.decode(compressed_content, "zlib_codec")
310	            cache = pickle.loads(uncompressed_content)
311	        except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/tests/test_base.py:334:21
333	    bunch = Bunch(x="x")
334	    bunch_from_pkl = loads(dumps(bunch))
335	    bunch_from_pkl.x = "y"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/datasets/tests/test_base.py:349:21
348	    bunch.__dict__["key"] = "set from __dict__"
349	    bunch_from_pkl = loads(dumps(bunch))
350	    # After loading from pickle the __dict__ should have been ignored

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/ensemble/_hist_gradient_boosting/tests/test_gradient_boosting.py:1715:14
1714	    # bitness that than the platform it will be used to make predictions on:
1715	    new_clf = pickle.load(pickle_dump_with_different_bitness())
1716	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/ensemble/tests/test_forest.py:718:11
717	
718	    obj2 = pickle.loads(pickle_object)
719	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/ensemble/tests/test_weight_boosting.py:219:11
218	
219	    obj2 = pickle.loads(s)
220	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/ensemble/tests/test_weight_boosting.py:230:11
229	
230	    obj2 = pickle.loads(s)
231	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/externals/array_api_compat/cupy/fft.py:6:0
5	_n = {}
6	exec('from cupy.fft import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/externals/array_api_compat/cupy/linalg.py:6:0
5	_n = {}
6	exec('from cupy.linalg import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/externals/array_api_compat/dask/array/fft.py:6:0
5	_n = {}
6	exec('from dask.array.fft import *', _n)
7	for k in ("__builtins__", "Sequence", "annotations", "warnings"):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/externals/array_api_compat/dask/array/linalg.py:22:0
21	_n = {}
22	exec('from dask.array.linalg import *', _n)
23	for k in ('__builtins__', 'annotations', 'operator', 'warnings', 'Array'):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sklearn/externals/array_api_compat/torch/__init__.py:12:4
11	        continue
12	    exec(f"{n} = torch.{n}")
13	del n

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/feature_extraction/tests/test_text.py:1045:15
1044	        s = pickle.dumps(orig)
1045	        copy = pickle.loads(s)
1046	        assert type(copy) == orig.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/feature_extraction/tests/test_text.py:1069:28
1068	    text = "J'ai mangé du kangourou  ce midi, c'était pas très bon."
1069	    roundtripped_function = pickle.loads(pickle.dumps(function))
1070	    expected = function(text)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/feature_extraction/tests/test_text.py:1095:23
1094	        cv = CountVectorizer(vocabulary=vocab_set)
1095	        unpickled_cv = pickle.loads(pickle.dumps(cv))
1096	        cv.fit(ALL_FOOD_DOCS)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/feature_extraction/tests/test_text.py:1124:23
1123	        cv = CountVectorizer(vocabulary=vocab_dict)
1124	        unpickled_cv = pickle.loads(pickle.dumps(cv))
1125	        cv.fit(ALL_FOOD_DOCS)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/feature_extraction/tests/test_text.py:1136:11
1135	    s = pickle.dumps(orig)
1136	    copy = pickle.loads(s)
1137	    assert type(copy) == orig.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/linear_model/tests/test_sgd.py:872:10
871	    # pickle and unpickle with sparse coef_
872	    clf = pickle.loads(pickle.dumps(clf))
873	    assert sp.issparse(clf.coef_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/metrics/tests/test_dist_metrics.py:258:14
257	        D1 = dm.pairwise(X)
258	        dm2 = pickle.loads(pickle.dumps(dm))
259	        D2 = dm2.pairwise(X)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/metrics/tests/test_dist_metrics.py:268:10
267	    D1 = dm.pairwise(X_bool)
268	    dm2 = pickle.loads(pickle.dumps(dm))
269	    D2 = dm2.pairwise(X_bool)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/metrics/tests/test_dist_metrics.py:327:20
326	    # DistanceMetric object is picklable
327	    euclidean_pkl = pickle.loads(pickle.dumps(euclidean))
328	    pyfunc_pkl = pickle.loads(pickle.dumps(pyfunc))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/metrics/tests/test_dist_metrics.py:328:17
327	    euclidean_pkl = pickle.loads(pickle.dumps(euclidean))
328	    pyfunc_pkl = pickle.loads(pickle.dumps(pyfunc))
329	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/metrics/tests/test_score_objects.py:443:23
442	    score1 = scorer(clf, X_test, y_test)
443	    unpickled_scorer = pickle.loads(pickle.dumps(scorer))
444	    score2 = unpickled_scorer(clf, X_test, y_test)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/model_selection/tests/test_search.py:1613:26
1612	    grid_search.fit(X, y)
1613	    grid_search_pickled = pickle.loads(pickle.dumps(grid_search))
1614	    assert_array_almost_equal(grid_search.predict(X), grid_search_pickled.predict(X))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/model_selection/tests/test_search.py:1620:28
1619	    random_search.fit(X, y)
1620	    random_search_pickled = pickle.loads(pickle.dumps(random_search))
1621	    assert_array_almost_equal(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/neighbors/tests/test_nearest_centroid.py:116:11
115	
116	    obj2 = pickle.loads(s)
117	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/neighbors/tests/test_neighbors_tree.py:289:12
288	    s = pickle.dumps(tree1, protocol=protocol)
289	    tree2 = pickle.loads(s)
290	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/neighbors/tests/test_quad_tree.py:74:10
73	    s = pickle.dumps(tree, protocol=protocol)
74	    bt2 = pickle.loads(s)
75	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:500:24
499	        warnings.simplefilter("error")
500	        tree_restored = pickle.loads(tree_pickle)
501	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:532:8
531	    with pytest.warns(UserWarning, match=message) as warning_record:
532	        pickle.loads(tree_pickle_other)
533	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:560:8
559	    with pytest.warns(UserWarning, match=message):
560	        pickle.loads(tree_pickle_noversion)
561	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:574:12
573	
574	            pickle.loads(tree_pickle_noversion)
575	    finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:601:25
600	    serialized = pickle.dumps(estimator)
601	    estimator_restored = pickle.loads(serialized)
602	    assert estimator_restored.attribute_pickled == 5

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:642:25
641	    serialized = pickle.dumps(estimator)
642	    estimator_restored = pickle.loads(serialized)
643	    assert estimator_restored.attribute_pickled == 5

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_base.py:882:4
881	    # this should not raise
882	    pickle.loads(pickle.dumps(BaseEstimator()))
883	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tests/test_isotonic.py:388:10
387	    ir_ser = pickle.dumps(ir, pickle.HIGHEST_PROTOCOL)
388	    ir2 = pickle.loads(ir_ser)
389	    np.testing.assert_array_equal(ir.predict(x), ir2.predict(x))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tree/tests/test_tree.py:922:15
921	        serialized_object = pickle.dumps(est)
922	        est2 = pickle.loads(serialized_object)
923	        assert type(est2) == est.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tree/tests/test_tree.py:1771:15
1770	    def _pickle_copy(obj):
1771	        return pickle.loads(pickle.dumps(obj))
1772	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tree/tests/test_tree.py:2075:14
2074	
2075	    new_clf = pickle.load(get_pickle_non_native_endianness())
2076	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tree/tests/test_tree.py:2169:14
2168	
2169	    new_clf = pickle.load(pickle_dump_with_different_bitness())
2170	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/tree/tests/test_tree.py:2317:20
2316	
2317	    splitter_back = pickle.loads(splitter_serialize)
2318	    assert splitter_back.max_features == max_features

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/estimator_checks.py:2429:30
2428	            assert b"_sklearn_version" in pickled_estimator
2429	        unpickled_estimator = pickle.loads(pickled_estimator)
2430	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/estimator_checks.py:3690:10
3689	    # pickle and unpickle with sparse coef_
3690	    est = pickle.loads(pickle.dumps(est))
3691	    assert sparse.issparse(est.coef_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_deprecation.py:89:4
88	def test_pickle():
89	    pickle.loads(pickle.dumps(mock_function))
90	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_encode.py:140:18
139	    if pickle_uniques:
140	        uniques = pickle.loads(pickle.dumps(uniques))
141	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_encode.py:149:18
148	    if pickle_uniques:
149	        uniques = pickle.loads(pickle.dumps(uniques))
150	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_encode.py:159:18
158	    if pickle_uniques:
159	        uniques = pickle.loads(pickle.dumps(uniques))
160	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_encode.py:182:18
181	    if pickle_uniques:
182	        uniques = pickle.loads(pickle.dumps(uniques))
183	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sklearn/utils/tests/test_metaestimators.py:62:21
61	    pickled_bytes = pickle.dumps(est.available_func)
62	    unpickled_func = pickle.loads(pickled_bytes)
63	    assert unpickled_func() == return_value

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/__init__.py:47:15
46	    if debug_str in ('True', 'False'):
47	        return eval(debug_str)
48	    else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/abc.py:96:0
95	ns: dict[str, Any] = {}
96	exec('from sympy import *', ns)
97	_clash1: dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/benchmarks/bench_meijerint.py:249:8
248	        _t = time()
249	        exec(string)
250	        _t = time() - _t

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/codegen/tests/test_algorithms.py:81:4
80	    namespace = {}
81	    exec(py_mod, namespace, namespace)
82	    res = eval('newton(0.5)', namespace)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/codegen/tests/test_algorithms.py:82:10
81	    exec(py_mod, namespace, namespace)
82	    res = eval('newton(0.5)', namespace)
83	    assert abs(res - 0.865474033102) < 1e-12

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/codegen/tests/test_algorithms.py:170:12
169	            ns = namespace[k] = {}
170	            exec(v, ns, ns)
171	            root_find_b[k] = ns[f'{k}_b']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_basic.py:325:8
324	    with warns_deprecated_sympy():
325	        exec(code)
326	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_singleton.py:57:4
56	    d = {}
57	    exec('from sympy import *', d)
58	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_sympify.py:549:4
548	    locals = {}
549	    exec("from sympy.abc import Q, C", locals)
550	    assert str(S('C&Q', locals)) == 'C & Q'

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:7:4
6	    ns = {"var": var, "raises": raises}
7	    eval("var('a')", ns)
8	    assert ns["a"] == Symbol("a")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:10:4
9	
10	    eval("var('b bb cc zz _x')", ns)
11	    assert ns["b"] == Symbol("b")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:17:8
16	
17	    v = eval("var(['d', 'e', 'fg'])", ns)
18	    assert ns['d'] == Symbol('d')

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:30:9
29	    "raises(ValueError, lambda: var(''))"
30	    v2 = eval("var('q')", ns)
31	    v3 = eval("var('q p')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:31:9
30	    v2 = eval("var('q')", ns)
31	    v3 = eval("var('q p')", ns)
32	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:39:9
38	    ns = {"var": var}
39	    v1 = eval("var('x y z')", ns)
40	    v2 = eval("var('x,y,z')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:40:9
39	    v1 = eval("var('x y z')", ns)
40	    v2 = eval("var('x,y,z')", ns)
41	    v3 = eval("var('x,y z')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:41:9
40	    v2 = eval("var('x,y,z')", ns)
41	    v3 = eval("var('x,y z')", ns)
42	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:49:4
48	    ns = {"var": var}
49	    eval("var('x y', real=True)", ns)
50	    assert ns['x'].is_real and ns['y'].is_real

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:55:4
54	    ns = {"var": var, "Function": Function}
55	    eval("var('f', cls=Function)", ns)
56	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/core/tests/test_var.py:59:4
58	
59	    eval("var('g,h', cls=Function)", ns)
60	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/external/importtools.py:21:15
20	    if debug_str in ('True', 'False'):
21	        return eval(debug_str)
22	    else:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/external/tests/test_codegen.py:122:22
121	        for command in commands:
122	            retcode = subprocess.call(command, stdout=null, shell=True,
123	                    stderr=subprocess.STDOUT)
124	            if retcode != 0:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/external/tests/test_pythonmpq.py:97:15
96	        q = Q(2, 3)
97	        assert pickle.loads(pickle.dumps(q)) == q
98	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_commonmatrix.py:825:8
824	    try:
825	        eval('c = a @ b')
826	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_commonmatrix.py:864:8
863	    try:
864	        eval('c = 5 @ b')
865	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_commonmatrix.py:894:8
893	    try:
894	        eval('2 @ a')
895	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_commonmatrix.py:902:8
901	    try:
902	        eval('a @ 2')
903	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_matrices.py:209:8
208	    try:
209	        eval('c = a @ b')
210	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_matrices.py:248:8
247	    try:
248	        eval('c = 5 @ b')
249	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_matrixbase.py:506:8
505	    try:
506	        eval('2 @ a')
507	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_matrixbase.py:514:8
513	    try:
514	        eval('a @ 2')
515	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/matrices/tests/test_sparse.py:99:8
98	    try:
99	        eval('c = a @ b')
100	    except SyntaxError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/ast_parser.py:72:4
71	    global_dict = {}
72	    exec('from sympy import *', global_dict)
73	    try:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/ast_parser.py:79:11
78	    e = compile(a, "<string>", "eval")
79	    return eval(e, global_dict, local_dict)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/sympy_parser.py:905:11
904	    """
905	    expr = eval(
906	        code, global_dict, local_dict)  # take local objects in preference
907	    return expr

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/sympy_parser.py:1052:8
1051	        global_dict = {}
1052	        exec('from sympy import *', global_dict)
1053	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/tests/test_autolev.py:140:4
139	    l = {}
140	    exec(sympy_input, g, l)
141	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/parsing/tests/test_sympy_parser.py:156:4
155	    default_globals = {}
156	    exec('from sympy import *', default_globals)
157	    builtins_dict = vars(builtins)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:45:0
44	ENV: dict[str, Any] = {}
45	exec('from sympy import *', ENV)
46	exec('from sympy.physics.quantum import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:46:0
45	exec('from sympy import *', ENV)
46	exec('from sympy.physics.quantum import *', ENV)
47	exec('from sympy.physics.quantum.cg import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:47:0
46	exec('from sympy.physics.quantum import *', ENV)
47	exec('from sympy.physics.quantum.cg import *', ENV)
48	exec('from sympy.physics.quantum.spin import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:48:0
47	exec('from sympy.physics.quantum.cg import *', ENV)
48	exec('from sympy.physics.quantum.spin import *', ENV)
49	exec('from sympy.physics.quantum.hilbert import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:49:0
48	exec('from sympy.physics.quantum.spin import *', ENV)
49	exec('from sympy.physics.quantum.hilbert import *', ENV)
50	exec('from sympy.physics.quantum.qubit import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:50:0
49	exec('from sympy.physics.quantum.hilbert import *', ENV)
50	exec('from sympy.physics.quantum.qubit import *', ENV)
51	exec('from sympy.physics.quantum.qexpr import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:51:0
50	exec('from sympy.physics.quantum.qubit import *', ENV)
51	exec('from sympy.physics.quantum.qexpr import *', ENV)
52	exec('from sympy.physics.quantum.gate import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:52:0
51	exec('from sympy.physics.quantum.qexpr import *', ENV)
52	exec('from sympy.physics.quantum.gate import *', ENV)
53	exec('from sympy.physics.quantum.constants import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:53:0
52	exec('from sympy.physics.quantum.gate import *', ENV)
53	exec('from sympy.physics.quantum.constants import *', ENV)
54	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/quantum/tests/test_printing.py:62:11
61	    assert srepr(expr) == string
62	    assert eval(string, ENV) == expr
63	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/secondquant.py:1601:17
1600	        list_comp = "[%s %s %s]" % (tup_string, first_loop, other_loops)
1601	        result = eval(list_comp)
1602	        if self.n_particles == 1:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/units/tests/test_prefixes.py:85:11
84	def test_repr():
85	    assert eval(repr(kilo)) == kilo
86	    assert eval(repr(kibi)) == kibi

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/units/tests/test_prefixes.py:86:11
85	    assert eval(repr(kilo)) == kilo
86	    assert eval(repr(kibi)) == kibi

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/physics/vector/tests/test_frame.py:759:9
758	    A_C_N = A.dcm(N)
759	    N1 = pickle.loads(pickle.dumps(N))
760	    A1 = tuple(N1._dcm_dict.keys())[0]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/plotting/experimental_lambdify.py:268:8
267	        self.eval_str = eval_str
268	        exec("MYNEWLAMBDA = %s" % eval_str, namespace)
269	        self.lambda_func = namespace['MYNEWLAMBDA']

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/plotting/pygletplot/plot_axes.py:44:21
43	        try:
44	            stride = eval(stride)
45	        except TypeError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/plotting/pygletplot/plot_interval.py:27:27
26	                try:
27	                    args = eval(args[0])
28	                except TypeError:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/matrices/tests/test_domainmatrix.py:1366:11
1365	    dM = DomainMatrix({2: {2: ZZ(1)}, 4: {4: ZZ(1)}}, (5, 5), ZZ)
1366	    assert pickle.loads(pickle.dumps(dM)) == dM
1367	    dM = DomainMatrix([[ZZ(1), ZZ(2)], [ZZ(3), ZZ(4)]], (2, 2), ZZ)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/matrices/tests/test_domainmatrix.py:1368:11
1367	    dM = DomainMatrix([[ZZ(1), ZZ(2)], [ZZ(3), ZZ(4)]], (2, 2), ZZ)
1368	    assert pickle.loads(pickle.dumps(dM)) == dM
1369	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/monomials.py:401:8
400	        ns = {}
401	        exec(code, ns)
402	        return ns[name]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/polyconfig.py:61:39
60	            try:
61	                _current_config[key] = eval(value)
62	            except NameError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/ring_series.py:2011:17
2010	        series_inner = series_inner.set_ring(R)
2011	        series = eval(_convert_func[str(expr.func)])(series_inner,
2012	            R(a), prec)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:9:4
8	    ns = {'vring':vring, 'QQ':QQ}
9	    exec('R = vring("r", QQ)', ns)
10	    exec('assert r == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:10:4
9	    exec('R = vring("r", QQ)', ns)
10	    exec('assert r == R.gens[0]', ns)
11	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:12:4
11	
12	    exec('R = vring("rb rbb rcc rzz _rx", QQ)', ns)
13	    exec('assert rb == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:13:4
12	    exec('R = vring("rb rbb rcc rzz _rx", QQ)', ns)
13	    exec('assert rb == R.gens[0]', ns)
14	    exec('assert rbb == R.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:14:4
13	    exec('assert rb == R.gens[0]', ns)
14	    exec('assert rbb == R.gens[1]', ns)
15	    exec('assert rcc == R.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:15:4
14	    exec('assert rbb == R.gens[1]', ns)
15	    exec('assert rcc == R.gens[2]', ns)
16	    exec('assert rzz == R.gens[3]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:16:4
15	    exec('assert rcc == R.gens[2]', ns)
16	    exec('assert rzz == R.gens[3]', ns)
17	    exec('assert _rx == R.gens[4]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:17:4
16	    exec('assert rzz == R.gens[3]', ns)
17	    exec('assert _rx == R.gens[4]', ns)
18	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:19:4
18	
19	    exec('R = vring(["rd", "re", "rfg"], QQ)', ns)
20	    exec('assert rd == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:20:4
19	    exec('R = vring(["rd", "re", "rfg"], QQ)', ns)
20	    exec('assert rd == R.gens[0]', ns)
21	    exec('assert re == R.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:21:4
20	    exec('assert rd == R.gens[0]', ns)
21	    exec('assert re == R.gens[1]', ns)
22	    exec('assert rfg == R.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:22:4
21	    exec('assert re == R.gens[1]', ns)
22	    exec('assert rfg == R.gens[2]', ns)
23	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:26:4
25	    ns = {'vfield':vfield, 'QQ':QQ}
26	    exec('F = vfield("f", QQ)', ns)
27	    exec('assert f == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:27:4
26	    exec('F = vfield("f", QQ)', ns)
27	    exec('assert f == F.gens[0]', ns)
28	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:29:4
28	
29	    exec('F = vfield("fb fbb fcc fzz _fx", QQ)', ns)
30	    exec('assert fb == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:30:4
29	    exec('F = vfield("fb fbb fcc fzz _fx", QQ)', ns)
30	    exec('assert fb == F.gens[0]', ns)
31	    exec('assert fbb == F.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:31:4
30	    exec('assert fb == F.gens[0]', ns)
31	    exec('assert fbb == F.gens[1]', ns)
32	    exec('assert fcc == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:32:4
31	    exec('assert fbb == F.gens[1]', ns)
32	    exec('assert fcc == F.gens[2]', ns)
33	    exec('assert fzz == F.gens[3]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:33:4
32	    exec('assert fcc == F.gens[2]', ns)
33	    exec('assert fzz == F.gens[3]', ns)
34	    exec('assert _fx == F.gens[4]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:34:4
33	    exec('assert fzz == F.gens[3]', ns)
34	    exec('assert _fx == F.gens[4]', ns)
35	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:36:4
35	
36	    exec('F = vfield(["fd", "fe", "ffg"], QQ)', ns)
37	    exec('assert fd == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:37:4
36	    exec('F = vfield(["fd", "fe", "ffg"], QQ)', ns)
37	    exec('assert fd == F.gens[0]', ns)
38	    exec('assert fe == F.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:38:4
37	    exec('assert fd == F.gens[0]', ns)
38	    exec('assert fe == F.gens[1]', ns)
39	    exec('assert ffg == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_injections.py:39:4
38	    exec('assert fe == F.gens[1]', ns)
39	    exec('assert ffg == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/polys/tests/test_polytools.py:3960:19
3959	    poly = Poly(x + y, x, y, z)
3960	    deserialized = pickle.loads(pickle.dumps(poly))
3961	    assert poly == deserialized, (

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:43:4
42	    l = lambdarepr(p)
43	    eval(h + l)
44	    assert l == "((x) if (x < 0) else None)"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:52:4
51	    l = lambdarepr(p)
52	    eval(h + l)
53	    assert l == "((1) if (x < 1) else (2) if (x < 2) else (0))"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:60:4
59	    l = lambdarepr(p)
60	    eval(h + l)
61	    assert l == "((1) if (x < 1) else (2) if (x < 2) else None)"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:69:4
68	    l = lambdarepr(p)
69	    eval(h + l)
70	    assert l == "((x) if (x < 1) else (x**2) if (((x <= 4)) and ((x > 3))) else (0))"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:79:4
78	    l = lambdarepr(p)
79	    eval(h + l)
80	    assert l == "((x**2) if (x < 0) else (x) if (x < 1)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:89:4
88	    l = lambdarepr(p)
89	    eval(h + l)
90	    assert l == "((x**2) if (x < 0) else (x) if (x < 1)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:102:4
101	    l = lambdarepr(p)
102	    eval(h + l)
103	    assert l == "((1) if (x >= 1) else (2) if (x >= 2) else (3) if (x >= 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:115:4
114	    l = lambdarepr(p)
115	    eval(h + l)
116	    assert l == "((1) if (x <= 1) else (2) if (x <= 2) else (3) if (x <= 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:128:4
127	    l = lambdarepr(p)
128	    eval(h + l)
129	    assert l =="((1) if (x > 1) else (2) if (x > 2) else (3) if (x > 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:141:4
140	    l = lambdarepr(p)
141	    eval(h + l)
142	    assert l == "((1) if (x < 1) else (2) if (x < 2) else (3) if (x < 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_lambdarepr.py:153:4
152	    l = lambdarepr(p)
153	    eval(h + l)
154	    assert l == "((((1) if (x > 0) else (2))) if (y > 0) else (3))"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_latex.py:3139:11
3138	    import pickle
3139	    assert pickle.loads(pickle.dumps(latex)) is latex
3140	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:33:0
32	ENV: dict[str, Any] = {"Str": Str}
33	exec("from sympy import *", ENV)
34	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:47:8
46	        ENV2 = ENV.copy()
47	        exec(import_stmt, ENV2)
48	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:50:11
49	    assert srepr(expr, **kwargs) == string
50	    assert eval(string, ENV2) == expr
51	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:72:15
71	        expr = op(*symbols('x:256'))
72	        assert eval(srepr(expr)) == expr
73	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:184:11
183	    assert srepr(x) in (s1, s2)
184	    assert eval(srepr(x), ENV) == x
185	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_repr.py:206:16
205	    d = Dummy('d', nonzero=True)
206	    assert d == eval(srepr(d))
207	    s1 = "Dummy('d', dummy_index=%s, nonzero=True)" % str(d.dummy_index)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_tensorflow.py:55:28
54	    with graph.as_default():
55	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
56	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_tensorflow.py:87:28
86	    with graph.as_default():
87	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
88	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_tensorflow.py:115:28
114	    with graph.as_default():
115	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
116	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_tensorflow.py:132:18
131	    with graph.as_default():
132	        tf_rvs = [eval(tensorflow_code(i)) for i in rvs]
133	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/printing/tests/test_tensorflow.py:148:18
147	    with graph.as_default():
148	        tf_rvs = [eval(tensorflow_code(i)) for i in rvs]
149	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/testing/runtests.py:1243:16
1242	                code = compile(source, filename, "exec", flags=0, dont_inherit=True)
1243	                exec(code, gl)
1244	            except (SystemExit, KeyboardInterrupt):

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/_compilation/runners.py:191:12
190	        p = subprocess.Popen(' '.join(self.cmd()),
191	                             shell=True,
192	                             cwd=self.cwd,
193	                             stdin=subprocess.PIPE,
194	                             stdout=subprocess.PIPE,
195	                             stderr=subprocess.STDOUT,
196	                             env=env)
197	        comm = p.communicate()
198	        try:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/lambdify.py:163:21
162	        if import_command.startswith('import_module'):
163	            module = eval(import_command)
164	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/lambdify.py:170:16
169	            try:
170	                exec(import_command, {}, namespace)
171	                continue

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/lambdify.py:903:20
902	                try:
903	                    exec(ln, {}, namespace)
904	                except ImportError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/lambdify.py:909:20
908	                    ln = "%s = %s.%s" % (k, mod, k)
909	                    exec(ln, {}, namespace)
910	                imp_mod_lines.append(ln)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/lambdify.py:920:4
919	    c = compile(funcstr, filename, 'exec')
920	    exec(c, namespace, funclocals)
921	    # mtime has to be None or else linecache.checkcache will remove it

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/matchpy_connector.py:269:8
268	    def _get_lambda(self, lambda_str: str) -> Callable[..., Expr]:
269	        exec("from sympy import *")
270	        return eval(lambda_str, locals())

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/matchpy_connector.py:270:15
269	        exec("from sympy import *")
270	        return eval(lambda_str, locals())
271	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_lambdify.py:1521:11
1520	    assert lambdify((f, fx), f + fx)(10, 5) == 15
1521	    assert eval(lambdastr((f, fx), f/fx))(10, 5) == 2
1522	    raises(Exception, lambda:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_lambdify.py:1523:8
1522	    raises(Exception, lambda:
1523	        eval(lambdastr((f, fx), f/fx, dummify=False)))
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_lambdify.py:1524:11
1523	        eval(lambdastr((f, fx), f/fx, dummify=False)))
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1525	    assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_lambdify.py:1525:11
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1525	    assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half
1526	    assert lambdify(fx, 1 + fx)(41) == 42

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_lambdify.py:1527:11
1526	    assert lambdify(fx, 1 + fx)(41) == 42
1527	    assert eval(lambdastr(fx, 1 + fx, dummify=True))(41) == 42
1528	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_matchpy_connector.py:151:9
150	    a1 = WildDot("a")
151	    a2 = pickle.loads(pickle.dumps(a1))
152	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_matchpy_connector.py:155:9
154	    a1 = WildDot("a", S(1))
155	    a2 = pickle.loads(pickle.dumps(a1))
156	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_matchpy_connector.py:159:9
158	    a1 = WildPlus("a", S(1))
159	    a2 = pickle.loads(pickle.dumps(a1))
160	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_matchpy_connector.py:163:9
162	    a1 = WildStar("a", S(1))
163	    a2 = pickle.loads(pickle.dumps(a1))
164	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_pickling.py:74:16
73	        else:
74	            b = pickle.loads(pickle.dumps(a, protocol))
75	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_pickling.py:197:26
196	    copiers = [copy.copy, copy.deepcopy]
197	    copiers += [lambda x: pickle.loads(pickle.dumps(x, proto))
198	            for proto in protocols]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_pickling.py:712:11
711	def test_issue_18438():
712	    assert pickle.loads(pickle.dumps(S.Half)) == S.Half
713	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/sympy/utilities/tests/test_pickling.py:723:11
722	    )
723	    assert pickle.loads(data) == sqrt(2)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/threadpoolctl.py:1286:8
1285	    if options.command:
1286	        exec(options.command)
1287	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/aot_compile.py:78:27
77	        if self._artifacts.guard_manager is None:
78	            guards_state = pickle.loads(self._artifacts.guards_state)
79	            self._artifacts.guard_manager = torch._dynamo.guards.CheckFunctionManager(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/aot_compile.py:117:16
116	
117	        state = pickle.loads(data)
118	        state["bytecode"] = SerializedCode.to_code_object(state["bytecode"])

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py:458:14
457	        profile_path = Path(
458	            f"/tmp/{func.__name__}_{str(trace_id).replace('/', '_')}.profile"
459	        )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:1744:8
1743	        guards_log.debug("Python shape guard function:\n%s", pycode)
1744	        exec(pycode, globals_for_guard_fn, out)
1745	        guard_fn = out["___make_guard_fn"](*closure_vars.values())

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:1765:15
1764	            closure_vars = _get_closure_vars()
1765	        return eval(name, self.scope, closure_vars)
1766	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:2671:23
2670	                )
2671	                clib = CppCodeCache.load(func_str)
2672	                cguard = ctypes.cast(clib.guard, ctypes.c_void_p).value

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:4012:23
4011	        global_scope["__compile_source__"] = tensor_source
4012	        tensor_id = id(eval(tensor_source, global_scope, scope))
4013	        ids_to_source[tensor_id].append(tensor_source)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:4085:34
4084	                try:
4085	                    fail_reason = eval(part, global_scope, scope)
4086	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/guards.py:4242:12
4241	        try:
4242	            eval(guard, guard_manager.global_scope, local_scope)
4243	        except:  # noqa: B001,E722

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/package.py:293:15
292	    def after_deserialization(self) -> _DynamoCacheEntry:
293	        return pickle.loads(self.content)
294	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/package.py:642:35
641	                for guarded_code in entry.guarded_codes:
642	                    guards_state = pickle.loads(guarded_code.guards_state)
643	                    runtime_global_scope = sys.modules[entry.python_module].__dict__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/package.py:695:15
694	    def after_deserialization(self) -> Any:
695	        return pickle.loads(self.content)
696	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/package.py:886:30
885	            with open(os.path.join(path, "dynamo"), "rb") as dynamo_path:
886	                cache_entry = pickle.load(dynamo_path)
887	            with open(os.path.join(path, "backends"), "rb") as backend_path:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/package.py:888:34
887	            with open(os.path.join(path, "backends"), "rb") as backend_path:
888	                backend_content = pickle.load(backend_path)
889	            return cache_entry, backend_content

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/pgo.py:740:34
739	                    content = f.read()
740	                    _CODE_STATE = pickle.loads(content)
741	                    CompileEventLogger.pt2_compile(name, cache_size_bytes=f.tell())

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/pgo.py:775:29
774	                    )
775	                code_state = pickle.loads(payload)
776	            except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/replay_record.py:62:15
61	        assert dill is not None, "replay_record requires `pip install dill`"
62	        return dill.load(f)
63	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/test_minifier_common.py:150:24
149	                    with patch("sys.argv", args), report_compile_source_on_error():
150	                        exec(code, {"__name__": "__main__", "__compile_source__": code})
151	                    rc = 0

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/utils.py:2387:9
2386	    rotated = reversed(vars[-1:] + vars[:-1])
2387	    fn = eval(f"lambda {','.join(vars)}: ({','.join(rotated)})")
2388	    fn.__name__ = f"rot_{n}_helper"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/variables/tensor.py:303:43
302	            # Which is incorrect, and violates the invariant that all sources should be eval()-able against the scope.
303	            _input_associated_real_value = eval(self.source.name(), scope)
304	        except Exception as exc:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_dynamo/variables/tensor.py:540:43
539	        try:
540	            _input_associated_real_value = eval(self.source.name(), scope)
541	        except Exception as exc:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_export/serde/serialize.py:423:15
422	    # weights_only=False as we want to load custom objects here (e.g. ScriptObject)
423	    artifact = torch.load(buffer, weights_only=False)
424	    assert isinstance(artifact, (tuple, dict))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_functorch/_aot_autograd/autograd_cache.py:1041:16
1040	    def after_deserialization(self) -> Callable:
1041	        entry = pickle.loads(self.content)
1042	        # In the precompile use case, guards are already serialized

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_functorch/compilers.py:313:22
312	    with open(input_data_path, "rb") as f:
313	        inputs_meta = pickle.load(f)
314	        inputs = []

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_higher_order_ops/triton_kernel_wrap.py:1040:8
1039	        namespace: dict[str, Any] = {}
1040	        exec(code, namespace)
1041	        grid_fn = namespace[fn_name]

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/async_compile.py:398:16
397	            return getattr(
398	                torch._inductor.codecache.PyCodeCache.load(source_code), kernel_name
399	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/async_compile.py:527:19
526	        if get_compile_threads() <= 1:
527	            return CppCodeCache.load(source_code).kernel
528	        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/async_compile.py:551:19
550	                CUDACodeCache.aot_kernels_o.append(output_path)
551	            return CUDACodeCache.load(source_code, dst_file_ext)[0]
552	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/async_compile.py:569:19
568	                _ = ROCmCodeCache.compile(source_code, dst_file_ext="exe")
569	            return ROCmCodeCache.load(source_code, dst_file_ext)[0]
570	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/autotune_process.py:104:15
103	    def recv(read_pipe: IO[bytes]) -> Any:
104	        return pickle.load(read_pipe)
105	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/autotune_process.py:802:56
801	        if self.DLL is None:
802	            self.DLL, self.hash_key, self.source_file = CUDACodeCache.load(
803	                self.source_code, "so"
804	            )
805	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/autotune_process.py:837:8
836	        autotuning_log.debug("Precompiling %s", self)
837	        CppCodeCache.load(self.source_code, device_type="cpu")
838	        autotuning_log.debug("Done precompiling %s", self)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/autotune_process.py:844:19
843	        # TODO(jgong5): use CppPythonBindingsCodeCache for better binding perf
844	        self.DLL = CppCodeCache.load(self.source_code, device_type="cpu")
845	        args = [tensor.data_ptr() for tensor in list(input_tensors) + [out]]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codecache.py:1019:34
1018	                            content = f.read()
1019	                            yield pickle.loads(content), content
1020	                    except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codecache.py:1033:26
1032	                    content = base64.b64decode(data)
1033	                    yield pickle.loads(content), content
1034	            except Exception:

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codegen/common.py:2322:15
2321	
2322	        return jinja2.Environment(
2323	            undefined=jinja2.StrictUndefined,
2324	        )
2325	    except ImportError:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codegen/debug_utils.py:208:34
207	                cwd = os.getcwd()
208	                saved_dir = cwd + "/tmp/jit_inductor/"
209	                if not os.path.exists(saved_dir):

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codegen/rocm/rocm_benchmark_request.py:133:56
132	        if self.DLL is None:
133	            self.DLL, self.hash_key, self.source_file = ROCmCodeCache.load(
134	                self.source_code, "so"
135	            )
136	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codegen/wrapper.py:1693:12
1692	        try:
1693	            exec(tuning_code, scope)
1694	        except Exception as e:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/codegen/wrapper_fxir.py:208:14
207	        module_code = "\n".join([self.prologue, code])
208	        mod = PyCodeCache.load(module_code)
209	        kernel = getattr(mod, kernel_name)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/comm_analysis.py:186:9
185	
186	    fn = eval(py_kernel_name)
187	    args, kwargs = snode_args_kwargs(snode)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/compile_fx_ext.py:663:17
662	
663	        name = f"/tmp/aorenste/pytorch_compile_fx_tmp_input_{idx}.bin"
664	        with open(name, "wb") as f:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/compile_fx_ext.py:669:21
668	        if False:
669	            name = f"/tmp/aorenste/pytorch_compile_fx_tmp_actual_{idx}.bin"
670	            actual = self._run_in_child(pickled_input)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/compile_fx_ext.py:675:21
674	        elif False:
675	            name = f"/tmp/aorenste/pytorch_compile_fx_tmp_output_{idx}.bin"
676	            with open(name, "rb") as f:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py:114:15
113	    def loads(self, data: bytes) -> object:
114	        return pickle.loads(data)
115	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/compiler_bisector.py:288:31
287	            key, value = line.strip().split("=", 1)
288	            config_data[key] = eval(value)
289	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (output_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/cpp_builder.py:2000:24
1999	                    elif output_path.endswith(".so"):
2000	                        os.chmod(output_path, 0o755)
2001	            except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/debug.py:1177:13
1176	
1177	    folder = "/tmp/inductor_saved_args"
1178	    if not os.path.exists(folder):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/debug.py:1220:23
1219	    with open(path, "rb") as f:
1220	        args, kwargs = pickle.load(f)
1221	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/fuzzer.py:728:20
727	        with open(filename, "rb") as f:
728	            state = pickle.load(f)
729	            self.results = state["results"]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/ops_handler.py:789:8
788	        ctx: dict[str, Any] = {}
789	        exec(code.getvalue(), ctx)
790	        for target, impl in ctx.items():

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/cache_dir_utils.py:25:54
24	    return os.path.join(
25	        tempfile.gettempdir() if not is_fbcode() else "/var/tmp",
26	        "torchinductor_" + sanitized_username,

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/compile_tasks.py:33:8
32	        mod.key = key  # type: ignore[attr-defined]
33	        exec(code, mod.__dict__, mod.__dict__)
34	        if set_sys_modules:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/triton_heuristics.py:1390:8
1389	        launcher_code = "\n".join(lines)
1390	        exec(launcher_code, scope)
1391	        return scope["launcher"]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/triton_heuristics.py:3205:12
3204	        for line in self.prefix:
3205	            exec(line, scope)
3206	        exec(f"grid_0 = {self.x_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/triton_heuristics.py:3206:8
3205	            exec(line, scope)
3206	        exec(f"grid_0 = {self.x_grid}", scope)
3207	        exec(f"grid_1 = {self.y_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/triton_heuristics.py:3207:8
3206	        exec(f"grid_0 = {self.x_grid}", scope)
3207	        exec(f"grid_1 = {self.y_grid}", scope)
3208	        exec(f"grid_2 = {self.z_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/runtime/triton_heuristics.py:3208:8
3207	        exec(f"grid_1 = {self.y_grid}", scope)
3208	        exec(f"grid_2 = {self.z_grid}", scope)
3209	        return scope["grid_0"], scope["grid_1"], scope["grid_2"]

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/scheduler.py:3260:18
3259	            )
3260	            mod = PyCodeCache.load(src_code)
3261	            if not async_compile.use_process_pool():

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/select_algorithm.py:1273:15
1272	
1273	        return jinja2.Environment(
1274	            undefined=jinja2.StrictUndefined,
1275	        )
1276	    except ImportError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/select_algorithm.py:2033:20
2032	        tile = info["tile_shape"]
2033	        tile_vals = eval(tile)  # type: ignore[arg-type]
2034	        BLOCK_M = tile_vals[0]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/select_algorithm.py:3257:24
3256	
3257	            tile_vals = eval(tile)  # type: ignore[arg-type]
3258	            BLOCK_M = tile_vals[0]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/standalone_compile.py:112:40
111	                            with open(os.path.join(subdir, path), "rb") as f:
112	                                graph = pickle.load(f)
113	                            output_file = graph.write_to_disk()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/utils.py:646:4
645	    ctx = {"fn": fn}
646	    exec(
647	        f"""\
648	        def {name}_cache_on_self(self):
649	            try:
650	                return self.{key}
651	            except AttributeError:
652	                pass
653	            rv = fn(self)
654	            object.__setattr__(self, "{key}", rv)
655	            return rv
656	        """.lstrip(),
657	        ctx,
658	    )
659	    wrapper = functools.wraps(fn)(ctx[f"{name}_cache_on_self"])

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_inductor/utils.py:689:8
688	        ctx = {"fn": fn}
689	        exec(
690	            f"""\
691	            def inner(self: Any, *args: P.args, **kwargs: P.kwargs) -> RV:
692	                args_kwargs = (args, tuple(sorted(kwargs.items())))
693	
694	                if not hasattr(self, "{key}"):
695	                    object.__setattr__(self, "{key}", {{}})
696	
697	                cache = self.{key}
698	
699	                try:
700	                    return cache[args_kwargs]
701	                except KeyError:
702	                    pass
703	
704	                rv = fn(self, *args, **kwargs)
705	
706	                cache[args_kwargs] = rv
707	                return rv
708	            """.lstrip(),
709	            ctx,
710	        )
711	        inner = functools.wraps(fn)(ctx["inner"])

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/_library/infer_schema.py:73:19
72	        try:
73	            return eval(annotation_type, pf_globals, pf_locals)
74	        except Exception:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/_tensor_docs.py:2519:4
2518	    "index_reduce_",
2519	    r"""
2520	index_reduce_(dim, index, source, reduce, *, include_self=True) -> Tensor
2521	
2522	Accumulate the elements of ``source`` into the :attr:`self`
2523	tensor by accumulating to the indices in the order given in :attr:`index`
2524	using the reduction given by the ``reduce`` argument. For example, if ``dim == 0``,
2525	``index[i] == j``, ``reduce == prod`` and ``include_self == True`` then the ``i``\ th
2526	row of ``source`` is multiplied by the ``j``\ th row of :attr:`self`. If
2527	:obj:`include_self="True"`, the values in the :attr:`self` tensor are included
2528	in the reduction, otherwise, rows in the :attr:`self` tensor that are accumulated
2529	to are treated as if they were filled with the reduction identities.
2530	
2531	The :attr:`dim`\ th dimension of ``source`` must have the same size as the
2532	length of :attr:`index` (which must be a vector), and all other dimensions must
2533	match :attr:`self`, or an error will be raised.
2534	
2535	For a 3-D tensor with :obj:`reduce="prod"` and :obj:`include_self=True` the
2536	output is given as::
2537	
2538	    self[index[i], :, :] *= src[i, :, :]  # if dim == 0
2539	    self[:, index[i], :] *= src[:, i, :]  # if dim == 1
2540	    self[:, :, index[i]] *= src[:, :, i]  # if dim == 2
2541	
2542	Note:
2543	    {forward_reproducibility_note}
2544	
2545	.. note::
2546	
2547	    This function only supports floating point tensors.
2548	
2549	.. warning::
2550	
2551	    This function is in beta and may change in the near future.
2552	
2553	Args:
2554	    dim (int): dimension along which to index
2555	    index (Tensor): indices of ``source`` to select from,
2556	        should have dtype either `torch.int64` or `torch.int32`
2557	    source (FloatTensor): the tensor containing values to accumulate
2558	    reduce (str): the reduction operation to apply
2559	        (:obj:`"prod"`, :obj:`"mean"`, :obj:`"amax"`, :obj:`"amin"`)
2560	
2561	Keyword args:
2562	    include_self (bool): whether the elements from the ``self`` tensor are
2563	        included in the reduction
2564	
2565	Example::
2566	
2567	    >>> x = torch.empty(5, 3).fill_(2)
2568	    >>> t = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]], dtype=torch.float)
2569	    >>> index = torch.tensor([0, 4, 2, 0])
2570	    >>> x.index_reduce_(0, index, t, 'prod')
2571	    tensor([[20., 44., 72.],
2572	            [ 2.,  2.,  2.],
2573	            [14., 16., 18.],
2574	            [ 2.,  2.,  2.],
2575	            [ 8., 10., 12.]])
2576	    >>> x = torch.empty(5, 3).fill_(2)
2577	    >>> x.index_reduce_(0, index, t, 'prod', include_self=False)
2578	    tensor([[10., 22., 36.],
2579	            [ 2.,  2.,  2.],
2580	            [ 7.,  8.,  9.],
2581	            [ 2.,  2.,  2.],
2582	            [ 4.,  5.,  6.]])
2583	""".format(**reproducibility_notes),
2584	)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/torch/cuda/_memory_viz.py:101:12
100	        with tempfile.NamedTemporaryFile(mode="wb", suffix=".pl") as f:
101	            urllib.request.urlretrieve(
102	                "https://raw.githubusercontent.com/brendangregg/FlameGraph/master/flamegraph.pl",
103	                f.name,
104	            )
105	            try:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (name).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/cuda/_memory_viz.py:106:16
105	            try:
106	                os.chmod(f.name, 0o755)
107	                os.rename(f.name, flamegraph_script)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/cuda/_memory_viz.py:708:15
707	            f = open(name, "rb")
708	        data = pickle.load(f)
709	        if isinstance(data, list):  # segments only...

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/_serialization.py:55:18
54	    def read_from(self, f: BufferedIOBase) -> None:
55	        entries = _weights_only_unpickler.load(f)
56	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/_symmetric_memory/_nvshmem_triton.py:1158:53
1157	            for kernel in triton_kernels:
1158	                with tempfile.NamedTemporaryFile(dir="/tmp", delete=False) as f:
1159	                    f.write(kernel.asm["ptx"].encode("utf-8"))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/_tools/memory_tracker.py:221:20
220	        with open(path, "rb") as f:
221	            stats = pickle.load(f)
222	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/_experimental/checkpoint_reader.py:81:16
80	            result: tuple[STATE_DICT, list[str]] = (
81	                torch.load(file_path, map_location=map_location),
82	                [],

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/_experimental/checkpoint_reader.py:118:28
117	        with FakeTensorMode():
118	            metadata_dict = torch.load(file_path, map_location=map_location)
119	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/_pg_transport.py:303:31
302	
303	        meta: _StateDictMeta = pickle.loads(buf.cpu().numpy().tobytes())
304	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/default_planner.py:365:16
364	                self.mappings[read_item.dest_index.fqn],
365	                torch.load(value, weights_only=False),
366	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/default_planner.py:368:56
367	        else:
368	            self.state_dict[read_item.dest_index.fqn] = torch.load(
369	                value, weights_only=False
370	            )
371	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:925:23
924	        with self.fs.create_stream(path, "rb") as metadata_file:
925	            metadata = pickle.load(metadata_file)
926	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/format_utils.py:87:31
86	            assert self.checkpoint_id is not None
87	            torch_state_dict = torch.load(
88	                self.checkpoint_id, map_location="cpu", weights_only=False
89	            )
90	            if planner.flatten_state_dict:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/checkpoint/format_utils.py:236:17
235	
236	    state_dict = torch.load(torch_save_path, weights_only=False)
237	    # we don't need stateful behavior here because the expectation is anything loaded by

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:173:37
172	            if watchdog_file_path is None:
173	                watchdog_file_path = "/tmp/watchdog_timer_" + str(uuid.uuid4())
174	            logger.info("Starting a FileTimerServer with %s ...", watchdog_file_path)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:443:30
442	            try:
443	                self._state = pickle.loads(state_bits)
444	            except pickle.PickleError as exc:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/nn/api/remote_module.py:734:8
733	    f = io.BytesIO(recursive_script_module_serialized)
734	    m = torch.jit.load(f)
735	    return m

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/optim/zero_redundancy_optimizer.py:113:14
112	        buffer = io.BytesIO(data_recv_tensor.cpu().numpy())
113	        obj = torch.load(buffer, map_location=device, weights_only=False)
114	    return obj

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/distributed/rpc/internal.py:84:12
83	        f = io.BytesIO(script_module_serialized)
84	        m = torch.jit.load(f)
85	        return m

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/export/_trace.py:365:24
364	
365	                        eval(path, {"L": {"self": Path()}})
366	                        return ".".join(parts)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/export/_unlift.py:147:4
146	    namespace = {**SYMPY_INTERP}
147	    exec(code_str, namespace)
148	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/export/pt2_archive/_package.py:766:41
765	                )
766	                state_dict[weight_fqn] = torch.load(
767	                    io.BytesIO(weight_bytes), weights_only=False
768	                )
769	            else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/export/pt2_archive/_package.py:820:46
819	                    )
820	                    constants[constant_fqn] = torch.load(
821	                        io.BytesIO(constant_bytes), weights_only=False
822	                    )
823	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/export/pt2_archive/_package.py:991:32
990	                weight_bytes = archive_reader.read_bytes(file)
991	                loaded_weight = torch.load(io.BytesIO(weight_bytes))
992	                weights[weight_file_name] = loaded_weight

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py:145:11
144	    argnames = ",".join(f"arg{i}" for i in range(nargs))
145	    return eval(f"lambda {argnames}: fn({argnames})", {"fn": fn})
146	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/experimental/rewriter.py:48:8
47	        keys_before = set(globals_dict.keys())
48	        exec(code, globals_dict)
49	        new_keys = list(set(globals_dict.keys()) - keys_before)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/experimental/symbolic_shapes.py:6019:15
6018	        args = {str(e): val for e, val in self.var_to_val.items()}
6019	        return eval(code, SYMPY_INTERP, args)
6020	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/experimental/symbolic_shapes.py:6029:15
6028	        }
6029	        return eval(code, SYMPY_INTERP, args)
6030	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/experimental/symbolic_shapes.py:6037:15
6036	        arg_names = [f"t{i}" for i in range(len(args))]
6037	        return eval(code, SYMPY_INTERP, {"L": dict(zip(arg_names, args))})
6038	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/graph_module.py:94:4
93	    key = _loader.cache(src, globals, co_fields)
94	    exec(compile(src, key, "exec"), globals)
95	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/fx/operator_schemas.py:93:11
92	    """
93	    return eval(ts_type.annotation_str, _type_eval_globals)
94	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/torch/hub.py:161:17
160	        try:
161	            with urlopen(f"https://github.com/{repo_owner}/{repo_name}/tree/main/"):
162	                ref = "main"

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/torch/hub.py:185:9
184	def _read_url(url):
185	    with urlopen(url) as r:
186	        return r.read().decode(r.headers.get_content_charset("utf-8"))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/torch/hub.py:717:8
716	    req = Request(url, headers={"User-Agent": "torch.hub"})
717	    u = urlopen(req)
718	    meta = u.info()

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/hub.py:807:11
806	        extracted_file = os.path.join(model_dir, extraced_name)
807	    return torch.load(
808	        extracted_file, map_location=map_location, weights_only=weights_only
809	    )
810	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/hub.py:880:11
879	        return _legacy_zip_load(cached_file, model_dir, map_location, weights_only)
880	    return torch.load(cached_file, map_location=map_location, weights_only=weights_only)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/jit/annotations.py:209:11
208	            )
209	    return eval(bytecode, glob, loc)  # type: ignore[arg-type] # noqa: P204
210	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/jit/frontend.py:589:4
588	    g = copy.copy(globals())
589	    exec(ignore_func_str, g)  # noqa: P204
590	    # registers the custom function in the global context

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/jit/unsupported_tensor_ops.py:9:4
8	def execWrapper(code, glob, loc):
9	    exec(code, glob, loc)
10	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/multiprocessing/queue.py:21:15
20	        buf = self.recv_bytes()
21	        return pickle.loads(buf)
22	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/multiprocessing/spawn.py:217:29
216	        with open(self.error_files[error_index], "rb") as fh:
217	            original_trace = pickle.load(fh)
218	        msg = f"\n\n-- Process {error_index:d} terminated with the following error:\n"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/nn/modules/conv.py:816:8
815	    __doc__ = (
816	        r"""Applies a 1D transposed convolution operator over an input image
817	    composed of several input planes.
818	
819	    This module can be seen as the gradient of Conv1d with respect to its input.
820	    It is also known as a fractionally-strided convolution or
821	    a deconvolution (although it is not an actual deconvolution operation as it does
822	    not compute a true inverse of convolution). For more information, see the visualizations
823	    `here`_ and the `Deconvolutional Networks`_ paper.
824	
825	    This module supports :ref:`TensorFloat32<tf32_on_ampere>`.
826	
827	    On certain ROCm devices, when using float16 inputs this module will use :ref:`different precision<fp16_on_mi200>` for backward.
828	
829	    * :attr:`stride` controls the stride for the cross-correlation.
830	
831	    * :attr:`padding` controls the amount of implicit zero padding on both
832	      sides for ``dilation * (kernel_size - 1) - padding`` number of points. See note
833	      below for details.
834	
835	    * :attr:`output_padding` controls the additional size added to one side
836	      of the output shape. See note below for details.
837	"""
838	        """
839	    * :attr:`dilation` controls the spacing between the kernel points; also known as the \u00e0 trous algorithm.
840	      It is harder to describe, but the link `here`_ has a nice visualization of what :attr:`dilation` does.
841	"""
842	        r"""
843	    {groups_note}
844	
845	    Note:
846	        The :attr:`padding` argument effectively adds ``dilation * (kernel_size - 1) - padding``
847	        amount of zero padding to both sizes of the input. This is set so that
848	        when a :class:`~torch.nn.Conv1d` and a :class:`~torch.nn.ConvTranspose1d`
849	        are initialized with same parameters, they are inverses of each other in
850	        regard to the input and output shapes. However, when ``stride > 1``,
851	        :class:`~torch.nn.Conv1d` maps multiple input shapes to the same output
852	        shape. :attr:`output_padding` is provided to resolve this ambiguity by
853	        effectively increasing the calculated output shape on one side. Note
854	        that :attr:`output_padding` is only used to find output shape, but does
855	        not actually add zero-padding to output.
856	
857	    Note:
858	        In some circumstances when using the CUDA backend with CuDNN, this operator
859	        may select a nondeterministic algorithm to increase performance. If this is
860	        undesirable, you can try to make the operation deterministic (potentially at
861	        a performance cost) by setting ``torch.backends.cudnn.deterministic =
862	        True``.
863	        Please see the notes on :doc:`/notes/randomness` for background.
864	
865	
866	    Args:
867	        in_channels (int): Number of channels in the input image
868	        out_channels (int): Number of channels produced by the convolution
869	        kernel_size (int or tuple): Size of the convolving kernel
870	        stride (int or tuple, optional): Stride of the convolution. Default: 1
871	        padding (int or tuple, optional): ``dilation * (kernel_size - 1) - padding`` zero-padding
872	            will be added to both sides of the input. Default: 0
873	        output_padding (int or tuple, optional): Additional size added to one side
874	            of the output shape. Default: 0
875	        groups (int, optional): Number of blocked connections from input channels to output channels. Default: 1
876	        bias (bool, optional): If ``True``, adds a learnable bias to the output. Default: ``True``
877	        dilation (int or tuple, optional): Spacing between kernel elements. Default: 1
878	    """.format(**reproducibility_notes, **convolution_notes)
879	        + r"""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/nn/modules/rnn.py:636:18
635	            raise ValueError(
636	                f"Unknown nonlinearity '{self.nonlinearity}'. Select from 'tanh' or 'relu'."
637	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_compat.py:195:53
194	            )
195	            onnx_program = _onnx_program.ONNXProgram(ir.load(f), None)
196	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/optim/sgd.py:154:4
153	SGD.__doc__ = (
154	    r"""Implements stochastic gradient descent (optionally with momentum).
155	
156	    .. math::
157	       \begin{aligned}
158	            &\rule{110mm}{0.4pt}                                                                 \\
159	            &\textbf{input}      : \gamma \text{ (lr)}, \: \theta_0 \text{ (params)}, \: f(\theta)
160	                \text{ (objective)}, \: \lambda \text{ (weight decay)},                          \\
161	            &\hspace{13mm} \:\mu \text{ (momentum)}, \:\tau \text{ (dampening)},
162	            \:\textit{ nesterov,}\:\textit{ maximize}                                     \\[-1.ex]
163	            &\rule{110mm}{0.4pt}                                                                 \\
164	            &\textbf{for} \: t=1 \: \textbf{to} \: \ldots \: \textbf{do}                         \\
165	            &\hspace{5mm}\textbf{if} \: \textit{maximize}:                                       \\
166	            &\hspace{10mm}g_t           \leftarrow   -\nabla_{\theta} f_t (\theta_{t-1})         \\
167	            &\hspace{5mm}\textbf{else}                                                           \\
168	            &\hspace{10mm}g_t           \leftarrow   \nabla_{\theta} f_t (\theta_{t-1})          \\
169	            &\hspace{5mm}\textbf{if} \: \lambda \neq 0                                           \\
170	            &\hspace{10mm} g_t \leftarrow g_t + \lambda  \theta_{t-1}                            \\
171	            &\hspace{5mm}\textbf{if} \: \mu \neq 0                                               \\
172	            &\hspace{10mm}\textbf{if} \: t > 1                                                   \\
173	            &\hspace{15mm} \textbf{b}_t \leftarrow \mu \textbf{b}_{t-1} + (1-\tau) g_t           \\
174	            &\hspace{10mm}\textbf{else}                                                          \\
175	            &\hspace{15mm} \textbf{b}_t \leftarrow g_t                                           \\
176	            &\hspace{10mm}\textbf{if} \: \textit{nesterov}                                       \\
177	            &\hspace{15mm} g_t \leftarrow g_{t} + \mu \textbf{b}_t                               \\
178	            &\hspace{10mm}\textbf{else}                                                   \\[-1.ex]
179	            &\hspace{15mm} g_t  \leftarrow  \textbf{b}_t                                         \\
180	            &\hspace{5mm}\theta_t \leftarrow \theta_{t-1} - \gamma g_t                    \\[-1.ex]
181	            &\rule{110mm}{0.4pt}                                                          \\[-1.ex]
182	            &\bf{return} \:  \theta_t                                                     \\[-1.ex]
183	            &\rule{110mm}{0.4pt}                                                          \\[-1.ex]
184	       \end{aligned}
185	
186	    Nesterov momentum is based on the formula from
187	    `On the importance of initialization and momentum in deep learning`__.
188	    """
189	    + rf"""
190	    Args:
191	        {_params_doc}
192	        lr (float, Tensor, optional): learning rate (default: 1e-3)
193	        momentum (float, optional): momentum factor (default: 0)
194	        dampening (float, optional): dampening for momentum (default: 0)
195	        weight_decay (float, optional): weight decay (L2 penalty) (default: 0)
196	        nesterov (bool, optional): enables Nesterov momentum. Only applicable
197	            when momentum is non-zero. (default: False)
198	        {_maximize_doc}
199	        {_foreach_doc}
200	        {_differentiable_doc}
201	        {_fused_doc}
202	    """
203	    + r"""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/torch/optim/sgd.py:203:6
202	    """
203	    + r"""
204	
205	    Example:
206	        >>> # xdoctest: +SKIP
207	        >>> optimizer = torch.optim.SGD(model.parameters(), lr=0.1, momentum=0.9)
208	        >>> optimizer.zero_grad()
209	        >>> loss_fn(model(input), target).backward()
210	        >>> optimizer.step()
211	
212	    __ http://www.cs.toronto.edu/%7Ehinton/absps/momentum.pdf
213	
214	    .. note::
215	        The implementation of SGD with Momentum/Nesterov subtly differs from
216	        Sutskever et al. and implementations in some other frameworks.
217	
218	        Considering the specific case of Momentum, the update can be written as
219	
220	        .. math::
221	            \begin{aligned}
222	                v_{t+1} & = \mu * v_{t} + g_{t+1}, \\
223	                p_{t+1} & = p_{t} - \text{lr} * v_{t+1},
224	            \end{aligned}
225	
226	        where :math:`p`, :math:`g`, :math:`v` and :math:`\mu` denote the
227	        parameters, gradient, velocity, and momentum respectively.
228	
229	        This is in contrast to Sutskever et al. and
230	        other frameworks which employ an update of the form
231	
232	        .. math::
233	            \begin{aligned}
234	                v_{t+1} & = \mu * v_{t} + \text{lr} * g_{t+1}, \\
235	                p_{t+1} & = p_{t} - v_{t+1}.
236	            \end{aligned}
237	
238	        The Nesterov version is analogously modified.
239	
240	        Moreover, the initial value of the momentum buffer is set to the
241	        gradient value at the first step. This is in contrast to some other
242	        frameworks that initialize it to all zeros. One notable side effect
243	        of this decision is that the first momentum value will not be scaled
244	        by dampening. Dampening will be applied starting at the second step.
245	
246	    """
247	)
248	
249	
250	def sgd(
251	    params: list[Tensor],
252	    d_p_list: list[Tensor],
253	    momentum_buffer_list: list[Optional[Tensor]],
254	    # kwonly args with defaults are not supported by functions compiled with torchscript issue #70627
255	    # setting this as kwarg for now as functional API is compiled by torch/distributed/optim
256	    has_sparse_grad: bool = False,
257	    foreach: Optional[bool] = None,
258	    fused: Optional[bool] = None,
259	    grad_scale: Optional[Tensor] = None,
260	    found_inf: Optional[Tensor] = None,
261	    *,
262	    weight_decay: float,
263	    momentum: float,
264	    lr: float,
265	    dampening: float,
266	    nesterov: bool,
267	    maximize: bool,
268	):
269	    r"""Functional API that performs SGD algorithm computation.
270	
271	    See :class:`~torch.optim.SGD` for details.
272	    """
273	    # Respect when the user inputs False/True for foreach or fused. We only want to change
274	    # the default when neither have been user-specified. Note that we default to foreach
275	    # and pass False to use_fused. This is not a mistake--we want to give the fused impl
276	    # bake-in time before making it the default, even if it is typically faster.
277	    if foreach is None and fused is None:
278	        # why must we be explicit about an if statement for torch.jit.is_scripting here?
279	        # because JIT can't handle Optionals nor fancy conditionals when scripting
280	        if not torch.jit.is_scripting():
281	            fused, foreach = _default_to_fused_or_foreach(
282	                params, differentiable=False, use_fused=False
283	            )
284	        else:
285	            foreach = False
286	            fused = False
287	    if foreach is None:
288	        foreach = False
289	    if fused is None:
290	        fused = False
291	
292	    if foreach and torch.jit.is_scripting():
293	        raise RuntimeError("torch.jit.script not supported with foreach optimizers")
294	    if fused and torch.jit.is_scripting():
295	        raise RuntimeError("torch.jit.script not supported with fused optimizers")
296	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/package/package_importer.py:401:12
400	            code = self._compile_source(filename, mangled_filename)
401	            exec(code, ns)
402	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/serialization.py:1505:27
1504	                    opened_file.seek(orig_position)
1505	                    return torch.jit.load(opened_file, map_location=map_location)
1506	                if mmap:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/storage.py:534:11
533	def _load_from_bytes(b):
534	    return torch.load(io.BytesIO(b), weights_only=False)
535	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_jit.py:169:19
168	        buffer.seek(0)
169	        imported = torch.jit.load(buffer, map_location=map_location)
170	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_jit.py:176:19
175	            torch.jit.save(imported, fname)
176	            return torch.jit.load(fname, map_location=map_location)
177	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_nn.py:3447:34
3446	                    # weights_only=False as this is legacy code that saves the model
3447	                    module_copy = torch.load(f, weights_only=False)
3448	                    test_case.assertEqual(test_case._forward(module, input), test_case._forward(module_copy, input))

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_quantization.py:813:22
812	        # weights_only=False as we sometimes get a ScriptObect here (weird)
813	        loaded_dict = torch.load(b, weights_only=False)
814	        loaded_model.load_state_dict(loaded_dict)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_quantization.py:831:17
830	        # weights_only=False as this is legacy code that saves the model
831	        loaded = torch.load(b, weights_only=False)
832	        load_out = loaded(*x)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_quantization.py:890:21
889	        buffer.seek(0)
890	        loaded_mod = torch.jit.load(buffer)
891	        # Pending __get_state_ and __set_state__ support

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_quantization.py:1354:22
1353	        b.seek(0)
1354	        loaded_dict = torch.load(b)
1355	        embedding_unpack = torch.ops.quantized.embedding_bag_unpack

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_utils.py:1159:11
1158	    import xml.etree.ElementTree as ET
1159	    tree = ET.parse(xml_file)
1160	    for testcase in tree.iter('testcase'):

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/common_utils.py:4569:15
4568	    try:
4569	        data = request.urlopen(url, timeout=15).read()
4570	        with open(path, 'wb' if binary else 'w') as f:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:4271:40
4270	                            # weights_only=False as this is legacy code that saves the model
4271	                            model_DDP = torch.load(tmp, weights_only=False)
4272	                        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:4275:40
4274	                            # weights_only=False as this is legacy code that saves the model
4275	                            model_DDP = torch.load(tmp.name, weights_only=False)
4276	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:4281:30
4280	                # weights_only=False as this is legacy code that saves the model
4281	                saved_model = torch.load(tmp_file, weights_only=False)
4282	            for k in model_DDP.state_dict():

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:4323:32
4322	                    # weights_only=False as this is legacy code that saves the model
4323	                    model_DDP = torch.load(tmp, weights_only=False)
4324	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:4327:32
4326	                    # weights_only=False as this is legacy code that saves the model
4327	                    model_DDP = torch.load(tmp.name, weights_only=False)
4328	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:5606:32
5605	                    # weights_only=False as this is legacy code that saves the model
5606	                    model_DDP = torch.load(tmp, weights_only=False)
5607	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:5610:32
5609	                    # weights_only=False as this is legacy code that saves the model
5610	                    model_DDP = torch.load(tmp.name, weights_only=False)
5611	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:5736:25
5735	            map_location = {"cuda:0": f"cuda:{self.rank:d}"}
5736	            checkpoint = torch.load(chkpt_file, map_location=map_location)
5737	            dummy_post_localSGD_opt.load_state_dict(checkpoint["optimizer_state_dict"])

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/distributed_test.py:10149:29
10148	            with self.assertLogs("torch.distributed") as captured:
10149	                checkpoint = torch.load(chkpt_file, map_location=map_location)
10150	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/distributed/rpc/jit/rpc_test.py:870:8
869	    f = io.BytesIO(pickled_script_module)
870	    m = torch.jit.load(f)
871	    return m()

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/inductor_utils.py:50:8
49	    try:
50	        CppCodeCache.load("")
51	        return not IS_FBCODE

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/jit_utils.py:56:4
55	def execWrapper(code, glob, loc):
56	    exec(code, glob, loc)
57	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/jit_utils.py:212:27
211	            debug_files_stream = (archive.open(f) for f in debug_files_str)
212	            debug_files = (pickle.load(f) for f in debug_files_stream)
213	            return code_files, debug_files

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/jit_utils.py:243:23
242	            buffer2 = io.BytesIO(buffer_copy)
243	            imported = torch.jit.load(buffer2)
244	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/jit_utils.py:275:19
274	        buffer.seek(0)
275	        imported = torch.jit.load(buffer, map_location=map_location)
276	        imported.apply(lambda s: s._unpack() if s._c._has_method('_unpack') else None)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/testing/_internal/jit_utils.py:288:21
287	            imported.save(f.name)
288	            result = torch.jit.load(f.name, map_location=map_location)
289	        finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/_config_module.py:619:21
618	        if not isinstance(maybe_pickled_config, dict):
619	            config = pickle.loads(maybe_pickled_config)
620	        else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/_traceback.py:113:29
112	                    )
113	                fake_frame = eval(
114	                    code,
115	                    frame.f_globals,
116	                    {**frame.f_locals, "__inspect_currentframe": inspect.currentframe},
117	                )
118	                fake_tb = TracebackType(None, fake_frame, tb.tb_lasti, tb.tb_lineno)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/benchmark/examples/compare.py:86:8
85	    comparison = benchmark_utils.Compare([
86	        pickle.loads(i) for i in serialized_results
87	    ])

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/benchmark/utils/common.py:314:15
313	    if use_dev_shm:
314	        root = "/dev/shm/pytorch_benchmark_utils"
315	        assert os.name == "posix", f"tmpfs (/dev/shm) is POSIX only, current platform is {os.name}"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/benchmark/utils/common.py:316:30
315	        assert os.name == "posix", f"tmpfs (/dev/shm) is POSIX only, current platform is {os.name}"
316	        assert os.path.exists("/dev/shm"), "This system does not appear to support tmpfs (/dev/shm)."
317	        os.makedirs(root, exist_ok=True)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/benchmark/utils/cpp_jit.py:96:40
95	        if COMPAT_CALLGRIND_BINDINGS is None:
96	            COMPAT_CALLGRIND_BINDINGS = cpp_extension.load(
97	                name="callgrind_bindings",
98	                sources=[os.path.join(
99	                    SOURCE_ROOT,
100	                    "valgrind_wrapper",
101	                    "compat_bindings.cpp"
102	                )],
103	                extra_cflags=CXX_FLAGS,
104	                extra_include_paths=EXTRA_INCLUDE_PATHS,
105	            )
106	    return COMPAT_CALLGRIND_BINDINGS

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/benchmark/utils/cpp_jit.py:144:11
143	    # `cpp_extension` has its own locking scheme, so we don't need our lock.
144	    return cpp_extension.load(
145	        name=name,
146	        sources=[src_path],
147	        build_directory=build_dir,
148	        extra_cflags=CXX_FLAGS,
149	        extra_include_paths=EXTRA_INCLUDE_PATHS,
150	        is_python_module=not is_standalone,
151	        is_standalone=is_standalone,
152	    )
153	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/bottleneck/__main__.py:75:4
74	    prof.enable()
75	    exec(code, globs, None)
76	    prof.disable()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/bottleneck/__main__.py:96:12
95	        with profiler.profile(use_cuda=use_cuda) as prof:
96	            exec(code, globs, None)
97	        return prof

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/collect_env.py:124:8
123	    p = subprocess.Popen(
124	        command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=shell
125	    )
126	    raw_output, raw_err = p.communicate()
127	    rc = p.returncode

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1816:12
1815	        try:
1816	            subprocess.check_output(pch_cmd, shell=True, stderr=subprocess.STDOUT)
1817	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/cpp_extension.py:2599:8
2598	            command,
2599	            shell=IS_WINDOWS and IS_HIP_EXTENSION,
2600	            stdout=stdout_fileno if verbose else subprocess.PIPE,
2601	            stderr=subprocess.STDOUT,
2602	            cwd=build_directory,
2603	            check=True,
2604	            env=env)
2605	    except subprocess.CalledProcessError as e:
2606	        # Python 2 and 3 compatible way of getting the error object.
2607	        _, error, _ = sys.exc_info()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/data/datapipes/datapipe.py:391:29
390	        if use_dill:
391	            self._datapipe = dill.loads(value)
392	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/data/datapipes/datapipe.py:393:29
392	        else:
393	            self._datapipe = pickle.loads(value)
394	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/data/datapipes/utils/decoder.py:74:15
73	    if extension in "pyd pickle".split():
74	        return pickle.loads(data)
75	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/data/datapipes/utils/decoder.py:78:15
77	        stream = io.BytesIO(data)
78	        return torch.load(stream)
79	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/torch/utils/model_dump/__init__.py:259:27
258	            # to ensure that we cover the entire source code.
259	            debug_info_t = pickle.loads(raw_debug)
260	            text_table = None

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/gen.py:241:17
240	        with open(path) as f:
241	            es = yaml.load(f, Loader=LineLoader)
242	            _GLOBAL_PARSE_TAGS_YAML_CACHE[path] = parse_tags_yaml_struct(es, path=path)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/gen.py:262:21
261	            with open(path) as f:
262	                es = yaml.load(f, Loader=LineLoader)
263	        else:

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/gen_backend_stubs.py:57:22
56	    with open(backend_yaml_path) as f:
57	        yaml_values = yaml.load(f, Loader=YamlLoader)
58	    assert isinstance(yaml_values, dict)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/gen_lazy_tensor.py:103:22
102	    with open(backend_yaml_path) as f:
103	        yaml_values = yaml.load(f, Loader=YamlLoader)
104	    assert isinstance(yaml_values, dict)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/packaged/autograd/gen_python_functions.py:604:26
603	    with open(deprecated_yaml_path) as f:
604	        deprecated_defs = yaml.load(f, Loader=YamlLoader)
605	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.11/site-packages/torchgen/packaged/autograd/load_derivatives.py:113:26
112	        with open(derivatives_yaml_path) as f:
113	            definitions = yaml.load(f, Loader=YamlLoader)
114	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/tqdm/cli.py:38:19
37	        if re.match(r"^\\\w+$", val):
38	            return eval(f'"{val}"').encode()
39	        raise TqdmTypeError(f"{val} : {typ}")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/chat.py:488:36
487	                filename = os.path.basename(args.generation_config)
488	                generation_config = GenerationConfig.from_pretrained(dirname, filename)
489	            else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/chat.py:490:36
489	            else:
490	                generation_config = GenerationConfig.from_pretrained(args.generation_config)
491	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/chat.py:554:20
553	    def load_model_and_tokenizer(self, args: ChatArguments) -> tuple["AutoModelForCausalLM", AutoTokenizer]:
554	        tokenizer = AutoTokenizer.from_pretrained(
555	            args.model_name_or_path_positional,
556	            revision=args.model_revision,
557	            trust_remote_code=args.trust_remote_code,
558	        )
559	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/chat.py:569:16
568	        }
569	        model = AutoModelForCausalLM.from_pretrained(
570	            args.model_name_or_path_positional, trust_remote_code=args.trust_remote_code, **model_kwargs
571	        )
572	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/chat.py:703:34
702	
703	        model_generation_config = GenerationConfig.from_pretrained(args.model_name_or_path)
704	        generation_config, model_kwargs = self.get_generation_parameterization(args, model_generation_config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/commands/serving.py:1605:25
1604	
1605	        data_processor = AutoProcessor.from_pretrained(
1606	            model_id,
1607	            revision=revision,
1608	            trust_remote_code=args.trust_remote_code,
1609	        )
1610	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/data/datasets/language_modeling.py:77:36
76	                with open(cached_features_file, "rb") as handle:
77	                    self.examples = pickle.load(handle)
78	                logger.info(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/data/datasets/language_modeling.py:401:36
400	                with open(cached_features_file, "rb") as handle:
401	                    self.examples = pickle.load(handle)
402	                logger.info(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/integrations/integration_utils.py:537:19
536	            torch.distributed.broadcast_object_list(args_main_rank, src=0)
537	            args = pickle.loads(bytes(args_main_rank))
538	            for key, value in asdict(args).items():

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/modeling_utils.py:526:15
525	            extra_args = {"mmap": True}
526	        return torch.load(
527	            checkpoint_file,
528	            map_location=map_location,
529	            weights_only=weights_only,
530	            **extra_args,
531	        )
532	    except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/bloom/tokenization_bloom_fast.py:121:47
120	            decoder_state = decoder_state.replace(b'"add_prefix_space":false', b'"add_prefix_space": true')
121	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
122	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/bloom/tokenization_bloom_fast.py:122:41
121	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
122	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)
123	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/cohere/tokenization_cohere_fast.py:158:47
157	            decoder_state = decoder_state.replace(b'"add_prefix_space":false', b'"add_prefix_space": true')
158	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
159	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/cohere/tokenization_cohere_fast.py:159:41
158	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
159	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)
160	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/deprecated/deta/modeling_deta.py:71:36
70	
71	    MultiScaleDeformableAttention = load(
72	        "MultiScaleDeformableAttention",
73	        src_files,
74	        with_cuda=True,
75	        extra_include_paths=[str(root)],
76	        extra_cflags=["-DWITH_CUDA=1"],
77	        extra_cuda_cflags=[
78	            "-DCUDA_HAS_FP16=1",
79	            "-D__CUDA_NO_HALF_OPERATORS__",
80	            "-D__CUDA_NO_HALF_CONVERSIONS__",
81	            "-D__CUDA_NO_HALF2_OPERATORS__",
82	        ],
83	    )
84	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/deprecated/realm/retrieval_realm.py:115:33
114	        else:
115	            block_records_path = hf_hub_download(
116	                repo_id=pretrained_model_name_or_path, filename=_REALM_BLOCK_RECORDS_FILENAME, **kwargs
117	            )
118	        if not strtobool(os.environ.get("TRUST_REMOTE_CODE", "False")):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/deprecated/realm/retrieval_realm.py:128:20
127	
128	        tokenizer = AutoTokenizer.from_pretrained(pretrained_model_name_or_path, *init_inputs, **kwargs)
129	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/deprecated/transfo_xl/tokenization_transfo_xl.py:214:33
213	                with open(pretrained_vocab_file, "rb") as f:
214	                    vocab_dict = pickle.load(f)
215	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/deprecated/transfo_xl/tokenization_transfo_xl.py:802:21
801	        with open(fn, "rb") as fp:
802	            corpus = pickle.load(fp)
803	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/encoder_decoder/modeling_encoder_decoder.py:231:24
230	            #   (the change in `src/transformers/modeling_tf_utils.py`)
231	            _tf_model = TFEncoderDecoderModel.from_pretrained(pretrained_model_name_or_path, *model_args, **kwargs)
232	            config = _tf_model.config

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py:384:16
383	            raise NotImplementedError(
384	                "Only attn layer types 'global' and 'local' exist, but got `config.attention_layers`: "
385	                f"{config.attention_layers}. Select attn layer types from ['global', 'local'] only."
386	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/luke/tokenization_luke.py:361:18
360	            raise ValueError(
361	                f"Task {task} not supported. Select task from ['entity_classification', 'entity_pair_classification',"
362	                " 'entity_span_classification'] only."
363	            )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/megatron_gpt2/checkpoint_reshaping_and_interoperability.py:564:16
563	
564	    tokenizer = AutoTokenizer.from_pretrained(tokenizer_name)
565	    tokenizer_class = type(tokenizer).__name__

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/megatron_gpt2/checkpoint_reshaping_and_interoperability.py:647:13
646	
647	    config = GPT2Config.from_pretrained(args.load_path)
648	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/mgp_str/processing_mgp_str.py:72:29
71	        self.char_tokenizer = tokenizer
72	        self.bpe_tokenizer = AutoTokenizer.from_pretrained("openai-community/gpt2")
73	        self.wp_tokenizer = AutoTokenizer.from_pretrained("google-bert/bert-base-uncased")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/mgp_str/processing_mgp_str.py:73:28
72	        self.bpe_tokenizer = AutoTokenizer.from_pretrained("openai-community/gpt2")
73	        self.wp_tokenizer = AutoTokenizer.from_pretrained("google-bert/bert-base-uncased")
74	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/mluke/tokenization_mluke.py:305:18
304	            raise ValueError(
305	                f"Task {task} not supported. Select task from ['entity_classification', 'entity_pair_classification',"
306	                " 'entity_span_classification'] only."
307	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/mra/modeling_mra.py:56:22
55	
56	    mra_cuda_kernel = load("cuda_kernel", src_files, verbose=True)
57	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/oneformer/image_processing_oneformer.py:365:20
364	        try:
365	            fname = hf_hub_download(repo_id, class_info_file, repo_type="dataset")
366	        except RepositoryNotFoundError:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/oneformer/image_processing_oneformer.py:367:20
366	        except RepositoryNotFoundError:
367	            fname = hf_hub_download(repo_id, class_info_file)
368	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/pix2struct/image_processing_pix2struct.py:129:15
128	    else:
129	        font = hf_hub_download(DEFAULT_FONT_PATH, "Arial.TTF")
130	    font = ImageFont.truetype(font, encoding="UTF-8", size=text_size)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/rag/retrieval_rag.py:144:23
143	        with open(passages_path, "rb") as passages_file:
144	            passages = pickle.load(passages_file)
145	        return passages

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/rag/retrieval_rag.py:160:37
159	        with open(resolved_meta_path, "rb") as metadata_file:
160	            self.index_id_to_db_id = pickle.load(metadata_file)
161	        assert len(self.index_id_to_db_id) == self.index.ntotal, (

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/rag/retrieval_rag.py:284:18
283	        logger.info(f"Loading passages from {self.dataset_name}")
284	        dataset = load_dataset(
285	            self.dataset_name,
286	            with_index=False,
287	            split=self.dataset_split,
288	            dummy=self.use_dummy_dataset,
289	            revision=dataset_revision,
290	        )
291	        super().__init__(vector_size, dataset, index_initialized=False)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/rag/retrieval_rag.py:299:27
298	            logger.info(f"Loading index from {self.dataset_name} with index name {self.index_name}")
299	            self.dataset = load_dataset(
300	                self.dataset_name,
301	                with_embeddings=True,
302	                with_index=True,
303	                split=self.dataset_split,
304	                index_name=self.index_name,
305	                dummy=self.use_dummy_dataset,
306	                revision=self.dataset_revision,
307	            )
308	            self.dataset.set_format("numpy", columns=["embeddings"], output_all_columns=True)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/reformer/modeling_reformer.py:196:14
195	        raise NotImplementedError(
196	            f"Only attn layer types 'lsh' and 'local' exist, but `config.attn_layers`: {config.attn_layers}. Select "
197	            "attn layer types from ['lsh', 'local'] only."
198	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/reformer/modeling_reformer.py:212:14
211	        raise NotImplementedError(
212	            f"Only attn layer types 'lsh' and 'local' exist, but `config.attn_layers`: {config.attn_layers}. Select "
213	            "attn layer types from ['lsh', 'local'] only."
214	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/reformer/modeling_reformer.py:1395:18
1394	            raise NotImplementedError(
1395	                f"Only attn layer types 'lsh' and 'local' exist, but got `config.attn_layers`: {self.attn_layers}. "
1396	                "Select attn layer types from ['lsh', 'local'] only."
1397	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/rwkv/modeling_rwkv.py:69:23
68	    ]
69	    rwkv_cuda_kernel = load_kernel(
70	        name=f"wkv_{context_length}",
71	        sources=cuda_kernel_files,
72	        verbose=(logging.get_verbosity() == logging.DEBUG),
73	        extra_cuda_cflags=flags,
74	    )
75	    rwkv_cuda_kernel.max_seq_length = context_length

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/vision_encoder_decoder/modeling_vision_encoder_decoder.py:202:24
201	            #   (the change in `src/transformers/modeling_tf_utils.py`)
202	            _tf_model = TFVisionEncoderDecoderModel.from_pretrained(
203	                pretrained_model_name_or_path, *model_args, **kwargs
204	            )
205	            config = _tf_model.config

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/xcodec/configuration_xcodec.py:131:45
130	                # If the config is a path, load it using AutoConfig
131	                self.semantic_model_config = AutoConfig.from_pretrained(semantic_model_config["_name_or_path"])
132	            else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/models/yoso/modeling_yoso.py:62:4
61	
62	    load("fast_lsh_cumulation", src_files, verbose=True)
63	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/pipelines/audio_classification.py:174:25
173	                # like http_huggingface_co.png
174	                inputs = requests.get(inputs).content
175	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/pipelines/automatic_speech_recognition.py:363:25
362	                # like http_huggingface_co.png
363	                inputs = requests.get(inputs).content
364	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/pipelines/video_classification.py:145:28
144	        if video.startswith("http://") or video.startswith("https://"):
145	            video = BytesIO(requests.get(video).content)
146	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/pipelines/zero_shot_audio_classification.py:114:24
113	                # like http_huggingface_co.png
114	                audio = requests.get(audio).content
115	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/safetensors_conversion.py:47:13
46	
47	    result = requests.post(sse_url, stream=True, json=data).json()
48	    event_id = result["event_id"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/safetensors_conversion.py:50:9
49	
50	    with requests.get(f"{sse_url}/{event_id}", stream=True) as sse_connection:
51	        try:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/trainer.py:3255:35
3254	        with safe_globals():
3255	            checkpoint_rng_state = torch.load(rng_file)
3256	        random.setstate(checkpoint_rng_state["python"])

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/trainer.py:3561:48
3560	                        def opt_load_hook(mod, opt):
3561	                            opt.load_state_dict(smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True))
3562	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/trainer.py:3568:36
3567	                                opt.load_state_dict(
3568	                                    smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True, back_compat=True)
3569	                                )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/trainer.py:3571:52
3570	                            else:
3571	                                opt.load_state_dict(smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True))
3572	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/attention_visualizer.py:183:29
182	            img = "https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/bee.jpg?download=true"
183	            img = Image.open(requests.get(img, stream=True).raw)
184	            image_seq_length = 5

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/backbone_utils.py:343:19
342	        # to determine whether to load the pretrained weights.
343	        backbone = AutoBackbone.from_pretrained(
344	            backbone_checkpoint,
345	            use_timm_backbone=use_timm_backbone,
346	            use_pretrained_backbone=use_pretrained_backbone,
347	            **backbone_kwargs,
348	        )
349	    elif use_pretrained_backbone:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/backbone_utils.py:352:19
351	            raise ValueError("config.backbone must be set if use_pretrained_backbone is True")
352	        backbone = AutoBackbone.from_pretrained(backbone_checkpoint, **backbone_kwargs)
353	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/backbone_utils.py:357:30
356	        if backbone_config is None:
357	            backbone_config = AutoConfig.from_pretrained(backbone_checkpoint, **backbone_kwargs)
358	        backbone = AutoBackbone.from_config(config=backbone_config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/hub.py:185:23
184	    try:
185	        snapshot_dir = snapshot_download(
186	            repo_id=repo_id, revision=revision, cache_dir=cache_dir, local_files_only=True
187	        )
188	    except LocalEntryNotFoundError:  # No local repo means no local files

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/hub.py:203:24
202	    try:
203	        instance_data = requests.get(os.environ["ECS_CONTAINER_METADATA_URI"]).json()
204	        dlc_container_used = instance_data["Image"]

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/hub.py:479:12
478	            # This is slightly better for only 1 file
479	            hf_hub_download(
480	                path_or_repo_id,
481	                filenames[0],
482	                subfolder=None if len(subfolder) == 0 else subfolder,
483	                repo_type=repo_type,
484	                revision=revision,
485	                cache_dir=cache_dir,
486	                user_agent=user_agent,
487	                force_download=force_download,
488	                proxies=proxies,
489	                resume_download=resume_download,
490	                token=token,
491	                local_files_only=local_files_only,
492	            )
493	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/utils/hub.py:494:12
493	        else:
494	            snapshot_download(
495	                path_or_repo_id,
496	                allow_patterns=full_filenames,
497	                repo_type=repo_type,
498	                revision=revision,
499	                cache_dir=cache_dir,
500	                user_agent=user_agent,
501	                force_download=force_download,
502	                proxies=proxies,
503	                resume_download=resume_download,
504	                token=token,
505	                local_files_only=local_files_only,
506	            )
507	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.11/site-packages/transformers/video_utils.py:688:27
687	    elif video.startswith("http://") or video.startswith("https://"):
688	        file_obj = BytesIO(requests.get(video).content)
689	    elif os.path.isfile(video):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/triton/language/__init__.py:312:21
311	            from triton.experimental.gluon.language.nvidia.hopper.tma import tensor_descriptor_type as gluon_tensor_descriptor_type
312	            layout = eval(layout, dict(NVMMASharedLayout=NVMMASharedLayout))
313	            assert isinstance(layout, NVMMASharedLayout)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/triton/profiler/proton.py:51:8
50	            code = compile(file.read(), script_path, 'exec')
51	        exec(code, clean_globals)
52	    except Exception as e:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/triton/runtime/interpreter.py:1372:8
1371	                fn_globals[key] = value
1372	        exec(compiled_code, fn_globals, local_namespace)
1373	        return local_namespace[self.fn.__name__]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/triton/runtime/jit.py:487:4
486	    # Execute the function string in func_namespace to create the function
487	    exec(func_body, func_namespace)
488	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/triton/tools/build_extern.py:315:24
314	        self._path = path
315	        self._ll_file = "/tmp/extern_lib.ll"
316	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/triton/tools/build_extern.py:362:88
361	    parser.add_argument("--lib-name", dest="lib_name", help="Name of the extern library")
362	    parser.add_argument("--output", dest="output_dir", help="Output file path", default="/tmp/")
363	    args = parser.parse_args()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:118:21
117	    script_content = get_completion_script(
118	        prog_name=prog_name, complete_var=complete_var, shell=shell
119	    )
120	    completion_path.write_text(script_content)
121	    return completion_path

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:146:21
145	    script_content = get_completion_script(
146	        prog_name=prog_name, complete_var=complete_var, shell=shell
147	    )
148	    path_obj.write_text(script_content)
149	    return path_obj

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:157:21
156	    script_content = get_completion_script(
157	        prog_name=prog_name, complete_var=complete_var, shell=shell
158	    )
159	    path_obj.write_text(f"{script_content}\n")
160	    return path_obj

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:199:21
198	    script_content = get_completion_script(
199	        prog_name=prog_name, complete_var=complete_var, shell=shell
200	    )
201	    with path_obj.open(mode="a") as f:
202	        f.write(f"{script_content}\n")

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:220:25
219	        installed_path = install_bash(
220	            prog_name=prog_name, complete_var=complete_var, shell=shell
221	        )
222	        return shell, installed_path
223	    elif shell == "zsh":

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:225:25
224	        installed_path = install_zsh(
225	            prog_name=prog_name, complete_var=complete_var, shell=shell
226	        )
227	        return shell, installed_path
228	    elif shell == "fish":

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:230:25
229	        installed_path = install_fish(
230	            prog_name=prog_name, complete_var=complete_var, shell=shell
231	        )
232	        return shell, installed_path
233	    elif shell in {"powershell", "pwsh"}:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/_completion_shared.py:235:25
234	        installed_path = install_powershell(
235	            prog_name=prog_name, complete_var=complete_var, shell=shell
236	        )
237	        return shell, installed_path
238	    else:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/completion.py:39:22
38	    if isinstance(value, str):
39	        shell, path = install(shell=value)
40	    else:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.11/site-packages/typer/completion.py:60:21
59	    script_content = get_completion_script(
60	        prog_name=prog_name, complete_var=complete_var, shell=shell
61	    )
62	    click.echo(script_content)
63	    sys.exit(0)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/typing_extensions.py:4034:53
4033	        return_value = {key:
4034	            value if not isinstance(value, str) else eval(value, globals, locals)
4035	            for key, value in ann.items() }

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.11/site-packages/typing_extensions.py:4116:20
4115	            code = forward_ref.__forward_code__
4116	            value = eval(code, globals, locals)
4117	        forward_ref.__forward_evaluated__ = True

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/typing_inspection/typing_objects.py:101:4
100	    globals_: dict[str, Any] = {'Any': Any, 'typing': typing, 'typing_extensions': typing_extensions}
101	    exec(func_code, globals_, locals_)
102	    return locals_[function_name]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.11/site-packages/typing_inspection/typing_objects.py:133:4
132	    globals_: dict[str, Any] = {'Any': Any, 'typing': typing, 'typing_extensions': typing_extensions}
133	    exec(func_code, globals_, locals_)
134	    return locals_[function_name]

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.11/site-packages/uvicorn/server.py:204:19
203	            addr_format = "%s://%s:%d"
204	            host = "0.0.0.0" if config.host is None else config.host
205	            if ":" in host:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/websocket/_handshake.py:200:26
199	    value = f"{key}258EAFA5-E914-47DA-95CA-C5AB0DC85B11".encode("utf-8")
200	    hashed = base64encode(hashlib.sha1(value).digest()).strip().lower()
201	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/websocket/tests/test_ssl_edge_cases.py:350:56
349	        # Test with SSLKEYLOGFILE environment variable
350	        with patch.dict("os.environ", {"SSLKEYLOGFILE": "/tmp/ssl_keys.log"}):
351	            with patch("ssl.SSLContext") as mock_ssl_context:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.11/site-packages/websocket/tests/test_ssl_edge_cases.py:360:63
359	                # Should set keylog_filename
360	                self.assertEqual(mock_context.keylog_filename, "/tmp/ssl_keys.log")
361	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.11/site-packages/websockets/utils.py:32:11
31	    """
32	    sha1 = hashlib.sha1((key + GUID).encode()).digest()
33	    return base64.b64encode(sha1).decode()

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module AES are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:60:4
59	try:
60	    from Crypto.Cipher import AES, ARC4  # type: ignore[import]
61	    from Crypto.Util.Padding import pad  # type: ignore[import]

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module pad are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:61:4
60	    from Crypto.Cipher import AES, ARC4  # type: ignore[import]
61	    from Crypto.Util.Padding import pad  # type: ignore[import]
62	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:293:17
292	        a = _padding(password)
293	        u_hash = hashlib.md5(a)
294	        u_hash.update(o_entry)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:303:32
302	            for _ in range(50):
303	                u_hash_digest = hashlib.md5(u_hash_digest[:length]).digest()
304	        return u_hash_digest[:length]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:340:24
339	        a = _padding(owner_password)
340	        o_hash_digest = hashlib.md5(a).digest()
341	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:344:32
343	            for _ in range(50):
344	                o_hash_digest = hashlib.md5(o_hash_digest).digest()
345	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:404:17
403	        """
404	        u_hash = hashlib.md5(_PADDING)
405	        u_hash.update(id1_entry)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_encryption.py:747:19
746	        key_data = key[:n] + pack1 + pack2
747	        key_hash = hashlib.md5(key_data)
748	        rc4_key = key_hash.digest()[: min(n + 5, 16)]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_security.py:76:8
75	    # input to this function.
76	    m = md5(password_bytes)
77	    # 3. Pass the value of the encryption dictionary's /O entry to the MD5 hash

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_security.py:100:23
99	        for _ in range(50):
100	            md5_hash = md5(md5_hash[:keylen]).digest()
101	    # 9. Set the encryption key to the first n bytes of the output from the

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_security.py:148:8
147	    # input to this function.
148	    m = md5(password_bytes)
149	    # 3. (Revision 3 or greater) Do the following 50 times: Take the output

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_security.py:154:23
153	        for _ in range(50):
154	            md5_hash = md5(md5_hash).digest()
155	    # 4. Create an RC4 encryption key using the first n bytes of the output

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_security.py:207:8
206	    # shown in step 1 of Algorithm 3.2 as input to this function.
207	    m = md5()
208	    m.update(_encryption_padding)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_writer.py:925:32
924	        O = ByteStringObject(_alg33(owner_password, user_password, rev, keylen))  # type: ignore[arg-type]
925	        ID_1 = ByteStringObject(md5((repr(time.time())).encode("utf8")).digest())
926	        ID_2 = ByteStringObject(md5((repr(random.random())).encode("utf8")).digest())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_writer.py:926:32
925	        ID_1 = ByteStringObject(md5((repr(time.time())).encode("utf8")).digest())
926	        ID_2 = ByteStringObject(md5((repr(random.random())).encode("utf8")).digest())
927	        self._ID = ArrayObject((ID_1, ID_2))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/_writer.py:1014:31
1013	                    assert len(key) == (len(self._encrypt_key) + 5)
1014	                    md5_hash = md5(key).digest()
1015	                    key = md5_hash[: min(16, len(self._encrypt_key) + 5)]

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: ./.venv/lib/python3.12/site-packages/PyPDF2/xmp.py:223:33
222	            data = self.stream.get_data()
223	            doc_root: Document = parseString(data)
224	        except ExpatError as e:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/anyio/_backends/_trio.py:1144:28
1143	                stderr=stderr,
1144	                shell=True,
1145	                **kwargs,
1146	            )
1147	        else:
1148	            process = await trio.lowlevel.open_process(
1149	                [convert_item(item) for item in command],
1150	                stdin=stdin,
1151	                stdout=stdout,
1152	                stderr=stderr,

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.12/site-packages/anyio/_core/_sockets.py:490:25
489	    else:
490	        local_address = ("0.0.0.0", 0)
491	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/anyio/streams/tls.py:247:22
246	    async def send_eof(self) -> None:
247	        tls_version = self.extra(TLSAttribute.tls_version)
248	        match = re.match(r"TLSv(\d+)(?:\.(\d+))?", tls_version)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/anyio/to_interpreter.py:123:22
122	            if fmt == FMT_PICKLED:
123	                res = pickle.loads(res)
124	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/anyio/to_process.py:86:17
85	
86	        retval = pickle.loads(pickled_response)
87	        if status == b"EXCEPTION":

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/anyio/to_process.py:210:29
209	        try:
210	            command, *args = pickle.load(stdin.buffer)
211	        except EOFError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/attr/_make.py:227:4
226	    bytecode = compile(script, filename, "exec")
227	    eval(bytecode, globs, locs)
228	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to httpx with timeout set to None
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/api/async_fastapi.py:134:39
133	            limits = httpx.Limits(keepalive_expiry=self.keepalive_secs)
134	            self._clients[loop_hash] = httpx.AsyncClient(
135	                timeout=None,
136	                headers=headers,
137	                verify=self._settings.chroma_server_ssl_verify or False,
138	                limits=limits,
139	            )
140	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to httpx with timeout set to None
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/api/fastapi.py:83:24
82	        limits = httpx.Limits(keepalive_expiry=self.keepalive_secs)
83	        self._session = httpx.Client(timeout=None, limits=limits)
84	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/cli/cli.py:25:19
24	        url = f"https://api.github.com/repos/chroma-core/chroma/releases"
25	        response = requests.get(url)
26	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/db/migrations.py:262:17
261	            if sys.version_info >= (3, 9)
262	            else hashlib.md5(sql.encode("utf-8")).hexdigest()
263	        )

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/chromadb/segment/impl/vector/local_persistent_hnsw.py:75:39
74	        with open(filename, "rb") as f:
75	            ret = cast(PersistentData, pickle.load(f))
76	            return ret

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/test/conftest.py:246:13
245	        server.app(),
246	        host="0.0.0.0",
247	        port=port,

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/chromadb/test/property/test_cross_version_persist.py:47:21
46	    url = "https://pypi.org/pypi/chromadb/json"
47	    data = json.load(request.urlopen(request.Request(url)))
48	    versions = list(data["releases"].keys())

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:322:20
321	                    # In versions prior to 3.12, this provides the same behavior as filter="data"
322	                    tar.extractall(path=self.DOWNLOAD_PATH)
323	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/click/_termui_impl.py:453:8
452	        [str(cmd_path)] + cmd_params,
453	        shell=True,
454	        stdin=subprocess.PIPE,
455	        env=env,
456	        errors="replace",
457	        text=True,
458	    )
459	    assert c.stdin is not None
460	    try:
461	        for text in generator:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/docx/image/image.py:151:15
150	        """SHA1 hash digest of the image blob."""
151	        return hashlib.sha1(self._blob).hexdigest()
152	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/docx/parts/image.py:80:15
79	        """SHA1 hash digest of the blob of this image part."""
80	        return hashlib.sha1(self.blob).hexdigest()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/fsspec/implementations/cache_metadata.py:64:25
63	            with open(fn, "rb") as f:
64	                loaded = pickle.load(f)
65	        for c in loaded.values():

--------------------------------------------------
>> Issue: [B402:blacklist] A FTP-related module is being imported.  FTP is considered insecure. Use SSH/SFTP/SCP or some other encrypted protocol.
   Severity: High   Confidence: High
   CWE: CWE-319 (https://cwe.mitre.org/data/definitions/319.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b402-import-ftplib
   Location: ./.venv/lib/python3.12/site-packages/fsspec/implementations/ftp.py:3:0
2	import uuid
3	from ftplib import FTP, FTP_TLS, Error, error_perm
4	from typing import Any

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/implementations/ftp.py:64:34
63	        self.port = port
64	        self.tempdir = tempdir or "/tmp"
65	        self.cred = username or "", password or "", acct or ""

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/implementations/sftp.py:45:51
44	        super().__init__(**ssh_kwargs)
45	        self.temppath = ssh_kwargs.pop("temppath", "/tmp")  # remote temp directory
46	        self.host = host

--------------------------------------------------
>> Issue: [B507:ssh_no_host_key_verification] Paramiko call with policy set to automatically trust the unknown host key.
   Severity: High   Confidence: Medium
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b507_ssh_no_host_key_verification.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/implementations/sftp.py:53:8
52	        self.client = paramiko.SSHClient()
53	        self.client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
54	        self.client.connect(self.host, **self.ssh_kwargs)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/__init__.py:228:23
227	        for i in range(10):
228	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
229	            path = some_join(source, f"{hashed_i}.txt")

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/copy.py:548:23
547	        for i in range(10):
548	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
549	            source_files.append(fs_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/get.py:576:23
575	        for i in range(10):
576	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
577	            source_files.append(fs_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/mv.py:36:8
35	    if os.name == "nt":
36	        os.system(f'icacls "{protected_path}" /deny Everyone:(W)')
37	    else:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o555 on file (protected_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/mv.py:38:8
37	    else:
38	        os.chmod(protected_path, 0o555)  # Sets the directory to read-only
39	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/mv.py:55:8
54	    if os.name == "nt":
55	        os.system(f'icacls "{protected_path}" /remove:d Everyone')
56	    else:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (protected_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/mv.py:57:8
56	    else:
57	        os.chmod(protected_path, 0o755)  # Restore write permission for cleanup

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/tests/abstract/put.py:582:23
581	        for i in range(10):
582	            hashed_i = md5(str(i).encode("utf-8")).hexdigest()
583	            source_files.append(local_join(source, f"{hashed_i}.txt"))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/fsspec/utils.py:320:12
319	    try:
320	        h = md5(str(args).encode())
321	    except ValueError:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/functorch/dim/magic_trace.py:13:54
12	@contextmanager
13	def magic_trace(output="trace.fxt", magic_trace_cache="/tmp/magic-trace"):
14	    pid = os.getpid()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/functorch/einops/rearrange.py:149:4
148	
149	    exec(custom_rearrange_callable_code)
150	    return locals()[custom_rearrange_callable_name]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/google/protobuf/proto_builder.py:68:16
67	  # proto files.
68	  fields_hash = hashlib.sha1()
69	  for f_name, f_type in field_items:

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/httpcore/_backends/anyio.py:84:19
83	        if info == "ssl_object":
84	            return self._stream.extra(anyio.streams.tls.TLSAttribute.ssl_object, None)
85	        if info == "client_addr":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/httpcore/_backends/anyio.py:86:19
85	        if info == "client_addr":
86	            return self._stream.extra(anyio.abc.SocketAttribute.local_address, None)
87	        if info == "server_addr":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/httpcore/_backends/anyio.py:88:19
87	        if info == "server_addr":
88	            return self._stream.extra(anyio.abc.SocketAttribute.remote_address, None)
89	        if info == "socket":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/httpcore/_backends/anyio.py:90:19
89	        if info == "socket":
90	            return self._stream.extra(anyio.abc.SocketAttribute.raw_socket, None)
91	        if info == "is_readable":

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b610_django_extra_used.html
   Location: ./.venv/lib/python3.12/site-packages/httpcore/_backends/anyio.py:92:19
91	        if info == "is_readable":
92	            sock = self._stream.extra(anyio.abc.SocketAttribute.raw_socket, None)
93	            return is_socket_readable(sock)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/httpx/_auth.py:309:15
308	
309	        return hashlib.sha1(s).hexdigest()[:16].encode()
310	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/_local_folder.py:447:36
446	def _short_hash(filename: str) -> str:
447	    return base64.urlsafe_b64encode(hashlib.sha1(filename.encode()).digest()).decode()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/cli/download.py:149:19
148	        if len(self.filenames) == 1:
149	            return hf_hub_download(
150	                repo_id=self.repo_id,
151	                repo_type=self.repo_type,
152	                revision=self.revision,
153	                filename=self.filenames[0],
154	                cache_dir=self.cache_dir,
155	                force_download=self.force_download,
156	                token=self.token,
157	                local_dir=self.local_dir,
158	                library_name="huggingface-cli",
159	            )
160	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/cli/download.py:169:15
168	
169	        return snapshot_download(
170	            repo_id=self.repo_id,
171	            repo_type=self.repo_type,
172	            revision=self.revision,
173	            allow_patterns=allow_patterns,
174	            ignore_patterns=ignore_patterns,
175	            force_download=self.force_download,
176	            cache_dir=self.cache_dir,
177	            token=self.token,
178	            local_dir=self.local_dir,
179	            library_name="huggingface-cli",
180	            max_workers=self.max_workers,
181	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/commands/download.py:170:19
169	        if len(self.filenames) == 1:
170	            return hf_hub_download(
171	                repo_id=self.repo_id,
172	                repo_type=self.repo_type,
173	                revision=self.revision,
174	                filename=self.filenames[0],
175	                cache_dir=self.cache_dir,
176	                resume_download=self.resume_download,
177	                force_download=self.force_download,
178	                token=self.token,
179	                local_dir=self.local_dir,
180	                library_name="huggingface-cli",
181	            )
182	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/commands/download.py:191:15
190	
191	        return snapshot_download(
192	            repo_id=self.repo_id,
193	            repo_type=self.repo_type,
194	            revision=self.revision,
195	            allow_patterns=allow_patterns,
196	            ignore_patterns=ignore_patterns,
197	            resume_download=self.resume_download,
198	            force_download=self.force_download,
199	            cache_dir=self.cache_dir,
200	            token=self.token,
201	            local_dir=self.local_dir,
202	            library_name="huggingface-cli",
203	            max_workers=self.max_workers,
204	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/fastai_utils.py:319:25
318	    if not os.path.isdir(repo_id):
319	        storage_folder = snapshot_download(
320	            repo_id=repo_id,
321	            revision=revision,
322	            library_name="fastai",
323	            library_version=get_fastai_version(),
324	        )
325	    else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/hf_api.py:6504:15
6503	        headers = self._build_hf_headers(token=token)
6504	        resp = requests.post(path, headers=headers, json=body)
6505	        hf_raise_for_status(resp)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/hf_api.py:10861:49
10860	            pre_command = ["python", "-c", '"' + "; ".join(pre_command) + '"']
10861	            command = ["uv", "run"] + uv_args + ["/tmp/script.py"] + script_args
10862	            command = ["bash", "-c", " ".join(pre_command) + " && " + " ".join(command)]

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/inference/_mcp/utils.py:118:12
117	        repo_dir = Path(
118	            snapshot_download(
119	                repo_id=DEFAULT_REPO_ID,
120	                allow_patterns=f"{agent_path}/*",
121	                repo_type="dataset",
122	            )
123	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/keras_mixin.py:481:29
480	        if not os.path.isdir(model_id):
481	            storage_folder = snapshot_download(
482	                repo_id=model_id,
483	                revision=revision,
484	                cache_dir=cache_dir,
485	                library_name="keras",
486	                library_version=get_tf_version(),
487	            )
488	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/repocard.py:176:16
175	            card_path = Path(
176	                hf_hub_download(
177	                    repo_id_or_path,
178	                    constants.REPOCARD_NAME,
179	                    repo_type=repo_type or cls.repo_type,
180	                    token=token,
181	                )
182	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/huggingface_hub/serialization/_torch.py:645:11
644	
645	    return load(
646	        checkpoint_file,
647	        map_location=map_location,
648	        **additional_kwargs,
649	    )
650	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (pathname).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/humanfriendly/testing.py:528:8
527	            handle.write('exit %i\n' % self.program_returncode)
528	        os.chmod(pathname, 0o755)
529	        return directory

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/jinja2/bccache.py:73:19
72	        # the source code of the file changed, we need to reload
73	        checksum = pickle.load(f)
74	        if self.checksum != checksum:

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b302-marshal
   Location: ./.venv/lib/python3.12/site-packages/jinja2/bccache.py:79:24
78	        try:
79	            self.code = marshal.load(f)
80	        except (EOFError, ValueError, TypeError):

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/bccache.py:156:15
155	        """Returns the unique hash key for this template name."""
156	        hash = sha1(name.encode("utf-8"))
157	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/bccache.py:165:15
164	        """Returns a checksum for the source."""
165	        return sha1(source.encode("utf-8")).hexdigest()
166	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/debug.py:145:8
144	    try:
145	        exec(code, globals, locals)
146	    except BaseException:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/environment.py:1228:8
1227	        namespace = {"environment": environment, "__file__": code.co_filename}
1228	        exec(code, namespace)
1229	        rv = cls._from_namespace(environment, namespace, globals)

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/environment.py:1544:15
1543	    def __html__(self) -> Markup:
1544	        return Markup(concat(self._body_stream))
1545	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/ext.py:176:17
175	        if __context.eval_ctx.autoescape:
176	            rv = Markup(rv)
177	        # Always treat as a format string, even if there are no

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/ext.py:197:17
196	        if __context.eval_ctx.autoescape:
197	            rv = Markup(rv)
198	        # Always treat as a format string, see gettext comment above.

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/ext.py:213:17
212	        if __context.eval_ctx.autoescape:
213	            rv = Markup(rv)
214	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/ext.py:238:17
237	        if __context.eval_ctx.autoescape:
238	            rv = Markup(rv)
239	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:316:13
315	    if eval_ctx.autoescape:
316	        rv = Markup(rv)
317	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:820:13
819	    if eval_ctx.autoescape:
820	        rv = Markup(rv)
821	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:851:20
850	    if isinstance(s, Markup):
851	        indention = Markup(indention)
852	        newline = Markup(newline)

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:852:18
851	        indention = Markup(indention)
852	        newline = Markup(newline)
853	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:1056:11
1055	
1056	    return Markup(str(value)).striptags()
1057	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/filters.py:1377:11
1376	    """
1377	    return Markup(value)
1378	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/loaders.py:661:25
660	    def get_template_key(name: str) -> str:
661	        return "tmpl_" + sha1(name.encode("utf-8")).hexdigest()
662	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/nodes.py:619:19
618	        if eval_ctx.autoescape:
619	            return Markup(self.data)
620	        return self.data

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/nodes.py:1091:15
1090	        eval_ctx = get_eval_context(self, eval_ctx)
1091	        return Markup(self.expr.as_const(eval_ctx))
1092	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/nodes.py:1112:19
1111	        if eval_ctx.autoescape:
1112	            return Markup(expr)
1113	        return expr

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/runtime.py:375:19
374	        if self._context.eval_ctx.autoescape:
375	            return Markup(rv)
376	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/runtime.py:389:19
388	        if self._context.eval_ctx.autoescape:
389	            return Markup(rv)
390	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/runtime.py:776:19
775	        if autoescape:
776	            return Markup(rv)
777	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/runtime.py:787:17
786	        if autoescape:
787	            rv = Markup(rv)
788	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/utils.py:403:11
402	        return "\n\n".join(result)
403	    return markupsafe.Markup(
404	        "\n".join(f"<p>{markupsafe.escape(x)}</p>" for x in result)
405	    )
406	

--------------------------------------------------
>> Issue: [B704:markupsafe_markup_xss] Potential XSS with ``markupsafe.Markup`` detected. Do not use ``Markup`` on untrusted data.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b704_markupsafe_markup_xss.html
   Location: ./.venv/lib/python3.12/site-packages/jinja2/utils.py:668:11
667	
668	    return markupsafe.Markup(
669	        dumps(obj, **kwargs)
670	        .replace("<", "\\u003c")
671	        .replace(">", "\\u003e")
672	        .replace("&", "\\u0026")
673	        .replace("'", "\\u0027")
674	    )
675	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/_memmapping_reducer.py:40:23
39	# as the default folder to dump big arrays to share with subprocesses.
40	SYSTEM_SHARED_MEM_FS = "/dev/shm"
41	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/externals/loky/backend/popen_loky_posix.py:174:28
173	            try:
174	                prep_data = pickle.load(from_parent)
175	                spawn.prepare(prep_data)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/externals/loky/backend/popen_loky_posix.py:176:30
175	                spawn.prepare(prep_data)
176	                process_obj = pickle.load(from_parent)
177	            finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/externals/loky/backend/popen_loky_win32.py:166:31
165	        try:
166	            preparation_data = load(from_parent)
167	            spawn.prepare(preparation_data, parent_sentinel)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/externals/loky/backend/popen_loky_win32.py:168:19
167	            spawn.prepare(preparation_data, parent_sentinel)
168	            self = load(from_parent)
169	        finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/numpy_pickle.py:175:20
174	            # The array contained Python objects. We need to unpickle the data.
175	            array = pickle.load(unpickler.file_handle)
176	        else:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/common.py:78:23
77	with_dev_shm = skipif(
78	    not os.path.exists("/dev/shm"),
79	    reason="This test requires a large /dev/shm shared memory fs.",

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_hashing.py:228:15
227	    def md5_hash(x):
228	        return hashlib.md5(memoryview(x)).hexdigest()
229	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_hashing.py:350:8
349	    b = {string: "bar"}
350	    c = pickle.loads(pickle.dumps(b))
351	    assert hash([a, b]) == hash([a, c])

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_hashing.py:370:23
369	
370	    dt1_roundtripped = pickle.loads(pickle.dumps(dt1))
371	    assert dt1 is not dt1_roundtripped

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_hashing.py:383:31
382	
383	    complex_dt1_roundtripped = pickle.loads(pickle.dumps(complex_dt1))
384	    assert complex_dt1_roundtripped is not complex_dt1

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memmapping.py:937:28
936	            pool_temp_folder = p._temp_folder
937	            folder_prefix = "/dev/shm/joblib_memmapping_folder_"
938	            assert pool_temp_folder.startswith(folder_prefix)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memmapping.py:993:51
992	            pool_temp_folder = p._temp_folder
993	            assert not pool_temp_folder.startswith("/dev/shm")
994	        finally:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:164:8
163	        my_locals = {}
164	        exec(
165	            compile(
166	                textwrap.dedent(ipython_cell_source),
167	                filename=ipython_cell_id,
168	                mode="exec",
169	            ),
170	            # TODO when Python 3.11 is the minimum supported version, use
171	            # locals=my_locals instead of passing globals and locals in the
172	            # next two lines as positional arguments
173	            None,
174	            my_locals,
175	        )
176	        f = my_locals["f"]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:334:9
333	    memory = Memory(location=tmpdir.strpath, verbose=0)
334	    a1 = eval("lambda x: x")
335	    a1 = memory.cache(a1)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:336:9
335	    a1 = memory.cache(a1)
336	    b1 = eval("lambda x: x+1")
337	    b1 = memory.cache(b1)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:368:8
367	
368	    m = eval("lambda x: x")
369	    mm = memory.cache(m)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:598:8
597	
598	    h = pickle.loads(pickle.dumps(g))
599	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:604:14
603	    assert output == h.store_backend.load_item([h.func_id, args_id])
604	    memory2 = pickle.loads(pickle.dumps(memory))
605	    assert memory.store_backend.location == memory2.store_backend.location

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:609:4
608	    memory = Memory(location=None, verbose=0)
609	    pickle.loads(pickle.dumps(memory))
610	    g = memory.cache(f)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:611:9
610	    g = memory.cache(f)
611	    gp = pickle.loads(pickle.dumps(g))
612	    gp(1)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:704:22
703	        with open(filename, "rb") as fp:
704	            result2 = pickle.load(fp)
705	        assert result2.get() == result.get()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:1219:24
1218	    with raises(TypeError) as excinfo:
1219	        Memory(location="/tmp/joblib", backend="unknown")
1220	    excinfo.match(r"Unknown location*")

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:1340:29
1339	    memorized_result_pickle = pickle.dumps(memorized_result)
1340	    memorized_result_loads = pickle.loads(memorized_result_pickle)
1341	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:1374:22
1373	
1374	    memory_reloaded = pickle.loads(pickle.dumps(memory))
1375	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:1387:27
1386	
1387	    func_cached_reloaded = pickle.loads(pickle.dumps(func_cached))
1388	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_memory.py:1400:32
1399	    memorized_result = func_cached.call_and_shelve(1)
1400	    memorized_result_reloaded = pickle.loads(pickle.dumps(memorized_result))
1401	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/joblib/test/test_store_backends.py:33:27
32	            with open(filename, "rb") as f:
33	                reloaded = cpickle.load(f)
34	            break

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/jsonschema/validators.py:113:9
112	    request = Request(uri, headers=headers)  # noqa: S310
113	    with urlopen(request) as response:  # noqa: S310
114	        warnings.warn(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/jsonschema/validators.py:1225:21
1224	            # json over http
1225	            result = requests.get(uri).json()
1226	        else:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/jsonschema/validators.py:1228:17
1227	            # Otherwise, pass off to urllib and assume utf-8
1228	            with urlopen(uri) as url:  # noqa: S310
1229	                result = json.loads(url.read().decode("utf-8"))

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/kubernetes/config/exec_provider.py:99:18
98	            universal_newlines=True,
99	            shell=self.shell)
100	        (stdout, stderr) = process.communicate()
101	        exit_code = process.wait()
102	        if exit_code != 0:
103	            msg = 'exec: process returned %d' % exit_code
104	            stderr = stderr.strip()
105	            if stderr:
106	                msg += '. %s' % stderr
107	            raise ConfigException(msg)
108	        try:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/kubernetes/dynamic/discovery.py:53:61
52	            # usedforsecurity is only supported in 3.9+
53	            default_cachefile_name = 'osrcp-{0}.json'.format(hashlib.md5(default_cache_id).hexdigest())
54	        self.__cache_file = cache_file or os.path.join(tempfile.gettempdir(), default_cachefile_name)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/lxml/ElementInclude.py:118:16
117	        if "://" in href:
118	            f = urlopen(href)
119	        else:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/lxml/html/__init__.py:1120:11
1119	            data = data.encode('ASCII')
1120	    return urlopen(url, data)
1121	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/lxml/html/html5parser.py:230:13
229	    elif _looks_like_url(filename_url_or_file):
230	        fp = urlopen(filename_url_or_file)
231	        if guess_charset is None:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/identification.py:777:26
776	            namespace = dict((name, getattr(ctx,name)) for name in dir(ctx))
777	            constants = [(eval(p, namespace), p) for p in constants]
778	    else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/mpmath/libmp/backend.py:47:8
46	            _locs_ = _globs_
47	        exec("""exec _code_ in _globs_, _locs_""")
48	else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/extratest_gamma.py:56:8
55	    mp.dps = 1010
56	    z = eval(z)
57	    mp.dps = maxdps + 50

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/extratest_gamma.py:64:23
63	    else:
64	        loggamma_val = eval(result)
65	        gamma_val = exp(loggamma_val)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/runtests.py:159:66
158	        r = tracer.results()
159	        r.write_results(show_missing=True, summary=True, coverdir="/tmp")
160	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_convert.py:88:19
87	            a = mpf(random.random())**0.5 * 10**random.randint(-100, 100)
88	            assert eval(repr(a)) == a
89	    mp.dps = 15

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_linalg.py:181:63
180	              'qr_solve(%s, %s)' % (A, b), 'qr_solve(%s, %s)' % (B, b)]:
181	        pytest.raises((ZeroDivisionError, ValueError), lambda: eval(i))
182	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_matrices.py:25:17
24	    assert A6.tolist() == l
25	    assert A6 == eval(repr(A6))
26	    A6 = fp.matrix(A6)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_matrices.py:27:17
26	    A6 = fp.matrix(A6)
27	    assert A6 == eval(repr(A6))
28	    assert A6*1j == eval(repr(A6*1j))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_matrices.py:28:20
27	    assert A6 == eval(repr(A6))
28	    assert A6*1j == eval(repr(A6*1j))
29	    assert A3 * 10 == 10 * A3 == A6

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_matrices.py:63:4
62	    A5 = matrix([[6, -1], [3, 2], [0, -3]])
63	    exec("assert A4 @ A5 == A4 * A5")
64	

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_pickle.py:8:9
7	def pickler(obj):
8	    fn = tempfile.mktemp()
9	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/mpmath/tests/test_pickle.py:15:11
14	    f = open(fn, 'rb')
15	    obj2 = pickle.load(f)
16	    f.close()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/algorithms/flow/tests/test_maxflow_large_graph.py:56:12
55	    with bz2.BZ2File(fname, "rb") as f:
56	        G = pickle.load(f)
57	    return G

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/algorithms/flow/tests/test_mincost.py:469:16
468	        with bz2.BZ2File(fname, "rb") as f:
469	            G = pickle.load(f)
470	        flowCost, flowDict = nx.network_simplex(G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/algorithms/flow/tests/test_networksimplex.py:180:12
179	    with bz2.BZ2File(fname, "rb") as f:
180	        G = pickle.load(f)
181	    flowCost, flowDict = nx.network_simplex(G)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/networkx/algorithms/operators/tests/test_all.py:28:31
27	        graph, node = n
28	        assert ghj.nodes[n] == eval(graph).nodes[int(node)]
29	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/networkx/algorithms/operators/tests/test_binary.py:23:30
22	        graph, node = n
23	        assert gh.nodes[n] == eval(graph).nodes[int(node)]
24	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_coreviews.py:16:16
15	        view = self.av
16	        pview = pickle.loads(pickle.dumps(view, -1))
17	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_coreviews.py:19:16
18	        assert view.__slots__ == pview.__slots__
19	        pview = pickle.loads(pickle.dumps(view))
20	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_coreviews.py:73:16
72	        view = self.adjview
73	        pview = pickle.loads(pickle.dumps(view, -1))
74	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_coreviews.py:153:16
152	        view = self.av
153	        pview = pickle.loads(pickle.dumps(view, -1))
154	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_coreviews.py:211:16
210	        view = self.adjview
211	        pview = pickle.loads(pickle.dumps(view, -1))
212	        assert view == pview

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graph.py:610:13
609	        G = self.K3
610	        pg = pickle.loads(pickle.dumps(G, -1))
611	        self.graphs_equal(pg, G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graph.py:612:13
611	        self.graphs_equal(pg, G)
612	        pg = pickle.loads(pickle.dumps(G))
613	        self.graphs_equal(pg, G)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graphviews.py:18:14
17	        rv = self.rv
18	        prv = pickle.loads(pickle.dumps(rv, -1))
19	        assert rv._node == prv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graphviews.py:65:14
64	        rv = self.rv
65	        prv = pickle.loads(pickle.dumps(rv, -1))
66	        assert rv._node == prv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graphviews.py:118:14
117	        dv = self.dv
118	        pdv = pickle.loads(pickle.dumps(dv, -1))
119	        assert dv._node == pdv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graphviews.py:157:14
156	        uv = self.uv
157	        puv = pickle.loads(pickle.dumps(uv, -1))
158	        assert uv._node == puv._node

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_graphviews.py:206:16
205	        for G in self.graphs:
206	            H = pickle.loads(pickle.dumps(G, -1))
207	            assert edges_equal(H.edges, G.edges)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:22:14
21	        nv = self.nv
22	        pnv = pickle.loads(pickle.dumps(nv, -1))
23	        assert nv == pnv

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:93:14
92	        nv = self.nv
93	        pnv = pickle.loads(pickle.dumps(nv, -1))
94	        assert nv == pnv

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:278:14
277	        ev = self.eview(self.G)(data=True)
278	        pev = pickle.loads(pickle.dumps(ev, -1))
279	        assert list(ev) == list(pev)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:568:14
567	        ev = self.eview(self.G)
568	        pev = pickle.loads(pickle.dumps(ev, -1))
569	        assert ev == pev

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:1023:15
1022	        deg = self.G.degree
1023	        pdeg = pickle.loads(pickle.dumps(deg, -1))
1024	        assert dict(deg) == dict(pdeg)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/classes/tests/test_reportviews.py:1412:4
1411	    # Raises error if the cached properties and views do not work
1412	    pickle.loads(pickle.dumps(G, -1))
1413	    deepcopy(G)

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/networkx/readwrite/graphml.py:855:23
854	        elif string is not None:
855	            self.xml = fromstring(string)
856	        else:

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/networkx/readwrite/tests/test_graphml.py:1155:14
1154	
1155	        xml = parse(fh)
1156	        # Children are the key elements, and the graph element

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/networkx/readwrite/tests/test_graphml.py:1200:14
1199	
1200	        xml = parse(fh)
1201	        # Children are the key elements, and the graph element

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/networkx/readwrite/tests/test_graphml.py:1327:15
1326	
1327	        tree = parse(fname)
1328	        children = list(tree.getroot())

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/networkx/readwrite/tests/test_graphml.py:1376:15
1375	
1376	        tree = parse(fname)
1377	        children = list(tree.getroot())

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/networkx/tests/test_lazy_imports.py:83:4
82	
83	    exec(s, {}, locls)
84	    expected = {

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/decorators.py:912:8
911	        compiled = compile(code, filename, "exec")
912	        exec(compiled, globl, locl)
913	        func = locl[sig.name]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/tests/test_backends.py:28:15
27	        pickled = pickle.dumps(func.__wrapped__)
28	        assert pickle.loads(pickled) is func.__wrapped__
29	        try:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/tests/test_backends.py:34:15
33	            continue
34	        assert pickle.loads(pickled) is func
35	        count += 1

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/tests/test_backends.py:37:11
36	    assert count > 0
37	    assert pickle.loads(pickle.dumps(nx.inverse_line_graph)) is nx.inverse_line_graph
38	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/tests/test_config.py:47:11
46	    assert set(cfg.items()) == set()
47	    cfg2 = pickle.loads(pickle.dumps(cfg))
48	    assert cfg == cfg2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/networkx/utils/tests/test_config.py:102:11
101	        cfg["z"]
102	    cfg2 = pickle.loads(pickle.dumps(cfg))
103	    assert cfg == cfg2

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/numpy/__config__.py:96:20
95	        "Python Information": {
96	            "path": r"/tmp/build-env-ly1klzhw/bin/python",
97	            "version": "3.12",
98	        },
99	        "SIMD Extensions": {
100	            "baseline": __cpu_baseline__,

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test__exceptions.py:19:14
18	        error = _ArrayMemoryError((1023,), np.dtype(np.uint8))
19	        res = pickle.loads(pickle.dumps(error))
20	        assert res._total_size == error._total_size

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test__exceptions.py:84:15
83	        exc = AxisError(*args)
84	        exc2 = pickle.loads(pickle.dumps(exc))
85	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_arrayprint.py:340:21
339	
340	        assert_equal(eval(repr(a), vars(np)), a)
341	        assert_equal(eval(repr(a[0]), {'np': np}), a[0])

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_arrayprint.py:341:21
340	        assert_equal(eval(repr(a), vars(np)), a)
341	        assert_equal(eval(repr(a[0]), {'np': np}), a[0])
342	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_custom_dtypes.py:308:10
307	    s = pickle.dumps(SF)
308	    res = pickle.loads(s)
309	    assert res is SF

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:866:25
865	            dt = np.dtype('M8[7D]')
866	            assert_equal(pickle.loads(pickle.dumps(dt, protocol=proto)), dt)
867	            dt = np.dtype('M8[W]')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:868:25
867	            dt = np.dtype('M8[W]')
868	            assert_equal(pickle.loads(pickle.dumps(dt, protocol=proto)), dt)
869	            scalar = np.datetime64('2016-01-01T00:00:00.000000000')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:870:25
869	            scalar = np.datetime64('2016-01-01T00:00:00.000000000')
870	            assert_equal(pickle.loads(pickle.dumps(scalar, protocol=proto)),
871	                         scalar)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:873:25
872	            delta = scalar - np.datetime64('2015-01-01T00:00:00.000000000')
873	            assert_equal(pickle.loads(pickle.dumps(delta, protocol=proto)),
874	                         delta)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:880:21
879	              b"I7\nI1\nI1\ntp7\ntp8\ntp9\nb."
880	        assert_equal(pickle.loads(pkl), np.dtype('<M8[7D]'))
881	        pkl = b"cnumpy\ndtype\np0\n(S'M8'\np1\nI0\nI1\ntp2\nRp3\n"\

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:884:21
883	              b"I1\nI1\nI1\ntp7\ntp8\ntp9\nb."
884	        assert_equal(pickle.loads(pkl), np.dtype('<M8[W]'))
885	        pkl = b"cnumpy\ndtype\np0\n(S'M8'\np1\nI0\nI1\ntp2\nRp3\n"\

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:888:21
887	              b"I1\nI1\nI1\ntp7\ntp8\ntp9\nb."
888	        assert_equal(pickle.loads(pkl), np.dtype('>M8[us]'))
889	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_datetime.py:895:18
894	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
895	            res = pickle.loads(pickle.dumps(dt, protocol=proto))
896	            assert_equal(res, dt)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_dtype.py:1065:30
1064	                         "'aligned':True}")
1065	        assert_equal(np.dtype(eval(str(dt))), dt)
1066	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_dtype.py:1366:22
1365	            assert b"dtype" in buf
1366	            pickled = pickle.loads(buf)
1367	            assert_equal(pickled, dtype)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_dtype.py:1428:30
1427	        for proto in range(pickle.HIGHEST_PROTOCOL + 1):
1428	            roundtrip_DType = pickle.loads(pickle.dumps(DType, proto))
1429	            assert roundtrip_DType is DType

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_dtype.py:1439:27
1438	        for proto in range(pickle.HIGHEST_PROTOCOL + 1):
1439	            roundtrip_dt = pickle.loads(pickle.dumps(dt, proto))
1440	            assert roundtrip_dt == dt

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:189:19
188	        for v in range(pickle.HIGHEST_PROTOCOL):
189	            vals = pickle.loads(pickle.dumps(a, v))
190	            assert_(vals.flags.writeable)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1549:27
1548	        assert_equal(xx[:].dtype, xx.dtype)
1549	        assert_array_equal(eval(repr(xx), {"np": np, "array": np.array}), xx)
1550	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1701:17
1700	        # It is not easy to create one, one method is to use pickle:
1701	        scalar = pickle.loads(pickle.dumps(scalar))
1702	        assert scalar.flags.owndata

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1855:25
1854	        zs = self._zeros(10, int)
1855	        assert_equal(zs, pickle.loads(zs.dumps()))
1856	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1862:22
1861	                p = pickle.dumps(zs, protocol=proto)
1862	                zs2 = pickle.loads(p)
1863	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1871:18
1870	        pk_dmp = pickle.dumps(arr)
1871	        pk_load = pickle.loads(pk_dmp)
1872	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:1882:28
1881	                                    protocol=5)
1882	        array_from_buffer = pickle.loads(bytes_string, buffers=buffers)
1883	        # when using pickle protocol 5 with buffer callbacks,

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:3939:21
3938	                              }
3939	            MyType = eval("type('MyType', (base,), class_namespace)",
3940	                          eval_namespace)
3941	            if issubclass(MyType, np.ndarray):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4404:40
4403	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
4404	            depickled_arr_with_object = pickle.loads(
4405	                    pickle.dumps(arr_with_object, protocol=proto))
4406	            depickled_arr_without_object = pickle.loads(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4406:43
4405	                    pickle.dumps(arr_with_object, protocol=proto))
4406	            depickled_arr_without_object = pickle.loads(
4407	                    pickle.dumps(arr_without_object, protocol=proto))
4408	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4427:39
4426	
4427	        depickled_f_contiguous_array = pickle.loads(bytes_string,
4428	                                                    buffers=buffers)
4429	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4446:48
4445	
4446	        depickled_transposed_contiguous_array = pickle.loads(bytes_string,
4447	                                                    buffers=buffers)
4448	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4459:24
4458	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2)
4459	        assert_equal(x, pickle.loads(c_contiguous_dumped))
4460	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2, order='F')

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4461:24
4460	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2, order='F')
4461	        assert_equal(x, pickle.loads(f_contiguous_dumped))
4462	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2).transpose((1, 0, 2))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4463:24
4462	        x = np.arange(24, dtype='uint8').reshape(3, 4, 2).transpose((1, 0, 2))
4463	        assert_equal(x, pickle.loads(transposed_contiguous_dumped))
4464	        x = np.arange(12, dtype='uint8').reshape(3, 4)[:, :2]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4465:24
4464	        x = np.arange(12, dtype='uint8').reshape(3, 4)[:, :2]
4465	        assert_equal(x, pickle.loads(no_contiguous_dumped))
4466	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4476:45
4475	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
4476	            depickled_non_contiguous_array = pickle.loads(
4477	                    pickle.dumps(non_contiguous_array, protocol=proto,
4478	                                 buffer_callback=buffers.append if proto >= 5 else None))
4479	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4496:27
4495	                assert_equal(
4496	                        a, pickle.loads(pickle.dumps(a, protocol=proto)),
4497	                        err_msg=f"{a!r}")

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4505:15
4504	    def _loads(self, obj):
4505	        return pickle.loads(obj, encoding='latin1')
4506	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:4559:14
4558	
4559	        new = pickle.loads(pickle.dumps(original_byte_reversed))
4560	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_multiarray.py:8312:14
8311	        pickle_obj = pickle.dumps(obj)
8312	        res = pickle.loads(pickle_obj)
8313	        assert_array_equal(res, obj)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_overrides.py:221:27
220	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
221	            roundtripped = pickle.loads(
222	                    pickle.dumps(dispatched_one_arg, protocol=proto))
223	            assert_(roundtripped is dispatched_one_arg)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:170:22
169	
170	        recordarr_r = eval("np." + repr(recordarr), {'np': np})
171	        recarr_r = eval("np." + repr(recarr), {'np': np})

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:171:19
170	        recordarr_r = eval("np." + repr(recordarr), {'np': np})
171	        recarr_r = eval("np." + repr(recarr), {'np': np})
172	        # Prints the type `numpy.record` as part of the dtype:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:173:23
172	        # Prints the type `numpy.record` as part of the dtype:
173	        recordview_r = eval("np." + repr(recordview), {'np': np, 'numpy': np})
174	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:414:28
413	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
414	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
415	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:415:31
414	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
415	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],
416	                                                         protocol=proto)))
417	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:421:28
420	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
421	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
422	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:422:31
421	            assert_equal(a, pickle.loads(pickle.dumps(a, protocol=proto)))
422	            assert_equal(a[0], pickle.loads(pickle.dumps(a[0],
423	                                                         protocol=proto)))
424	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:429:17
428	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
429	            pa = pickle.loads(pickle.dumps(a[0], protocol=proto))
430	            assert_(pa.flags.c_contiguous)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_records.py:453:20
452	        dump = pickle.dumps(a[0])
453	        unpickled = pickle.loads(dump)
454	        assert a[0] == unpickled

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:52:20
51	                f.seek(0)
52	                b = pickle.load(f)
53	            assert_array_equal(a, b)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:363:22
362	                f.seek(0)
363	                dt_ = pickle.load(f)
364	            assert_equal(dt, dt_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:489:21
488	        for original, data in test_data:
489	            result = pickle.loads(data, encoding='bytes')
490	            assert_equal(result, original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:833:18
832	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
833	            new = pickle.loads(pickle.dumps(el, protocol=proto))
834	            assert_equal(new, el)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1069:16
1068	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
1069	            y = pickle.loads(pickle.dumps(x, protocol=proto))
1070	            # y is now typically not aligned on a 8-byte boundary

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1082:17
1081	        with open(filename, 'rb') as f:
1082	            xp = pickle.load(f, encoding='latin1')
1083	        xpd = xp.astype(np.float64)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1275:20
1274	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
1275	            assert_(pickle.loads(
1276	                pickle.dumps(test_string, protocol=proto)) == test_string)
1277	            assert_(pickle.loads(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1277:20
1276	                pickle.dumps(test_string, protocol=proto)) == test_string)
1277	            assert_(pickle.loads(
1278	                pickle.dumps(test_record, protocol=proto)) == test_record)
1279	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1907:15
1906	        blob = pickle.dumps(data, protocol=1)
1907	        data = pickle.loads(blob)
1908	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1919:19
1918	            data = np.array([1], dtype='b')
1919	            data = pickle.loads(pickle.dumps(data, protocol=proto))
1920	            data[0] = 0x7d

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1931:17
1930	        # This should work:
1931	        result = pickle.loads(data, encoding='latin1')
1932	        assert_array_equal(result, np.array([129]).astype('b'))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1957:21
1956	        for original, data, koi8r_validity in datas:
1957	            result = pickle.loads(data, encoding='latin1')
1958	            assert_equal(result, original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:1966:25
1965	                # bogus results
1966	                result = pickle.loads(data, encoding='koi8-r')
1967	                assert_(result != original)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:2212:25
2211	            test_string = np.bytes_('')
2212	            assert_equal(pickle.loads(
2213	                pickle.dumps(test_string, protocol=proto)), test_string)
2214	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:2436:25
2435	            dumped = pickle.dumps(arr, protocol=proto)
2436	            assert_equal(pickle.loads(dumped), arr)
2437	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_regression.py:2567:17
2566	        test_data = b'\x80\x04\x95(\x00\x00\x00\x00\x00\x00\x00\x8c\x1cnumpy.core._multiarray_umath\x94\x8c\x03add\x94\x93\x94.'
2567	        result = pickle.loads(test_data, encoding='bytes')
2568	        assert result is np.add

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_scalarmath.py:654:21
653	            val_repr = repr(val)
654	            val2 = t(eval(val_repr))
655	            if not (val2 == 0 and val < 1e-100):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:244:15
243	        data_a = self._load_b(data * self._nlanes())
244	        func = eval(intrin)
245	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:510:15
509	        chk_nan = {"xp": 1, "np": 1, "nn": 2, "xn": 2}.get(intrin[-2:], 0)
510	        func = eval(intrin[:3])
511	        reduce_intrin = getattr(self, "reduce_" + intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:640:15
639	        data_a = self.load(data * self.nlanes)
640	        func = eval(intrin)
641	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:701:42
700	            return
701	        npyv_load_tillz, npyv_load_till = eval(intrin)
702	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:721:26
720	            return
721	        npyv_store_till = eval(intrin)
722	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:741:21
740	            return
741	        npyv_loadn = eval(intrin)
742	        for stride in range(-64, 64):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:767:44
766	            return
767	        npyv_loadn_tillz, npyv_loadn_till = eval(intrin)
768	        lanes = list(range(1, self.nlanes + 1))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:804:22
803	            return
804	        npyv_storen = eval(intrin)
805	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:843:27
842	            return
843	        npyv_storen_till = eval(intrin)
844	        data = self._data()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:895:17
894	            return
895	        intrin = eval(intrin)
896	        idx_itrin = getattr(self.npyv, f"setall_u{elsize}")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_simd.py:1102:15
1101	        data_a = self.load(data * self.nlanes)
1102	        func = eval(intrin)
1103	        intrin = getattr(self, intrin)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_stringdtype.py:366:14
365	    with open(f.name, "rb") as f:
366	        res = pickle.load(f)
367	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_ufunc.py:204:20
203	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
204	            assert_(pickle.loads(pickle.dumps(np.sin,
205	                                              protocol=proto)) is np.sin)
206	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_ufunc.py:209:18
208	            # such as numpy._core._rational_tests.test_add can also be pickled
209	            res = pickle.loads(pickle.dumps(_rational_tests.test_add,
210	                                            protocol=proto))
211	            assert_(res is _rational_tests.test_add)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_ufunc.py:216:16
215	                   b"(S'numpy._core.umath'\np1\nS'cos'\np2\ntp3\nRp4\n.")
216	        assert_(pickle.loads(astring) is np.cos)
217	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_ufunc.py:226:14
225	
226	        obj = pickle.loads(pickle.dumps(_pickleable_module_global.ufunc))
227	        assert obj is umt._pickleable_module_global_ufunc

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_ufunc.py:501:18
500	        int64 = np.dtype("int64")
501	        int64_2 = pickle.loads(pickle.dumps(int64))
502	        # Relies on pickling behavior, if assert fails just remove test...

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_umath.py:513:25
512	        lsize = 512 + 7
513	        a, b, divisors = eval(ex_val)
514	        a_lst, b_lst = a.tolist(), b.tolist()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_umath.py:577:12
576	        fo = np.iinfo(dtype)
577	        a = eval(ex_val)
578	        lst = a.tolist()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_umath_accuracy.py:71:128
70	                        data_subset = data[data['type'] == datatype]
71	                        inval = np.array(str_to_float(data_subset['input'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
72	                        outval = np.array(str_to_float(data_subset['output'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/_core/tests/test_umath_accuracy.py:72:130
71	                        inval = np.array(str_to_float(data_subset['input'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
72	                        outval = np.array(str_to_float(data_subset['output'].astype(str), data_subset['type'].astype(str)), dtype=eval(datatype))
73	                        perm = np.random.permutation(len(inval))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/auxfuncs.py:632:11
631	        l2.append('f%d(v)' % (i))
632	    return eval(f"{l1}:{' and '.join(l2)}")
633	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/auxfuncs.py:640:11
639	        l2.append('f%d(v)' % (i))
640	    return eval(f"{l1}:{' or '.join(l2)}")
641	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/auxfuncs.py:644:11
643	def l_not(f):
644	    return eval('lambda v,f=f:not f(v)')
645	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/capi_maps.py:159:16
158	        with open(f2cmap_file) as f:
159	            d = eval(f.read().lower(), {}, {})
160	        f2cmap_all, f2cmap_mapped = process_f2cmap_dict(f2cmap_all, d, c2py_map, True)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/capi_maps.py:296:31
295	        try:
296	            ret['size'] = repr(eval(ret['size']))
297	        except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/capi_maps.py:449:24
448	                else:
449	                    v = eval(v, {}, {})
450	                    ret['init.r'], ret['init.i'] = str(v.real), str(v.imag)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:1329:20
1328	            try:
1329	                v = eval(initexpr, {}, params)
1330	            except (SyntaxError, NameError, TypeError) as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2271:8
2270	    """ Like `eval` but returns only integers and floats """
2271	    r = eval(e, g, l)
2272	    if type(r) in [int, float]:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2559:16
2558	        # TODO: use symbolic from PR #19805
2559	        value = eval(value, {}, params)
2560	        value = (repr if isinstance(value, str) else str)(value)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2637:28
2636	                try:
2637	                    l = str(eval(l, {}, params))
2638	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2646:28
2645	                try:
2646	                    l = str(eval(l, {}, params))
2647	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2914:57
2913	                                try:
2914	                                    kindselect['kind'] = eval(
2915	                                        kindselect['kind'], {}, params)
2916	                                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:2985:16
2984	        try:
2985	            p = eval(v, g_params, params)
2986	        except Exception as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:3016:19
3015	        try:
3016	            item = eval(item, g_params, params)
3017	        except Exception as msg:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/f2py/crackfortran.py:3468:24
3467	                try:
3468	                    v = eval(v)
3469	                    v = f'({v.real},{v.imag})'

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/numpy/lib/_datasource.py:333:17
332	        if self._isurl(path):
333	            with urlopen(path) as openedurl:
334	                with _open(upath, 'wb') as f:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/numpy/lib/_datasource.py:475:26
474	            try:
475	                netfile = urlopen(path)
476	                netfile.close()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/lib/_format_impl.py:838:20
837	        try:
838	            array = pickle.load(fp, **pickle_kwargs)
839	        except UnicodeError as err:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/lib/_npyio_impl.py:494:23
493	            try:
494	                return pickle.load(fid, **pickle_kwargs)
495	            except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:733:32
732	                    a.mask = mask
733	                    a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
734	                    assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:748:24
747	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
748	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
749	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:757:25
756	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
757	            mc_pickled = pickle.loads(pickle.dumps(mc, protocol=proto))
758	            assert_equal(mc_pickled._baseclass, mc._baseclass)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:767:24
766	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
767	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
768	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:777:19
776	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
777	            test = pickle.loads(pickle.dumps(b, protocol=proto))
778	            assert_equal(test, b)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_core.py:5547:22
5546	                f.seek(0)
5547	                res = pickle.load(f)
5548	            assert_(res is np.ma.masked)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_mrecords.py:293:20
292	            _ = pickle.dumps(mrec, protocol=proto)
293	            mrec_ = pickle.loads(_)
294	            assert_equal(mrec_.dtype, mrec.dtype)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/ma/tests/test_old_ma.py:621:16
620	            s = pickle.dumps(x, protocol=proto)
621	            y = pickle.loads(s)
622	            assert_(eq(x, y))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/matrixlib/tests/test_masked_matrix.py:89:24
88	        for proto in range(2, pickle.HIGHEST_PROTOCOL + 1):
89	            a_pickled = pickle.loads(pickle.dumps(a, protocol=proto))
90	            assert_equal(a_pickled._mask, a._mask)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/polynomial/tests/test_polynomial.py:62:12
61	        x = poly.Polynomial([1, 2, 3])
62	        y = pickle.loads(pickle.dumps(x))
63	        assert_equal(x, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_direct.py:303:19
302	        bitgen_pkl = pickle.dumps(bit_generator)
303	        reloaded = pickle.loads(bitgen_pkl)
304	        reloaded_state = reloaded.state

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_direct.py:311:13
310	        ss = SeedSequence(100)
311	        aa = pickle.loads(pickle.dumps(ss))
312	        assert_equal(ss.state, aa.state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_direct.py:321:17
320	        ss = bit_generator.seed_seq
321	        bg_plk = pickle.loads(pickle.dumps(bit_generator))
322	        ss_plk = bg_plk.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_direct.py:327:17
326	        bit_generator.seed_seq.spawn(10)
327	        bg_plk = pickle.loads(pickle.dumps(bit_generator))
328	        ss_plk = bg_plk.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_direct.py:555:18
554	        with gzip.open(pkl_file) as gz:
555	            sfc = pickle.load(gz)
556	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_generator_mt19937.py:2781:13
2780	    ss = rg.bit_generator.seed_seq
2781	    rg_plk = pickle.loads(pickle.dumps(rg))
2782	    ss_plk = rg_plk.bit_generator.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_generator_mt19937.py:2787:13
2786	    rg.bit_generator.seed_seq.spawn(10)
2787	    rg_plk = pickle.loads(pickle.dumps(rg))
2788	    ss_plk = rg_plk.bit_generator.seed_seq

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_generator_mt19937.py:2803:13
2802	    with gzip.open(pkl_file) as gz:
2803	        rg = pickle.load(gz)
2804	    state = rg.bit_generator.state['state']

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_randomstate.py:268:20
267	        assert_equal(pickled['has_gauss'], 1)
268	        rs_unpick = pickle.loads(pickle.dumps(self.random_state))
269	        unpickled = rs_unpick.get_state(legacy=False)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_smoke.py:437:17
436	        pick = pickle.dumps(self.rg)
437	        unpick = pickle.loads(pick)
438	        assert_(type(self.rg) == type(unpick))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/random/tests/test_smoke.py:443:17
442	        pick = pickle.dumps(self.rg)
443	        unpick = pickle.loads(pick)
444	        assert_(type(self.rg) == type(unpick))

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/numpy/testing/_private/utils.py:1297:4
1296	def runstring(astr, dict):
1297	    exec(astr, dict)
1298	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/numpy/testing/_private/utils.py:1583:8
1582	        i += 1
1583	        exec(code, globs, locs)
1584	    elapsed = jiffies() - elapsed

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/numpy/tests/test_public_api.py:407:12
406	        try:
407	            eval(module_name)
408	        except AttributeError:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/numpy/tests/test_reloading.py:45:16
44	        assert_equal(repr(np._NoValue), '<no value>')
45	        assert_(pickle.loads(pickle.dumps(np._NoValue,
46	                                          protocol=proto)) is np._NoValue)
47	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/oauthlib/oauth1/rfc5849/__init__.py:223:63
222	        if request.body is not None and content_type_eligible:
223	            params.append(('oauth_body_hash', base64.b64encode(hashlib.sha1(request.body.encode('utf-8')).digest()).decode('utf-8')))  # noqa: S324
224	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/matmul_nbits_quantizer.py:456:23
455	        if "cnn" in dataset_name:
456	            dataset2 = load_dataset("cnn_dailymail", name="3.0.0", split="train").select(range(max_calib_rows_to_load))
457	            column = "article"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/matmul_nbits_quantizer.py:459:23
458	        elif "pile" in dataset_name:
459	            dataset2 = load_dataset("mit-han-lab/pile-val-backup", split="validation")
460	            column = "text"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/neural_compressor/onnx_model.py:63:27
62	
63	            self._config = AutoConfig.from_pretrained(Path(model).parent.as_posix())
64	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/quant_utils.py:990:14
989	        logging.warning(
990	            f"The original model opset version is {opset_version}, which does not support quantization to float 8. "
991	            "Please update the model to opset >= 19. Automatically update the model to opset 19. "
992	            "Please verify the quantized model."
993	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/quant_utils.py:998:14
997	        logging.warning(
998	            f"The original model opset version is {opset_version}, which does not support node fusions. "
999	            "Please update the model to opset >= 11 for better performance."
1000	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/quantization/quant_utils.py:1004:14
1003	        logging.warning(
1004	            f"The original model opset version is {opset_version}, which does not support quantization. "
1005	            "Please update the model to opset >= 11. Automatically update the model to opset 11. "
1006	            "Please verify the quantized model."
1007	        )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/benchmark.py:224:21
223	            device = "cuda" if use_gpu else "cpu"
224	            config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
225	            max_last_state_size = numpy.prod(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/benchmark.py:337:17
336	    for model_name in model_names:
337	        config = AutoConfig.from_pretrained(model_name, torchscript=torchscript, cache_dir=cache_dir)
338	        config_modifier.modify(config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/benchmark.py:350:24
349	        else:
350	            tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
351	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/benchmark.py:491:17
490	    for model_name in model_names:
491	        config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
492	        config_modifier.modify(config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/benchmark.py:502:20
501	
502	        tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
503	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:2694:17
2693	    if is_gpt2:
2694	        config = GPT2Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2695	    elif args.model_type == "t5":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:2696:17
2695	    elif args.model_type == "t5":
2696	        config = T5Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2697	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:2698:17
2697	    else:
2698	        config = MT5Config.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
2699	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:3157:16
3156	
3157	    tokenizer = GPT2Tokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
3158	    tokenizer.padding_side = "left"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:3161:12
3160	
3161	    model = GPT2LMHeadModel.from_pretrained(
3162	        args.model_name_or_path,
3163	        cache_dir=args.cache_dir,
3164	        pad_token_id=tokenizer.eos_token_id,
3165	    )
3166	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:3372:16
3371	
3372	    tokenizer = T5Tokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
3373	    tokenizer.padding_side = "left"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:3376:16
3375	    if args.model_type == "t5":
3376	        model = T5ForConditionalGeneration.from_pretrained(
3377	            args.model_name_or_path,
3378	            cache_dir=args.cache_dir,
3379	        )
3380	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_generation.py:3381:16
3380	    else:
3381	        model = MT5ForConditionalGeneration.from_pretrained(
3382	            args.model_name_or_path,
3383	            cache_dir=args.cache_dir,
3384	        )
3385	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:58:8
57	def download_compressed_file(tf_ckpt_url, ckpt_dir):
58	    r = requests.get(tf_ckpt_url)
59	    compressed_file_name = tf_ckpt_url.split("/")[-1]

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:112:12
111	        with tarfile.open(tar_dir, "r") as tar_ref:
112	            tar_ref.extractall(ckpt_dir)
113	            os.remove(tar_dir)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/convert_tf_models_to_pytorch.py:124:16
123	        ]:
124	            r = requests.get(tf_ckpt_url + "/" + filename)
125	            with open(os.path.join(ckpt_dir, filename), "wb") as f:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/large_model_exporter.py:60:12
59	
60	    model = transformers.AutoModelForCausalLM.from_pretrained(  # type: ignore
61	        hf_model, torch_dtype=torch.float16, cache_dir=cache_dir, trust_remote_code=True
62	    )
63	    if tokenizer is None:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/large_model_exporter.py:65:16
64	        tokenizer = hf_model
65	    tokenizer = transformers.AutoTokenizer.from_pretrained(tokenizer)  # type: ignore
66	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/bert/eval_squad.py:220:16
219	    all_results = []
220	    tokenizer = AutoTokenizer.from_pretrained(pretrained_model_name)
221	    for sequence_length in args.sequence_lengths:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/bert/eval_squad.py:242:24
241	        start_time = time.time()
242	        squad_dataset = load_dataset("squad", split=f"validation[:{args.total}]" if args.total > 0 else "validation")
243	        latency = time.time() - start_time

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/gpt2/benchmark_gpt2.py:193:13
192	    gpt2helper = Gpt2Helper
193	    config = AutoConfig.from_pretrained(args.model_name_or_path, torchscript=args.torchscript, cache_dir=cache_dir)
194	    model = model_class.from_pretrained(args.model_name_or_path, config=config, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/gpt2/convert_to_onnx.py:280:13
279	    gpt2helper = Gpt2Helper
280	    config = AutoConfig.from_pretrained(args.model_name_or_path, cache_dir=cache_dir)
281	    model = model_class.from_pretrained(args.model_name_or_path, config=config, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark.py:197:16
196	        start_time = time.time()
197	        model = AutoModelForCausalLM.from_pretrained(
198	            source,
199	            torch_dtype=torch.float16 if args.use_fp16 else torch.float32,
200	            use_auth_token=args.auth,
201	            trust_remote_code=args.auth,
202	            use_cache=True,
203	            cache_dir=args.cache_dir,
204	        ).to(args.target_device)
205	        end_time = time.time()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark.py:663:16
662	    args.world_size = world_size
663	    tokenizer = AutoTokenizer.from_pretrained(
664	        args.model_name, cache_dir=args.cache_dir, use_auth_token=args.auth, trust_remote_code=args.auth
665	    )
666	    config = AutoConfig.from_pretrained(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark.py:666:13
665	    )
666	    config = AutoConfig.from_pretrained(
667	        args.model_name, cache_dir=args.cache_dir, use_auth_token=args.auth, trust_remote_code=args.auth
668	    )
669	    target_device = f"cuda:{args.rank}" if args.device != "cpu" else args.device

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:67:20
66	
67	            model = AutoModelForCausalLM.from_pretrained(
68	                args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
69	                cache_dir=args.cache_dir,
70	                torch_dtype=args.torch_dtype,
71	                use_auth_token=args.auth,
72	                trust_remote_code=args.trust,
73	                use_cache=True,
74	                attn_implementation="flash_attention_2",
75	                quantization_config=bnb_config,
76	                max_memory={args.device_id: "80GB"},
77	            )
78	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:80:24
79	            try:
80	                model = AutoModelForCausalLM.from_pretrained(
81	                    args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
82	                    cache_dir=args.cache_dir,
83	                    torch_dtype=args.torch_dtype,
84	                    use_auth_token=args.auth,
85	                    trust_remote_code=args.trust,
86	                    use_cache=True,
87	                    attn_implementation=("flash_attention_2" if args.device == "cuda" else "sdpa"),
88	                ).to(args.target_device)
89	            except Exception as e:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:93:24
92	                print("Try to load a model using eager mode: ", e)
93	                model = AutoModelForCausalLM.from_pretrained(
94	                    args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
95	                    cache_dir=args.cache_dir,
96	                    torch_dtype=args.torch_dtype,
97	                    use_auth_token=args.auth,
98	                    trust_remote_code=args.trust,
99	                    use_cache=True,
100	                    attn_implementation="eager",
101	                ).to(args.target_device)
102	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:365:13
364	    # Get config, tokenizer, and model
365	    config = AutoConfig.from_pretrained(
366	        args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
367	        cache_dir=args.cache_dir,
368	        use_auth_token=args.auth,
369	        trust_remote_code=args.trust,
370	    )
371	    tokenizer = AutoTokenizer.from_pretrained(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/benchmark_e2e.py:371:16
370	    )
371	    tokenizer = AutoTokenizer.from_pretrained(
372	        args.hf_dir_path if args.hf_dir_path != "" else args.model_name,
373	        cache_dir=args.cache_dir,
374	        use_auth_token=args.auth,
375	        trust_remote_code=args.trust,
376	    )
377	    model = get_model(args)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/convert_to_onnx.py:831:17
830	    if args.optimize_optimum:
831	        config = AutoConfig.from_pretrained(args.original_model_name, cache_dir=args.cache_dir)
832	        optimize_optimum(config, args)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/llama_torch.py:27:23
26	        if i == rank % (world_size):
27	            l_config = AutoConfig.from_pretrained(
28	                location, use_auth_token=auth, cache_dir=args.cache_dir, trust_remote_code=auth
29	            )
30	            l_config.use_cache = True

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/llama_torch.py:32:20
31	            l_config._attn_implementation = "eager"  # "eager" uses LlamaAttention for attention layer
32	            llama = AutoModelForCausalLM.from_pretrained(
33	                location,
34	                use_auth_token=auth,
35	                trust_remote_code=auth,
36	                config=l_config,
37	                torch_dtype=torch_dtype,
38	                cache_dir=args.cache_dir,
39	            )
40	            if world_size > 1:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/quant_kv_dataloader.py:23:20
22	
23	        tokenizer = LlamaTokenizer.from_pretrained(args.original_model_name, use_auth_token=args.use_auth_token)
24	        dataset = load_dataset(args.smooth_quant_dataset, split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/llama/quant_kv_dataloader.py:24:18
23	        tokenizer = LlamaTokenizer.from_pretrained(args.original_model_name, use_auth_token=args.use_auth_token)
24	        dataset = load_dataset(args.smooth_quant_dataset, split="train")
25	        dataset = dataset.map(lambda examples: tokenizer(examples["text"]), batched=True)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/longformer/benchmark_longformer.py:293:12
292	    torch_model_name_or_dir = PRETRAINED_LONGFORMER_MODELS.get(model_name, model_name)
293	    model = LongformerModel.from_pretrained(torch_model_name_or_dir)
294	    model.to(device)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/longformer/convert_to_onnx.py:401:12
400	
401	    model = LongformerModel.from_pretrained(PRETRAINED_LONGFORMER_MODELS[model_name])
402	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/phi2/convert_to_onnx.py:38:26
37	        self.cache_dir = cache_dir
38	        self.phi_config = AutoConfig.from_pretrained(self.model_class, trust_remote_code=True, cache_dir=self.cache_dir)
39	        self.phi_model = None

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/phi2/convert_to_onnx.py:77:25
76	            return
77	        self.phi_model = AutoModelForCausalLM.from_pretrained(
78	            self.model_class, trust_remote_code=True, cache_dir=self.cache_dir
79	        )
80	        self.phi_model.eval()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/phi2/inference_example.py:223:25
222	
223	        self.tokenizer = AutoTokenizer.from_pretrained("microsoft/phi-2", trust_remote_code=True)
224	        self.tokenizer.pad_token = "[PAD]"

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_txt2img_xl.py:225:14
224	
225	    dataset = load_dataset("Gustavosta/Stable-Diffusion-Prompts")
226	    num_rows = dataset["test"].num_rows

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_utils.py:615:22
614	
615	    depth_estimator = DPTForDepthEstimation.from_pretrained("Intel/dpt-hybrid-midas").to("cuda")
616	    feature_extractor = DPTFeatureExtractor.from_pretrained("Intel/dpt-hybrid-midas")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/stable_diffusion/demo_utils.py:616:24
615	    depth_estimator = DPTForDepthEstimation.from_pretrained("Intel/dpt-hybrid-midas").to("cuda")
616	    feature_extractor = DPTFeatureExtractor.from_pretrained("Intel/dpt-hybrid-midas")
617	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/stable_diffusion/diffusion_models.py:1242:16
1241	    if not os.path.exists(tokenizer_dir):
1242	        model = CLIPTokenizer.from_pretrained(
1243	            pipeline_info.name(),
1244	            subfolder=subfolder,
1245	            use_safetensors=pipeline_info.is_xl(),
1246	        )
1247	        model.save_pretrained(tokenizer_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/stable_diffusion/diffusion_models.py:1250:16
1249	        print(f"[I] Load tokenizer pytorch model from: {tokenizer_dir}")
1250	        model = CLIPTokenizer.from_pretrained(tokenizer_dir)
1251	    return model

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:84:20
83	        if model_type == "t5":
84	            model = T5ForConditionalGeneration.from_pretrained(model_name_or_path, cache_dir=cache_dir)
85	        elif model_type == "mt5":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:86:20
85	        elif model_type == "mt5":
86	            model = MT5ForConditionalGeneration.from_pretrained(model_name_or_path, cache_dir=cache_dir)
87	        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/t5/t5_helper.py:91:34
90	        if state_dict_path:
91	            model.load_state_dict(torch.load(state_dict_path))
92	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:116:16
115	        start_time = time.time()
116	        model = AutoModelForSpeechSeq2Seq.from_pretrained(
117	            source,
118	            torch_dtype=torch.float16 if args.use_fp16 else torch.float32,
119	            use_cache=True,
120	        ).to(args.target_device)
121	        end_time = time.time()

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:579:13
578	
579	    config = WhisperConfig.from_pretrained(args.model_name)
580	    processor = WhisperProcessor.from_pretrained(args.model_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/benchmark.py:580:16
579	    config = WhisperConfig.from_pretrained(args.model_name)
580	    processor = WhisperProcessor.from_pretrained(args.model_name)
581	    target_device = f"cuda:{args.device_id}" if args.device != "cpu" else args.device

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/benchmark_all.py:370:13
369	
370	    config = WhisperConfig.from_pretrained(args.model_name)
371	    processor = WhisperProcessor.from_pretrained(args.model_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/benchmark_all.py:371:16
370	    config = WhisperConfig.from_pretrained(args.model_name)
371	    processor = WhisperProcessor.from_pretrained(args.model_name)
372	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_chain.py:54:13
53	
54	    config = WhisperConfig.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
55	    tokenizer = WhisperTokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_chain.py:55:16
54	    config = WhisperConfig.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
55	    tokenizer = WhisperTokenizer.from_pretrained(args.model_name_or_path, cache_dir=args.cache_dir)
56	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:82:17
81	    ) -> None:
82	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
83	        config.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:85:20
84	
85	        tokenizer = AutoTokenizer.from_pretrained(model_name_or_path, cache_dir=cache_dir)
86	        tokenizer.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:88:20
87	
88	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
89	        processor.save_pretrained(output_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:649:20
648	            # Load from Hugging Face
649	            model = WhisperForConditionalGeneration.from_pretrained(
650	                model_name_or_path, cache_dir=cache_dir, attn_implementation="eager"
651	            )
652	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:666:17
665	            model.to(dtype=dtype)
666	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
667	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:812:12
811	            logger.warning(f"Could not import `datasets`. Attempting to install `datasets` via `{install_cmd}`.")
812	            os.system(install_cmd)
813	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:816:13
815	
816	        ds = load_dataset("hf-internal-testing/librispeech_asr_dummy", "clean", split="validation")
817	        input_features_ = []

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:937:19
936	        """Compare the result from PyTorch and ONNX Runtime to verify the ONNX model is good."""
937	        pt_model = WhisperForConditionalGeneration.from_pretrained(
938	            model_name_or_path, cache_dir=cache_dir, attn_implementation="eager"
939	        ).to(device)
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:940:20
939	        ).to(device)
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
941	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_helper.py:941:17
940	        processor = WhisperProcessor.from_pretrained(model_name_or_path, cache_dir=cache_dir)
941	        config = WhisperConfig.from_pretrained(model_name_or_path, cache_dir=cache_dir)
942	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/models/whisper/whisper_jump_times.py:206:12
205	            logger.warning(f"Could not import `ninja`. Attempting to install `ninja` via `{install_cmd}`.")
206	            os.system(install_cmd)
207	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:308:19
307	        if is_tf_model:
308	            return TFGPT2ModelNoPastState.from_pretrained(model_name, config=config, cache_dir=cache_dir)
309	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:310:19
309	        else:
310	            return GPT2ModelNoPastState.from_pretrained(model_name, config=config, cache_dir=cache_dir)
311	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:323:13
322	def load_pt_model(model_name, model_class, cache_dir, config_modifier):
323	    config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
324	    if hasattr(config, "return_dict"):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:335:13
334	def load_tf_model(model_name, model_class, cache_dir, config_modifier):
335	    config = AutoConfig.from_pretrained(model_name, cache_dir=cache_dir)
336	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:489:26
488	    if model_type in ["vit", "swin"]:
489	        image_processor = AutoFeatureExtractor.from_pretrained(model_name, cache_dir=cache_dir)
490	        data = numpy.random.randint(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:496:20
495	    else:
496	        tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
497	        max_input_size = tokenizer.model_max_length

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/onnxruntime/transformers/onnx_exporter.py:597:16
596	
597	    tokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=cache_dir)
598	    # Fix "Using pad_token, but it is not set yet" error.

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/packaging/licenses/__init__.py:100:18
99	    try:
100	        invalid = eval(python_expression, globals(), locals())
101	    except Exception:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:1738:12
1737	            code = compile(source, script_filename, 'exec')
1738	            exec(code, namespace, namespace)
1739	        else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:1749:12
1748	            script_code = compile(script_text, script_filename, 'exec')
1749	            exec(script_code, namespace, namespace)
1750	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/posthog/feature_flags.py:31:19
30	    hash_key = f"{key}.{distinct_id}{salt}"
31	    hash_val = int(hashlib.sha1(hash_key.encode("utf-8")).hexdigest()[:15], 16)
32	    return hash_val / __LONG_SCALE__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/pydantic/deprecated/parse.py:54:15
53	        bb = b if isinstance(b, bytes) else b.encode()  # type: ignore
54	        return pickle.loads(bb)
55	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/pydantic/v1/parse.py:42:15
41	        bb = b if isinstance(b, bytes) else b.encode()
42	        return pickle.loads(bb)
43	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/pydantic/v1/utils.py:195:8
194	    try:
195	        eval('__IPYTHON__')
196	    except NameError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/pygments/formatters/__init__.py:103:12
102	        with open(filename, 'rb') as f:
103	            exec(f.read(), custom_namespace)
104	        # Retrieve the class `formattername` from that namespace

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/__init__.py:154:12
153	        with open(filename, 'rb') as f:
154	            exec(f.read(), custom_namespace)
155	        # Retrieve the class `lexername` from that namespace

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_lua_builtins.py:225:12
224	    def get_newest_version():
225	        f = urlopen('http://www.lua.org/manual/')
226	        r = re.compile(r'^<A HREF="(\d\.\d)/">(Lua )?\1</A>')

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_lua_builtins.py:233:12
232	    def get_lua_functions(version):
233	        f = urlopen(f'http://www.lua.org/manual/{version}/')
234	        r = re.compile(r'^<A HREF="manual.html#pdf-(?!lua|LUA)([^:]+)">\1</A>')

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_mysql_builtins.py:1248:19
1247	        # Pull content from lex.h.
1248	        lex_file = urlopen(LEX_URL).read().decode('utf8', errors='ignore')
1249	        keywords = parse_lex_keywords(lex_file)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_mysql_builtins.py:1254:27
1253	        # Parse content in item_create.cc.
1254	        item_create_file = urlopen(ITEM_CREATE_URL).read().decode('utf8', errors='ignore')
1255	        functions.update(parse_item_create_functions(item_create_file))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_php_builtins.py:3299:19
3298	    def get_php_references():
3299	        download = urlretrieve(PHP_MANUAL_URL)
3300	        with tarfile.open(download[0]) as tar:

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_php_builtins.py:3301:12
3300	        with tarfile.open(download[0]) as tar:
3301	            tar.extractall()
3302	        yield from glob.glob(f"{PHP_MANUAL_DIR}{PHP_REFERENCE_GLOB}")

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_postgres_builtins.py:642:18
641	    def update_myself():
642	        content = urlopen(DATATYPES_URL).read().decode('utf-8', errors='ignore')
643	        data_file = list(content.splitlines())

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/pygments/lexers/_postgres_builtins.py:647:18
646	
647	        content = urlopen(KEYWORDS_URL).read().decode('utf-8', errors='ignore')
648	        keywords = parse_keywords(content)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/pypika/dialects.py:559:25
558	                    )
559	            action_sql = " DO UPDATE SET {updates}".format(updates=",".join(updates))
560	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/pypika/queries.py:1100:33
1099	        if 0 == len(self._from):
1100	            raise QueryException("Cannot select {term}, no FROM table specified.".format(term=term))
1101	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/regex/tests/test_regex.py:3775:12
3774	        p = pickle.dumps(r)
3775	        r = pickle.loads(p)
3776	        self.assertEqual(r.match('foo').span(), (0, 3))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/requests/auth.py:148:23
147	                    x = x.encode("utf-8")
148	                return hashlib.md5(x).hexdigest()
149	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/requests/auth.py:156:23
155	                    x = x.encode("utf-8")
156	                return hashlib.sha1(x).hexdigest()
157	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/requests/auth.py:205:17
204	
205	        cnonce = hashlib.sha1(s).hexdigest()[:16]
206	        if _algorithm == "MD5-SESS":

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/rich/style.py:471:66
470	        """Get meta information (can not be changed after construction)."""
471	        return {} if self._meta is None else cast(Dict[str, Any], loads(self._meta))
472	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/__config__.py:109:20
108	        "Python Information": {
109	            "path": r"/tmp/build-env-99e64tom/bin/python",
110	            "version": "3.12",
111	        },
112	    }
113	)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/_bunch.py:160:4
159	                 '__name__': f'namedtuple_{typename}'}
160	    exec(s, namespace)
161	    __new__ = namespace['__new__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/array_api_compat/cupy/fft.py:6:0
5	_n = {}
6	exec('from cupy.fft import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/array_api_compat/cupy/linalg.py:6:0
5	_n = {}
6	exec('from cupy.linalg import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/array_api_compat/dask/array/fft.py:6:0
5	_n = {}
6	exec('from dask.array.fft import *', _n)
7	for k in ("__builtins__", "Sequence", "annotations", "warnings"):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/array_api_compat/dask/array/linalg.py:22:0
21	_n = {}
22	exec('from dask.array.linalg import *', _n)
23	for k in ('__builtins__', 'annotations', 'operator', 'warnings', 'Array'):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/array_api_compat/torch/__init__.py:12:4
11	        continue
12	    exec(f"{n} = torch.{n}")
13	del n

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/decorator.py:166:12
165	            code = compile(src, filename, 'single')
166	            exec(code, evaldict)
167	        except:  # noqa: E722

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/_lib/tests/test_bunch.py:59:14
58	        s = pickle.dumps(self.result)
59	        obj = pickle.loads(s)
60	        assert isinstance(obj, Result)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/datasets/_fetchers.py:80:23
79	    with open(fname, 'rb') as f:
80	        ascent = array(pickle.load(f))
81	    return ascent

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/interpolate/tests/test_interpnd.py:172:14
171	        ip = interpnd.LinearNDInterpolator(x, y)
172	        ip2 = pickle.loads(pickle.dumps(ip))
173	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/interpolate/tests/test_interpnd.py:411:14
410	        ip = interpnd.CloughTocher2DInterpolator(x, y)
411	        ip2 = pickle.loads(pickle.dumps(ip))
412	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/interpolate/tests/test_rbfinterp.py:418:16
417	        yitp1 = interp(xitp)
418	        yitp2 = pickle.loads(pickle.dumps(interp))(xitp)
419	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/odr/tests/test_odr.py:576:8
575	        del data
576	        pickle.loads(obj_pickle)
577	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/odr/tests/test_odr.py:585:8
584	        del data
585	        pickle.loads(obj_pickle)
586	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/odr/tests/test_odr.py:589:8
588	        obj_pickle = pickle.dumps(unilinear)
589	        pickle.loads(obj_pickle)
590	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/odr/tests/test_odr.py:598:8
597	        del odr_obj
598	        pickle.loads(obj_pickle)
599	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/odr/tests/test_odr.py:607:8
606	        del output
607	        pickle.loads(obj_pickle)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/optimize/_nonlin.py:1621:4
1620	    ns.update(globals())
1621	    exec(wrapper, ns)
1622	    func = ns[name]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/optimize/tests/test_constraints.py:183:22
182	            bounds = Bounds(*args)
183	            bounds2 = eval(repr(Bounds(*args)))
184	            assert_array_equal(bounds.lb, bounds2.lb)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:44:14
43	    if not hasattr(mat, 'shape'):
44	        mat = eval(mat, dict(np=np, sparse=sparse))
45	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:300:19
299	        if form == "array":
300	            d[L] = eval(L)
301	        else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/sparse/csgraph/tests/test_graph_laplacian.py:302:19
301	        else:
302	            d[L] = eval(L)(np.eye(n, dtype=mat.dtype))
303	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/sparse/linalg/tests/test_interface.py:397:12
396	        s = pickle.dumps(A, protocol=protocol)
397	        B = pickle.loads(s)
398	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/sparse/tests/test_base.py:2255:27
2254	            for protocol in range(pickle.HIGHEST_PROTOCOL):
2255	                sploaded = pickle.loads(pickle.dumps(datsp, protocol=protocol))
2256	                assert_equal(datsp.shape, sploaded.shape)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:445:37
444	            with maybe_deprecated(metric):
445	                cdist(X1, X2, metric=eval(metric), **kwargs)
446	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:452:33
451	        with pytest.raises(TypeError):
452	            cdist(X1, X2, metric=eval(metric), *args)
453	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:559:38
558	            y1 = cdist(X1, X2, metric=metric, **kwargs)
559	            y2 = cdist(X1, X2, metric=eval(metric), **kwargs)
560	            y3 = cdist(X1, X2, metric="test_" + metric, **kwargs)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:569:37
568	            with pytest.raises(e_cls):
569	                cdist(X1, X2, metric=eval(metric), **kwargs)
570	            with pytest.raises(e_cls):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:755:33
754	            with maybe_deprecated(metric):
755	                pdist(X1, metric=eval(metric), **kwargs)
756	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:762:29
761	        with pytest.raises(TypeError):
762	            pdist(X1, metric=eval(metric), *args)
763	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:1394:33
1393	            y1 = pdist(X, metric=metric, **kwargs)
1394	            y2 = pdist(X, metric=eval(metric), **kwargs)
1395	            y3 = pdist(X, metric="test_" + metric, **kwargs)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:1404:32
1403	            with pytest.raises(e_cls):
1404	                pdist(X, metric=eval(metric), **kwargs)
1405	            with pytest.raises(e_cls):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_distance.py:2137:22
2136	
2137	    for m in [metric, eval(metric), "test_" + metric]:
2138	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_kdtree.py:855:9
854	    tmp = pickle.dumps(T1)
855	    T2 = pickle.loads(tmp)
856	    T1 = T1.query(points, k=5)[-1]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/tests/test_kdtree.py:869:9
868	    tmp = pickle.dumps(T1)
869	    T2 = pickle.loads(tmp)
870	    T1 = T1.query(points, k=5)[-1]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/spatial/transform/tests/test_rotation.py:2118:16
2117	    pkl = pickle.dumps(r)
2118	    unpickled = pickle.loads(pkl)
2119	    xp_assert_close(r.as_matrix(), unpickled.as_matrix(), atol=1e-15)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/special/tests/test_orthogonal.py:280:20
279	            for pstr in poly:
280	                p = eval(pstr)
281	                assert_almost_equal(p(0.315), np.poly1d(p.coef)(0.315),

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/special/tests/test_support_alternative_backends.py:194:16
193	def test_pickle(func):
194	    roundtrip = pickle.loads(pickle.dumps(func))
195	    assert roundtrip is func

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/_distn_infrastructure.py:368:4
367	for obj in [s for s in dir() if s.startswith('_doc_')]:
368	    exec('del ' + obj)
369	del obj

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/_distn_infrastructure.py:744:8
743	        ns = {}
744	        exec(self._parse_arg_template, ns)
745	        # NB: attach to the instance, not class

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/common_tests.py:303:16
302	
303	    unpickled = pickle.loads(s)
304	    r1 = unpickled.rvs(*args, size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/common_tests.py:316:16
315	    pkl = pickle.dumps(frozen_dist)
316	    unpickled = pickle.loads(pkl)
317	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/common_tests.py:326:33
325	        pickled_fit_function = pickle.dumps(fit_function)
326	        unpickled_fit_function = pickle.loads(pickled_fit_function)
327	        assert fit_function.__name__ == unpickled_fit_function.__name__ == "fit"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_axis_nan_policy.py:764:25
763	    pickled_hypotest = pickle.dumps(hypotest)
764	    unpickled_hypotest = pickle.loads(pickled_hypotest)
765	    res1 = unpacker(hypotest(*data, *args, axis=-1, **kwds))

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_continuous.py:89:14
88	        right_comparison = '<=' if inclusive_b else '<'
89	        ref = eval(f'(a {left_comparison} x) & (x {right_comparison} b)')
90	        assert_equal(res, ref)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_continuous.py:974:12
973	    dist2 = deepcopy(dist1)
974	    dist3 = pickle.loads(pickle.dumps(dist1))
975	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_continuous.py:2047:19
2046	        from scipy.stats._new_distributions import Uniform # noqa: F401
2047	        new_dist = eval(repr(dist))
2048	        # A basic check that the distributions are the same

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_distributions.py:6876:24
6875	
6876	            unpickled = pickle.loads(s)
6877	            r1 = unpickled.rvs(size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_multivariate.py:3723:16
3722	
3723	    unpickled = pickle.loads(s)
3724	    r1 = unpickled.rvs(*args, size=8)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/scipy/stats/tests/test_sampling.py:258:11
257	    obj = pickle.dumps(rng1)
258	    rng2 = pickle.loads(obj)
259	    assert_equal(rng1.rvs(100), rng2.rvs(100))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:149:35
148	
149	        config: PretrainedConfig = AutoConfig.from_pretrained(
150	            model_name_or_path,
151	            cache_dir=cache_folder,
152	            trust_remote_code=trust_remote_code,
153	            revision=revision,
154	            local_files_only=local_files_only,
155	            token=token,
156	            **config_kwargs,
157	        )
158	        if hasattr(config, "sentence_transformers") and "version" in config.sentence_transformers:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:190:46
189	            tokenizer_kwargs["model_max_length"] = max_length
190	        self.tokenizer: PreTrainedTokenizer = AutoTokenizer.from_pretrained(
191	            model_name_or_path,
192	            cache_dir=cache_folder,
193	            trust_remote_code=trust_remote_code,
194	            revision=revision,
195	            local_files_only=local_files_only,
196	            token=token,
197	            **tokenizer_kwargs,
198	        )
199	        if "model_max_length" not in tokenizer_kwargs and hasattr(self.config, "max_position_embeddings"):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:237:42
236	        if backend == "torch":
237	            self.model: PreTrainedModel = AutoModelForSequenceClassification.from_pretrained(
238	                model_name_or_path,
239	                config=config,
240	                **model_kwargs,
241	            )
242	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:302:17
301	        dataset_path = dataset_name_to_id[dataset_name.lower()]
302	        corpus = load_dataset(dataset_path, "corpus", split="train")
303	        corpus_mapping = dict(zip(corpus["_id"], corpus["text"]))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:304:18
303	        corpus_mapping = dict(zip(corpus["_id"], corpus["text"]))
304	        queries = load_dataset(dataset_path, "queries", split="train")
305	        query_mapping = dict(zip(queries["_id"], queries["text"]))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/cross_encoder/evaluation/nano_beir.py:306:20
305	        query_mapping = dict(zip(queries["_id"], queries["text"]))
306	        relevance = load_dataset(dataset_path, "relevance", split="train")
307	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:413:17
412	        dataset_path = dataset_name_to_id[dataset_name.lower()]
413	        corpus = load_dataset(dataset_path, "corpus", split="train")
414	        queries = load_dataset(dataset_path, "queries", split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:414:18
413	        corpus = load_dataset(dataset_path, "corpus", split="train")
414	        queries = load_dataset(dataset_path, "queries", split="train")
415	        qrels = load_dataset(dataset_path, "qrels", split="train")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/evaluation/NanoBEIREvaluator.py:415:16
414	        queries = load_dataset(dataset_path, "queries", split="train")
415	        qrels = load_dataset(dataset_path, "qrels", split="train")
416	        corpus_dict = {sample["_id"]: sample["text"] for sample in corpus if len(sample["text"]) > 0}

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:96:33
95	
96	        self.tokenizer_decoder = AutoTokenizer.from_pretrained(decoder_name_or_path)
97	        self.need_retokenization = not isinstance(self.tokenizer_encoder, type(self.tokenizer_decoder))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:99:25
98	
99	        decoder_config = AutoConfig.from_pretrained(decoder_name_or_path)
100	        decoder_config.is_decoder = True

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:104:27
103	        try:
104	            self.decoder = AutoModelForCausalLM.from_pretrained(decoder_name_or_path, **kwargs_decoder)
105	        except ValueError as e:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/losses/DenoisingAutoEncoderLoss.py:116:15
115	
116	        if len(AutoTokenizer.from_pretrained(encoder_name_or_path)) != len(self.tokenizer_encoder):
117	            logger.warning(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/CLIPModel.py:24:21
23	
24	        self.model = transformers.CLIPModel.from_pretrained(model_name)
25	        self.processor = transformers.CLIPProcessor.from_pretrained(processor_name)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/CLIPModel.py:25:25
24	        self.model = transformers.CLIPModel.from_pretrained(model_name)
25	        self.processor = transformers.CLIPProcessor.from_pretrained(processor_name)
26	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/Transformer.py:102:25
101	            tokenizer_args["model_max_length"] = max_seq_length
102	        self.tokenizer = AutoTokenizer.from_pretrained(
103	            tokenizer_name_or_path if tokenizer_name_or_path is not None else model_name_or_path,
104	            cache_dir=cache_dir,
105	            **tokenizer_args,
106	        )
107	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/Transformer.py:162:15
161	
162	        return AutoConfig.from_pretrained(model_name_or_path, **config_args, cache_dir=cache_dir), False
163	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/Transformer.py:196:34
195	            else:
196	                self.auto_model = AutoModel.from_pretrained(
197	                    model_name_or_path, config=config, cache_dir=cache_dir, **model_args
198	                )
199	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/Transformer.py:221:26
220	        T5EncoderModel._keys_to_ignore_on_load_unexpected = ["decoder.*"]
221	        self.auto_model = T5EncoderModel.from_pretrained(
222	            model_name_or_path, config=config, cache_dir=cache_dir, **model_args
223	        )
224	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/Transformer.py:230:26
229	        MT5EncoderModel._keys_to_ignore_on_load_unexpected = ["decoder.*"]
230	        self.auto_model = MT5EncoderModel.from_pretrained(
231	            model_name_or_path, config=config, cache_dir=cache_dir, **model_args
232	        )
233	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/models/tokenizer/WordTokenizer.py:441:44
440	    def load(input_path: str):
441	        return TransformersTokenizerWrapper(AutoTokenizer.from_pretrained(input_path, use_fast=True))

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/SparseEncoder.py:1006:17
1005	
1006	        config = AutoConfig.from_pretrained(model_name_or_path, cache_dir=cache_folder, **config_kwargs)
1007	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:97:25
96	
97	        self.tokenizer = AutoTokenizer.from_pretrained(
98	            (tokenizer_name_or_path if tokenizer_name_or_path is not None else model_name_or_path),
99	            cache_dir=cache_dir,
100	            **tokenizer_args,
101	        )
102	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:149:15
148	
149	        return AutoConfig.from_pretrained(model_name_or_path, **config_args, cache_dir=cache_dir), False
150	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/models/MLMTransformer.py:178:30
177	
178	            self.auto_model = AutoModelForMaskedLM.from_pretrained(model_name_or_path, config=config, **model_args)
179	        elif backend == "onnx":

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/models/SparseStaticEmbedding.py:120:28
119	
120	                json_path = hf_hub_download(
121	                    repo_id=json_path,
122	                    filename="idf.json",
123	                    token=token,
124	                    cache_dir=cache_folder,
125	                    revision=revision,
126	                    local_files_only=local_files_only,
127	                )
128	            except ValueError:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/sparse_encoder/models/SparseStaticEmbedding.py:181:20
180	        # Load tokenizer
181	        tokenizer = AutoTokenizer.from_pretrained(
182	            model_name_or_path,
183	            subfolder=subfolder,
184	            token=token,
185	            cache_dir=cache_folder,
186	            revision=revision,
187	            local_files_only=local_files_only,
188	        )
189	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/util/file_io.py:96:15
95	    try:
96	        return hf_hub_download(
97	            model_name_or_path,
98	            filename=file_path.name,
99	            subfolder=file_path.parent.as_posix(),
100	            revision=revision,
101	            library_name="sentence-transformers",
102	            token=token,
103	            cache_dir=cache_folder,
104	            local_files_only=local_files_only,
105	        )
106	    except Exception:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/util/file_io.py:152:20
151	    try:
152	        repo_path = snapshot_download(**download_kwargs)
153	    except Exception:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/util/file_io.py:156:20
155	        download_kwargs["local_files_only"] = True
156	        repo_path = snapshot_download(**download_kwargs)
157	    return Path(repo_path, subfolder)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/sentence_transformers/util/file_io.py:177:10
176	
177	    req = requests.get(url, stream=True)
178	    if req.status_code != 200:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/command/bdist_rpm.py:357:14
356	
357	        out = os.popen(q_cmd)
358	        try:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/compilers/C/base.py:1120:27
1119	        expected = '"static", "shared", "dylib", "xcode_stub"'
1120	        if lib_type not in eval(expected):
1121	            raise ValueError(f"'lib_type' must be {expected}")

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/core.py:268:16
267	                code = f.read().replace(r'\r\n', r'\n')
268	                exec(code, g)
269	        finally:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_build_ext.py:115:45
114	                libz_so = sorted(libz_so, key=lambda lib_path: len(lib_path))
115	                shutil.copyfile(libz_so[-1], '/tmp/libxx_z.so')
116	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_build_ext.py:120:34
119	                    [xx_c],
120	                    library_dirs=['/tmp'],
121	                    libraries=['xx_z'],

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_build_ext.py:122:42
121	                    libraries=['xx_z'],
122	                    runtime_library_dirs=['/tmp'],
123	                )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_build_ext.py:145:22
144	        if sys.platform == 'linux' and copy_so:
145	            os.unlink('/tmp/libxx_z.so')
146	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_build_ext.py:182:23
181	                # Linked against a library in /tmp
182	                assert "/tmp" in rpaths
183	                # The import is the real test here

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o777 on file (exe).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_spawn.py:32:8
31	
32	        os.chmod(exe, 0o777)
33	        with pytest.raises(DistutilsExecError):

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o777 on file (exe).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_distutils/tests/test_spawn.py:44:8
43	
44	        os.chmod(exe, 0o777)
45	        spawn([exe])  # should work without any error

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_vendor/jaraco/context.py:63:14
62	    try:
63	        req = urllib.request.urlopen(url)
64	        with tarfile.open(fileobj=req, mode='r|*') as tf:

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_vendor/jaraco/context.py:65:12
64	        with tarfile.open(fileobj=req, mode='r|*') as tf:
65	            tf.extractall(path=target_dir, filter=strip_first_component)
66	        yield target_dir

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_vendor/jaraco/functools/__init__.py:522:27
521	                try:
522	                    return eval(use)
523	                except TypeError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_vendor/packaging/licenses/__init__.py:100:18
99	    try:
100	        invalid = eval(python_expression, globals(), locals())
101	    except Exception:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/_vendor/platformdirs/unix.py:179:29
178	                if not Path(path).exists():
179	                    path = f"/tmp/runtime-{getuid()}"  # noqa: S108
180	            else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/build_meta.py:317:12
316	        try:
317	            exec(code, locals())
318	        except SystemExit as e:

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b302-marshal
   Location: ./.venv/lib/python3.12/site-packages/setuptools/command/bdist_egg.py:383:11
382	    f.read(skip)
383	    code = marshal.load(f)
384	    f.close()

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/config/_validate_pyproject/formats.py:152:9
151	    context = ssl.create_default_context()
152	    with urlopen(url, context=context) as response:  # noqa: S310 (audit URLs)
153	        headers = Message()

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b302-marshal
   Location: ./.venv/lib/python3.12/site-packages/setuptools/depends.py:133:23
132	                f.read(8)  # skip magic & date
133	                code = marshal.load(f)
134	            elif kind == PY_FROZEN:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/launch.py:32:4
31	    code = compile(norm_script, script_name, 'exec')
32	    exec(code, namespace)
33	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/config/downloads/__init__.py:53:9
52	def download(url: str, dest: Path):
53	    with urlopen(url) as f:
54	        data = f.read()

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/environment.py:77:15
76	            stderr=_PIPE,
77	            shell=shell,
78	            env=env,
79	            encoding="utf-8",
80	        )
81	
82	        if isinstance(data_stream, tuple):
83	            data_stream = slice(*data_stream)
84	        data = proc.communicate()[data_stream]
85	    except OSError:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/integration/test_pip_install_sdist.py:174:9
173	    id_ = package if version is LATEST else f"{package}/{version}"
174	    with urlopen(f"https://pypi.org/pypi/{id_}/json") as f:
175	        metadata = json.load(f)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/integration/test_pip_install_sdist.py:187:9
186	def download(url, dest, md5_digest):
187	    with urlopen(url) as f:
188	        data = f.read()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/integration/test_pip_install_sdist.py:190:11
189	
190	    assert md5(data).hexdigest() == md5_digest
191	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/test_editable_install.py:449:8
448	        loc = {}
449	        exec(finder, loc, loc)
450	        loc["install"]()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/test_extern.py:15:4
14	def test_distribution_picklable():
15	    pickle.loads(pickle.dumps(Distribution()))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/test_virtualenv.py:33:12
32	        try:
33	            urlopen('https://pypi.org', timeout=1)
34	        except URLError:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o777 on file (runsh).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/setuptools/tests/test_wheel.py:626:12
625	            runsh = pathlib.Path(source_dir) / "script.sh"
626	            os.chmod(runsh, 0o777)
627	            subprocess.check_call(

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/setuptools/wheel.py:211:63
210	                    raw_req,
211	                    (req for req in reqs if for_extra(req) and eval(req, extra=extra)),
212	                )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/six.py:740:8
739	            _locs_ = _globs_
740	        exec("""exec _code_ in _globs_, _locs_""")
741	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/_loss/tests/test_loss.py:1310:21
1309	    pickled_loss = pickle.dumps(loss)
1310	    unpickled_loss = pickle.loads(pickled_loss)
1311	    assert loss(y_true=y_true, raw_prediction=raw_prediction) == approx(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/cluster/tests/test_dbscan.py:294:16
293	    s = pickle.dumps(obj)
294	    assert type(pickle.loads(s)) is obj.__class__
295	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/cluster/tests/test_spectral.py:71:21
70	
71	        model_copy = pickle.loads(pickle.dumps(model))
72	        assert model_copy.n_clusters == model.n_clusters

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/compose/tests/test_column_transformer.py:1469:22
1468	    selector = make_column_selector(dtype_include=[object])
1469	    selector_picked = pickle.loads(pickle.dumps(selector))
1470	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/_base.py:1512:16
1511	            try:
1512	                urlretrieve(remote.url, temp_file_path)
1513	                break

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/_lfw.py:121:12
120	        with tarfile.open(archive_path, "r:gz") as fp:
121	            tarfile_extractall(fp, path=lfw_home)
122	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/_openml.py:526:14
525	    with closing(gzip_file):
526	        md5 = hashlib.md5()
527	        for chunk in iter(lambda: gzip_file.read(4096), b""):

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b202_tarfile_unsafe_members.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/_twenty_newsgroups.py:85:8
84	    with tarfile.open(archive_path, "r:gz") as fp:
85	        tarfile_extractall(fp, path=target_dir)
86	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/_twenty_newsgroups.py:310:20
309	            uncompressed_content = codecs.decode(compressed_content, "zlib_codec")
310	            cache = pickle.loads(uncompressed_content)
311	        except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/tests/test_base.py:334:21
333	    bunch = Bunch(x="x")
334	    bunch_from_pkl = loads(dumps(bunch))
335	    bunch_from_pkl.x = "y"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/datasets/tests/test_base.py:349:21
348	    bunch.__dict__["key"] = "set from __dict__"
349	    bunch_from_pkl = loads(dumps(bunch))
350	    # After loading from pickle the __dict__ should have been ignored

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/ensemble/_hist_gradient_boosting/tests/test_gradient_boosting.py:1715:14
1714	    # bitness that than the platform it will be used to make predictions on:
1715	    new_clf = pickle.load(pickle_dump_with_different_bitness())
1716	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/ensemble/tests/test_forest.py:718:11
717	
718	    obj2 = pickle.loads(pickle_object)
719	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/ensemble/tests/test_weight_boosting.py:219:11
218	
219	    obj2 = pickle.loads(s)
220	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/ensemble/tests/test_weight_boosting.py:230:11
229	
230	    obj2 = pickle.loads(s)
231	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/externals/array_api_compat/cupy/fft.py:6:0
5	_n = {}
6	exec('from cupy.fft import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/externals/array_api_compat/cupy/linalg.py:6:0
5	_n = {}
6	exec('from cupy.linalg import *', _n)
7	del _n['__builtins__']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/externals/array_api_compat/dask/array/fft.py:6:0
5	_n = {}
6	exec('from dask.array.fft import *', _n)
7	for k in ("__builtins__", "Sequence", "annotations", "warnings"):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/externals/array_api_compat/dask/array/linalg.py:22:0
21	_n = {}
22	exec('from dask.array.linalg import *', _n)
23	for k in ('__builtins__', 'annotations', 'operator', 'warnings', 'Array'):

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sklearn/externals/array_api_compat/torch/__init__.py:12:4
11	        continue
12	    exec(f"{n} = torch.{n}")
13	del n

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/feature_extraction/tests/test_text.py:1045:15
1044	        s = pickle.dumps(orig)
1045	        copy = pickle.loads(s)
1046	        assert type(copy) == orig.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/feature_extraction/tests/test_text.py:1069:28
1068	    text = "J'ai mangé du kangourou  ce midi, c'était pas très bon."
1069	    roundtripped_function = pickle.loads(pickle.dumps(function))
1070	    expected = function(text)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/feature_extraction/tests/test_text.py:1095:23
1094	        cv = CountVectorizer(vocabulary=vocab_set)
1095	        unpickled_cv = pickle.loads(pickle.dumps(cv))
1096	        cv.fit(ALL_FOOD_DOCS)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/feature_extraction/tests/test_text.py:1124:23
1123	        cv = CountVectorizer(vocabulary=vocab_dict)
1124	        unpickled_cv = pickle.loads(pickle.dumps(cv))
1125	        cv.fit(ALL_FOOD_DOCS)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/feature_extraction/tests/test_text.py:1136:11
1135	    s = pickle.dumps(orig)
1136	    copy = pickle.loads(s)
1137	    assert type(copy) == orig.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/linear_model/tests/test_sgd.py:872:10
871	    # pickle and unpickle with sparse coef_
872	    clf = pickle.loads(pickle.dumps(clf))
873	    assert sp.issparse(clf.coef_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/metrics/tests/test_dist_metrics.py:258:14
257	        D1 = dm.pairwise(X)
258	        dm2 = pickle.loads(pickle.dumps(dm))
259	        D2 = dm2.pairwise(X)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/metrics/tests/test_dist_metrics.py:268:10
267	    D1 = dm.pairwise(X_bool)
268	    dm2 = pickle.loads(pickle.dumps(dm))
269	    D2 = dm2.pairwise(X_bool)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/metrics/tests/test_dist_metrics.py:327:20
326	    # DistanceMetric object is picklable
327	    euclidean_pkl = pickle.loads(pickle.dumps(euclidean))
328	    pyfunc_pkl = pickle.loads(pickle.dumps(pyfunc))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/metrics/tests/test_dist_metrics.py:328:17
327	    euclidean_pkl = pickle.loads(pickle.dumps(euclidean))
328	    pyfunc_pkl = pickle.loads(pickle.dumps(pyfunc))
329	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/metrics/tests/test_score_objects.py:443:23
442	    score1 = scorer(clf, X_test, y_test)
443	    unpickled_scorer = pickle.loads(pickle.dumps(scorer))
444	    score2 = unpickled_scorer(clf, X_test, y_test)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/model_selection/tests/test_search.py:1613:26
1612	    grid_search.fit(X, y)
1613	    grid_search_pickled = pickle.loads(pickle.dumps(grid_search))
1614	    assert_array_almost_equal(grid_search.predict(X), grid_search_pickled.predict(X))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/model_selection/tests/test_search.py:1620:28
1619	    random_search.fit(X, y)
1620	    random_search_pickled = pickle.loads(pickle.dumps(random_search))
1621	    assert_array_almost_equal(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/neighbors/tests/test_nearest_centroid.py:116:11
115	
116	    obj2 = pickle.loads(s)
117	    assert type(obj2) == obj.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/neighbors/tests/test_neighbors_tree.py:289:12
288	    s = pickle.dumps(tree1, protocol=protocol)
289	    tree2 = pickle.loads(s)
290	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/neighbors/tests/test_quad_tree.py:74:10
73	    s = pickle.dumps(tree, protocol=protocol)
74	    bt2 = pickle.loads(s)
75	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:500:24
499	        warnings.simplefilter("error")
500	        tree_restored = pickle.loads(tree_pickle)
501	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:532:8
531	    with pytest.warns(UserWarning, match=message) as warning_record:
532	        pickle.loads(tree_pickle_other)
533	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:560:8
559	    with pytest.warns(UserWarning, match=message):
560	        pickle.loads(tree_pickle_noversion)
561	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:574:12
573	
574	            pickle.loads(tree_pickle_noversion)
575	    finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:601:25
600	    serialized = pickle.dumps(estimator)
601	    estimator_restored = pickle.loads(serialized)
602	    assert estimator_restored.attribute_pickled == 5

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:642:25
641	    serialized = pickle.dumps(estimator)
642	    estimator_restored = pickle.loads(serialized)
643	    assert estimator_restored.attribute_pickled == 5

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_base.py:882:4
881	    # this should not raise
882	    pickle.loads(pickle.dumps(BaseEstimator()))
883	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tests/test_isotonic.py:388:10
387	    ir_ser = pickle.dumps(ir, pickle.HIGHEST_PROTOCOL)
388	    ir2 = pickle.loads(ir_ser)
389	    np.testing.assert_array_equal(ir.predict(x), ir2.predict(x))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tree/tests/test_tree.py:922:15
921	        serialized_object = pickle.dumps(est)
922	        est2 = pickle.loads(serialized_object)
923	        assert type(est2) == est.__class__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tree/tests/test_tree.py:1771:15
1770	    def _pickle_copy(obj):
1771	        return pickle.loads(pickle.dumps(obj))
1772	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tree/tests/test_tree.py:2075:14
2074	
2075	    new_clf = pickle.load(get_pickle_non_native_endianness())
2076	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tree/tests/test_tree.py:2169:14
2168	
2169	    new_clf = pickle.load(pickle_dump_with_different_bitness())
2170	    new_score = new_clf.score(X, y)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/tree/tests/test_tree.py:2317:20
2316	
2317	    splitter_back = pickle.loads(splitter_serialize)
2318	    assert splitter_back.max_features == max_features

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/estimator_checks.py:2429:30
2428	            assert b"_sklearn_version" in pickled_estimator
2429	        unpickled_estimator = pickle.loads(pickled_estimator)
2430	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/estimator_checks.py:3690:10
3689	    # pickle and unpickle with sparse coef_
3690	    est = pickle.loads(pickle.dumps(est))
3691	    assert sparse.issparse(est.coef_)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_deprecation.py:89:4
88	def test_pickle():
89	    pickle.loads(pickle.dumps(mock_function))
90	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_encode.py:140:18
139	    if pickle_uniques:
140	        uniques = pickle.loads(pickle.dumps(uniques))
141	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_encode.py:149:18
148	    if pickle_uniques:
149	        uniques = pickle.loads(pickle.dumps(uniques))
150	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_encode.py:159:18
158	    if pickle_uniques:
159	        uniques = pickle.loads(pickle.dumps(uniques))
160	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_encode.py:182:18
181	    if pickle_uniques:
182	        uniques = pickle.loads(pickle.dumps(uniques))
183	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sklearn/utils/tests/test_metaestimators.py:62:21
61	    pickled_bytes = pickle.dumps(est.available_func)
62	    unpickled_func = pickle.loads(pickled_bytes)
63	    assert unpickled_func() == return_value

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/__init__.py:47:15
46	    if debug_str in ('True', 'False'):
47	        return eval(debug_str)
48	    else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/abc.py:96:0
95	ns: dict[str, Any] = {}
96	exec('from sympy import *', ns)
97	_clash1: dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/benchmarks/bench_meijerint.py:249:8
248	        _t = time()
249	        exec(string)
250	        _t = time() - _t

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/codegen/tests/test_algorithms.py:81:4
80	    namespace = {}
81	    exec(py_mod, namespace, namespace)
82	    res = eval('newton(0.5)', namespace)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/codegen/tests/test_algorithms.py:82:10
81	    exec(py_mod, namespace, namespace)
82	    res = eval('newton(0.5)', namespace)
83	    assert abs(res - 0.865474033102) < 1e-12

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/codegen/tests/test_algorithms.py:170:12
169	            ns = namespace[k] = {}
170	            exec(v, ns, ns)
171	            root_find_b[k] = ns[f'{k}_b']

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_basic.py:325:8
324	    with warns_deprecated_sympy():
325	        exec(code)
326	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_singleton.py:57:4
56	    d = {}
57	    exec('from sympy import *', d)
58	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_sympify.py:549:4
548	    locals = {}
549	    exec("from sympy.abc import Q, C", locals)
550	    assert str(S('C&Q', locals)) == 'C & Q'

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:7:4
6	    ns = {"var": var, "raises": raises}
7	    eval("var('a')", ns)
8	    assert ns["a"] == Symbol("a")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:10:4
9	
10	    eval("var('b bb cc zz _x')", ns)
11	    assert ns["b"] == Symbol("b")

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:17:8
16	
17	    v = eval("var(['d', 'e', 'fg'])", ns)
18	    assert ns['d'] == Symbol('d')

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:30:9
29	    "raises(ValueError, lambda: var(''))"
30	    v2 = eval("var('q')", ns)
31	    v3 = eval("var('q p')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:31:9
30	    v2 = eval("var('q')", ns)
31	    v3 = eval("var('q p')", ns)
32	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:39:9
38	    ns = {"var": var}
39	    v1 = eval("var('x y z')", ns)
40	    v2 = eval("var('x,y,z')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:40:9
39	    v1 = eval("var('x y z')", ns)
40	    v2 = eval("var('x,y,z')", ns)
41	    v3 = eval("var('x,y z')", ns)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:41:9
40	    v2 = eval("var('x,y,z')", ns)
41	    v3 = eval("var('x,y z')", ns)
42	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:49:4
48	    ns = {"var": var}
49	    eval("var('x y', real=True)", ns)
50	    assert ns['x'].is_real and ns['y'].is_real

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:55:4
54	    ns = {"var": var, "Function": Function}
55	    eval("var('f', cls=Function)", ns)
56	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/core/tests/test_var.py:59:4
58	
59	    eval("var('g,h', cls=Function)", ns)
60	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/external/importtools.py:21:15
20	    if debug_str in ('True', 'False'):
21	        return eval(debug_str)
22	    else:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/external/tests/test_codegen.py:122:22
121	        for command in commands:
122	            retcode = subprocess.call(command, stdout=null, shell=True,
123	                    stderr=subprocess.STDOUT)
124	            if retcode != 0:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/external/tests/test_pythonmpq.py:97:15
96	        q = Q(2, 3)
97	        assert pickle.loads(pickle.dumps(q)) == q
98	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_commonmatrix.py:825:8
824	    try:
825	        eval('c = a @ b')
826	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_commonmatrix.py:864:8
863	    try:
864	        eval('c = 5 @ b')
865	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_commonmatrix.py:894:8
893	    try:
894	        eval('2 @ a')
895	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_commonmatrix.py:902:8
901	    try:
902	        eval('a @ 2')
903	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_matrices.py:209:8
208	    try:
209	        eval('c = a @ b')
210	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_matrices.py:248:8
247	    try:
248	        eval('c = 5 @ b')
249	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_matrixbase.py:506:8
505	    try:
506	        eval('2 @ a')
507	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_matrixbase.py:514:8
513	    try:
514	        eval('a @ 2')
515	    except SyntaxError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/matrices/tests/test_sparse.py:99:8
98	    try:
99	        eval('c = a @ b')
100	    except SyntaxError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/ast_parser.py:72:4
71	    global_dict = {}
72	    exec('from sympy import *', global_dict)
73	    try:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/ast_parser.py:79:11
78	    e = compile(a, "<string>", "eval")
79	    return eval(e, global_dict, local_dict)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/sympy_parser.py:905:11
904	    """
905	    expr = eval(
906	        code, global_dict, local_dict)  # take local objects in preference
907	    return expr

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/sympy_parser.py:1052:8
1051	        global_dict = {}
1052	        exec('from sympy import *', global_dict)
1053	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/tests/test_autolev.py:140:4
139	    l = {}
140	    exec(sympy_input, g, l)
141	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/parsing/tests/test_sympy_parser.py:156:4
155	    default_globals = {}
156	    exec('from sympy import *', default_globals)
157	    builtins_dict = vars(builtins)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:45:0
44	ENV: dict[str, Any] = {}
45	exec('from sympy import *', ENV)
46	exec('from sympy.physics.quantum import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:46:0
45	exec('from sympy import *', ENV)
46	exec('from sympy.physics.quantum import *', ENV)
47	exec('from sympy.physics.quantum.cg import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:47:0
46	exec('from sympy.physics.quantum import *', ENV)
47	exec('from sympy.physics.quantum.cg import *', ENV)
48	exec('from sympy.physics.quantum.spin import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:48:0
47	exec('from sympy.physics.quantum.cg import *', ENV)
48	exec('from sympy.physics.quantum.spin import *', ENV)
49	exec('from sympy.physics.quantum.hilbert import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:49:0
48	exec('from sympy.physics.quantum.spin import *', ENV)
49	exec('from sympy.physics.quantum.hilbert import *', ENV)
50	exec('from sympy.physics.quantum.qubit import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:50:0
49	exec('from sympy.physics.quantum.hilbert import *', ENV)
50	exec('from sympy.physics.quantum.qubit import *', ENV)
51	exec('from sympy.physics.quantum.qexpr import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:51:0
50	exec('from sympy.physics.quantum.qubit import *', ENV)
51	exec('from sympy.physics.quantum.qexpr import *', ENV)
52	exec('from sympy.physics.quantum.gate import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:52:0
51	exec('from sympy.physics.quantum.qexpr import *', ENV)
52	exec('from sympy.physics.quantum.gate import *', ENV)
53	exec('from sympy.physics.quantum.constants import *', ENV)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:53:0
52	exec('from sympy.physics.quantum.gate import *', ENV)
53	exec('from sympy.physics.quantum.constants import *', ENV)
54	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/quantum/tests/test_printing.py:62:11
61	    assert srepr(expr) == string
62	    assert eval(string, ENV) == expr
63	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/secondquant.py:1601:17
1600	        list_comp = "[%s %s %s]" % (tup_string, first_loop, other_loops)
1601	        result = eval(list_comp)
1602	        if self.n_particles == 1:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/units/tests/test_prefixes.py:85:11
84	def test_repr():
85	    assert eval(repr(kilo)) == kilo
86	    assert eval(repr(kibi)) == kibi

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/units/tests/test_prefixes.py:86:11
85	    assert eval(repr(kilo)) == kilo
86	    assert eval(repr(kibi)) == kibi

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/physics/vector/tests/test_frame.py:759:9
758	    A_C_N = A.dcm(N)
759	    N1 = pickle.loads(pickle.dumps(N))
760	    A1 = tuple(N1._dcm_dict.keys())[0]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/plotting/experimental_lambdify.py:268:8
267	        self.eval_str = eval_str
268	        exec("MYNEWLAMBDA = %s" % eval_str, namespace)
269	        self.lambda_func = namespace['MYNEWLAMBDA']

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/plotting/pygletplot/plot_axes.py:44:21
43	        try:
44	            stride = eval(stride)
45	        except TypeError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/plotting/pygletplot/plot_interval.py:27:27
26	                try:
27	                    args = eval(args[0])
28	                except TypeError:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/matrices/tests/test_domainmatrix.py:1366:11
1365	    dM = DomainMatrix({2: {2: ZZ(1)}, 4: {4: ZZ(1)}}, (5, 5), ZZ)
1366	    assert pickle.loads(pickle.dumps(dM)) == dM
1367	    dM = DomainMatrix([[ZZ(1), ZZ(2)], [ZZ(3), ZZ(4)]], (2, 2), ZZ)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/matrices/tests/test_domainmatrix.py:1368:11
1367	    dM = DomainMatrix([[ZZ(1), ZZ(2)], [ZZ(3), ZZ(4)]], (2, 2), ZZ)
1368	    assert pickle.loads(pickle.dumps(dM)) == dM
1369	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/monomials.py:401:8
400	        ns = {}
401	        exec(code, ns)
402	        return ns[name]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/polyconfig.py:61:39
60	            try:
61	                _current_config[key] = eval(value)
62	            except NameError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/ring_series.py:2011:17
2010	        series_inner = series_inner.set_ring(R)
2011	        series = eval(_convert_func[str(expr.func)])(series_inner,
2012	            R(a), prec)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:9:4
8	    ns = {'vring':vring, 'QQ':QQ}
9	    exec('R = vring("r", QQ)', ns)
10	    exec('assert r == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:10:4
9	    exec('R = vring("r", QQ)', ns)
10	    exec('assert r == R.gens[0]', ns)
11	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:12:4
11	
12	    exec('R = vring("rb rbb rcc rzz _rx", QQ)', ns)
13	    exec('assert rb == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:13:4
12	    exec('R = vring("rb rbb rcc rzz _rx", QQ)', ns)
13	    exec('assert rb == R.gens[0]', ns)
14	    exec('assert rbb == R.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:14:4
13	    exec('assert rb == R.gens[0]', ns)
14	    exec('assert rbb == R.gens[1]', ns)
15	    exec('assert rcc == R.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:15:4
14	    exec('assert rbb == R.gens[1]', ns)
15	    exec('assert rcc == R.gens[2]', ns)
16	    exec('assert rzz == R.gens[3]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:16:4
15	    exec('assert rcc == R.gens[2]', ns)
16	    exec('assert rzz == R.gens[3]', ns)
17	    exec('assert _rx == R.gens[4]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:17:4
16	    exec('assert rzz == R.gens[3]', ns)
17	    exec('assert _rx == R.gens[4]', ns)
18	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:19:4
18	
19	    exec('R = vring(["rd", "re", "rfg"], QQ)', ns)
20	    exec('assert rd == R.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:20:4
19	    exec('R = vring(["rd", "re", "rfg"], QQ)', ns)
20	    exec('assert rd == R.gens[0]', ns)
21	    exec('assert re == R.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:21:4
20	    exec('assert rd == R.gens[0]', ns)
21	    exec('assert re == R.gens[1]', ns)
22	    exec('assert rfg == R.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:22:4
21	    exec('assert re == R.gens[1]', ns)
22	    exec('assert rfg == R.gens[2]', ns)
23	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:26:4
25	    ns = {'vfield':vfield, 'QQ':QQ}
26	    exec('F = vfield("f", QQ)', ns)
27	    exec('assert f == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:27:4
26	    exec('F = vfield("f", QQ)', ns)
27	    exec('assert f == F.gens[0]', ns)
28	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:29:4
28	
29	    exec('F = vfield("fb fbb fcc fzz _fx", QQ)', ns)
30	    exec('assert fb == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:30:4
29	    exec('F = vfield("fb fbb fcc fzz _fx", QQ)', ns)
30	    exec('assert fb == F.gens[0]', ns)
31	    exec('assert fbb == F.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:31:4
30	    exec('assert fb == F.gens[0]', ns)
31	    exec('assert fbb == F.gens[1]', ns)
32	    exec('assert fcc == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:32:4
31	    exec('assert fbb == F.gens[1]', ns)
32	    exec('assert fcc == F.gens[2]', ns)
33	    exec('assert fzz == F.gens[3]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:33:4
32	    exec('assert fcc == F.gens[2]', ns)
33	    exec('assert fzz == F.gens[3]', ns)
34	    exec('assert _fx == F.gens[4]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:34:4
33	    exec('assert fzz == F.gens[3]', ns)
34	    exec('assert _fx == F.gens[4]', ns)
35	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:36:4
35	
36	    exec('F = vfield(["fd", "fe", "ffg"], QQ)', ns)
37	    exec('assert fd == F.gens[0]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:37:4
36	    exec('F = vfield(["fd", "fe", "ffg"], QQ)', ns)
37	    exec('assert fd == F.gens[0]', ns)
38	    exec('assert fe == F.gens[1]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:38:4
37	    exec('assert fd == F.gens[0]', ns)
38	    exec('assert fe == F.gens[1]', ns)
39	    exec('assert ffg == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_injections.py:39:4
38	    exec('assert fe == F.gens[1]', ns)
39	    exec('assert ffg == F.gens[2]', ns)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/polys/tests/test_polytools.py:3960:19
3959	    poly = Poly(x + y, x, y, z)
3960	    deserialized = pickle.loads(pickle.dumps(poly))
3961	    assert poly == deserialized, (

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:43:4
42	    l = lambdarepr(p)
43	    eval(h + l)
44	    assert l == "((x) if (x < 0) else None)"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:52:4
51	    l = lambdarepr(p)
52	    eval(h + l)
53	    assert l == "((1) if (x < 1) else (2) if (x < 2) else (0))"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:60:4
59	    l = lambdarepr(p)
60	    eval(h + l)
61	    assert l == "((1) if (x < 1) else (2) if (x < 2) else None)"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:69:4
68	    l = lambdarepr(p)
69	    eval(h + l)
70	    assert l == "((x) if (x < 1) else (x**2) if (((x <= 4)) and ((x > 3))) else (0))"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:79:4
78	    l = lambdarepr(p)
79	    eval(h + l)
80	    assert l == "((x**2) if (x < 0) else (x) if (x < 1)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:89:4
88	    l = lambdarepr(p)
89	    eval(h + l)
90	    assert l == "((x**2) if (x < 0) else (x) if (x < 1)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:102:4
101	    l = lambdarepr(p)
102	    eval(h + l)
103	    assert l == "((1) if (x >= 1) else (2) if (x >= 2) else (3) if (x >= 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:115:4
114	    l = lambdarepr(p)
115	    eval(h + l)
116	    assert l == "((1) if (x <= 1) else (2) if (x <= 2) else (3) if (x <= 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:128:4
127	    l = lambdarepr(p)
128	    eval(h + l)
129	    assert l =="((1) if (x > 1) else (2) if (x > 2) else (3) if (x > 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:141:4
140	    l = lambdarepr(p)
141	    eval(h + l)
142	    assert l == "((1) if (x < 1) else (2) if (x < 2) else (3) if (x < 3)"\

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_lambdarepr.py:153:4
152	    l = lambdarepr(p)
153	    eval(h + l)
154	    assert l == "((((1) if (x > 0) else (2))) if (y > 0) else (3))"

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_latex.py:3139:11
3138	    import pickle
3139	    assert pickle.loads(pickle.dumps(latex)) is latex
3140	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:33:0
32	ENV: dict[str, Any] = {"Str": Str}
33	exec("from sympy import *", ENV)
34	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:47:8
46	        ENV2 = ENV.copy()
47	        exec(import_stmt, ENV2)
48	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:50:11
49	    assert srepr(expr, **kwargs) == string
50	    assert eval(string, ENV2) == expr
51	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:72:15
71	        expr = op(*symbols('x:256'))
72	        assert eval(srepr(expr)) == expr
73	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:184:11
183	    assert srepr(x) in (s1, s2)
184	    assert eval(srepr(x), ENV) == x
185	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_repr.py:206:16
205	    d = Dummy('d', nonzero=True)
206	    assert d == eval(srepr(d))
207	    s1 = "Dummy('d', dummy_index=%s, nonzero=True)" % str(d.dummy_index)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_tensorflow.py:55:28
54	    with graph.as_default():
55	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
56	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_tensorflow.py:87:28
86	    with graph.as_default():
87	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
88	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_tensorflow.py:115:28
114	    with graph.as_default():
115	        random_variables = [eval(tensorflow_code(i)) for i in random_matrices]
116	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_tensorflow.py:132:18
131	    with graph.as_default():
132	        tf_rvs = [eval(tensorflow_code(i)) for i in rvs]
133	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/printing/tests/test_tensorflow.py:148:18
147	    with graph.as_default():
148	        tf_rvs = [eval(tensorflow_code(i)) for i in rvs]
149	        session = tf.compat.v1.Session(graph=graph)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/testing/runtests.py:1243:16
1242	                code = compile(source, filename, "exec", flags=0, dont_inherit=True)
1243	                exec(code, gl)
1244	            except (SystemExit, KeyboardInterrupt):

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/_compilation/runners.py:191:12
190	        p = subprocess.Popen(' '.join(self.cmd()),
191	                             shell=True,
192	                             cwd=self.cwd,
193	                             stdin=subprocess.PIPE,
194	                             stdout=subprocess.PIPE,
195	                             stderr=subprocess.STDOUT,
196	                             env=env)
197	        comm = p.communicate()
198	        try:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/lambdify.py:163:21
162	        if import_command.startswith('import_module'):
163	            module = eval(import_command)
164	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/lambdify.py:170:16
169	            try:
170	                exec(import_command, {}, namespace)
171	                continue

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/lambdify.py:903:20
902	                try:
903	                    exec(ln, {}, namespace)
904	                except ImportError:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/lambdify.py:909:20
908	                    ln = "%s = %s.%s" % (k, mod, k)
909	                    exec(ln, {}, namespace)
910	                imp_mod_lines.append(ln)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/lambdify.py:920:4
919	    c = compile(funcstr, filename, 'exec')
920	    exec(c, namespace, funclocals)
921	    # mtime has to be None or else linecache.checkcache will remove it

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/matchpy_connector.py:269:8
268	    def _get_lambda(self, lambda_str: str) -> Callable[..., Expr]:
269	        exec("from sympy import *")
270	        return eval(lambda_str, locals())

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/matchpy_connector.py:270:15
269	        exec("from sympy import *")
270	        return eval(lambda_str, locals())
271	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_lambdify.py:1521:11
1520	    assert lambdify((f, fx), f + fx)(10, 5) == 15
1521	    assert eval(lambdastr((f, fx), f/fx))(10, 5) == 2
1522	    raises(Exception, lambda:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_lambdify.py:1523:8
1522	    raises(Exception, lambda:
1523	        eval(lambdastr((f, fx), f/fx, dummify=False)))
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_lambdify.py:1524:11
1523	        eval(lambdastr((f, fx), f/fx, dummify=False)))
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1525	    assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_lambdify.py:1525:11
1524	    assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1525	    assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half
1526	    assert lambdify(fx, 1 + fx)(41) == 42

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_lambdify.py:1527:11
1526	    assert lambdify(fx, 1 + fx)(41) == 42
1527	    assert eval(lambdastr(fx, 1 + fx, dummify=True))(41) == 42
1528	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_matchpy_connector.py:151:9
150	    a1 = WildDot("a")
151	    a2 = pickle.loads(pickle.dumps(a1))
152	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_matchpy_connector.py:155:9
154	    a1 = WildDot("a", S(1))
155	    a2 = pickle.loads(pickle.dumps(a1))
156	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_matchpy_connector.py:159:9
158	    a1 = WildPlus("a", S(1))
159	    a2 = pickle.loads(pickle.dumps(a1))
160	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_matchpy_connector.py:163:9
162	    a1 = WildStar("a", S(1))
163	    a2 = pickle.loads(pickle.dumps(a1))
164	    assert a1 == a2

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_pickling.py:74:16
73	        else:
74	            b = pickle.loads(pickle.dumps(a, protocol))
75	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_pickling.py:197:26
196	    copiers = [copy.copy, copy.deepcopy]
197	    copiers += [lambda x: pickle.loads(pickle.dumps(x, proto))
198	            for proto in protocols]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_pickling.py:712:11
711	def test_issue_18438():
712	    assert pickle.loads(pickle.dumps(S.Half)) == S.Half
713	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/sympy/utilities/tests/test_pickling.py:723:11
722	    )
723	    assert pickle.loads(data) == sqrt(2)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/threadpoolctl.py:1286:8
1285	    if options.command:
1286	        exec(options.command)
1287	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/aot_compile.py:78:27
77	        if self._artifacts.guard_manager is None:
78	            guards_state = pickle.loads(self._artifacts.guards_state)
79	            self._artifacts.guard_manager = torch._dynamo.guards.CheckFunctionManager(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/aot_compile.py:117:16
116	
117	        state = pickle.loads(data)
118	        state["bytecode"] = SerializedCode.to_code_object(state["bytecode"])

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py:458:14
457	        profile_path = Path(
458	            f"/tmp/{func.__name__}_{str(trace_id).replace('/', '_')}.profile"
459	        )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:1744:8
1743	        guards_log.debug("Python shape guard function:\n%s", pycode)
1744	        exec(pycode, globals_for_guard_fn, out)
1745	        guard_fn = out["___make_guard_fn"](*closure_vars.values())

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:1765:15
1764	            closure_vars = _get_closure_vars()
1765	        return eval(name, self.scope, closure_vars)
1766	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:2671:23
2670	                )
2671	                clib = CppCodeCache.load(func_str)
2672	                cguard = ctypes.cast(clib.guard, ctypes.c_void_p).value

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:4012:23
4011	        global_scope["__compile_source__"] = tensor_source
4012	        tensor_id = id(eval(tensor_source, global_scope, scope))
4013	        ids_to_source[tensor_id].append(tensor_source)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:4085:34
4084	                try:
4085	                    fail_reason = eval(part, global_scope, scope)
4086	                except Exception:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/guards.py:4242:12
4241	        try:
4242	            eval(guard, guard_manager.global_scope, local_scope)
4243	        except:  # noqa: B001,E722

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/package.py:293:15
292	    def after_deserialization(self) -> _DynamoCacheEntry:
293	        return pickle.loads(self.content)
294	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/package.py:642:35
641	                for guarded_code in entry.guarded_codes:
642	                    guards_state = pickle.loads(guarded_code.guards_state)
643	                    runtime_global_scope = sys.modules[entry.python_module].__dict__

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/package.py:695:15
694	    def after_deserialization(self) -> Any:
695	        return pickle.loads(self.content)
696	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/package.py:886:30
885	            with open(os.path.join(path, "dynamo"), "rb") as dynamo_path:
886	                cache_entry = pickle.load(dynamo_path)
887	            with open(os.path.join(path, "backends"), "rb") as backend_path:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/package.py:888:34
887	            with open(os.path.join(path, "backends"), "rb") as backend_path:
888	                backend_content = pickle.load(backend_path)
889	            return cache_entry, backend_content

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/pgo.py:740:34
739	                    content = f.read()
740	                    _CODE_STATE = pickle.loads(content)
741	                    CompileEventLogger.pt2_compile(name, cache_size_bytes=f.tell())

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/pgo.py:775:29
774	                    )
775	                code_state = pickle.loads(payload)
776	            except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/replay_record.py:62:15
61	        assert dill is not None, "replay_record requires `pip install dill`"
62	        return dill.load(f)
63	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/test_minifier_common.py:150:24
149	                    with patch("sys.argv", args), report_compile_source_on_error():
150	                        exec(code, {"__name__": "__main__", "__compile_source__": code})
151	                    rc = 0

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/utils.py:2387:9
2386	    rotated = reversed(vars[-1:] + vars[:-1])
2387	    fn = eval(f"lambda {','.join(vars)}: ({','.join(rotated)})")
2388	    fn.__name__ = f"rot_{n}_helper"

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/variables/tensor.py:303:43
302	            # Which is incorrect, and violates the invariant that all sources should be eval()-able against the scope.
303	            _input_associated_real_value = eval(self.source.name(), scope)
304	        except Exception as exc:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_dynamo/variables/tensor.py:540:43
539	        try:
540	            _input_associated_real_value = eval(self.source.name(), scope)
541	        except Exception as exc:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_export/serde/serialize.py:423:15
422	    # weights_only=False as we want to load custom objects here (e.g. ScriptObject)
423	    artifact = torch.load(buffer, weights_only=False)
424	    assert isinstance(artifact, (tuple, dict))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/autograd_cache.py:1041:16
1040	    def after_deserialization(self) -> Callable:
1041	        entry = pickle.loads(self.content)
1042	        # In the precompile use case, guards are already serialized

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_functorch/compilers.py:313:22
312	    with open(input_data_path, "rb") as f:
313	        inputs_meta = pickle.load(f)
314	        inputs = []

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_higher_order_ops/triton_kernel_wrap.py:1040:8
1039	        namespace: dict[str, Any] = {}
1040	        exec(code, namespace)
1041	        grid_fn = namespace[fn_name]

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py:398:16
397	            return getattr(
398	                torch._inductor.codecache.PyCodeCache.load(source_code), kernel_name
399	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py:527:19
526	        if get_compile_threads() <= 1:
527	            return CppCodeCache.load(source_code).kernel
528	        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py:551:19
550	                CUDACodeCache.aot_kernels_o.append(output_path)
551	            return CUDACodeCache.load(source_code, dst_file_ext)[0]
552	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py:569:19
568	                _ = ROCmCodeCache.compile(source_code, dst_file_ext="exe")
569	            return ROCmCodeCache.load(source_code, dst_file_ext)[0]
570	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/autotune_process.py:104:15
103	    def recv(read_pipe: IO[bytes]) -> Any:
104	        return pickle.load(read_pipe)
105	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/autotune_process.py:802:56
801	        if self.DLL is None:
802	            self.DLL, self.hash_key, self.source_file = CUDACodeCache.load(
803	                self.source_code, "so"
804	            )
805	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/autotune_process.py:837:8
836	        autotuning_log.debug("Precompiling %s", self)
837	        CppCodeCache.load(self.source_code, device_type="cpu")
838	        autotuning_log.debug("Done precompiling %s", self)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/autotune_process.py:844:19
843	        # TODO(jgong5): use CppPythonBindingsCodeCache for better binding perf
844	        self.DLL = CppCodeCache.load(self.source_code, device_type="cpu")
845	        args = [tensor.data_ptr() for tensor in list(input_tensors) + [out]]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codecache.py:1019:34
1018	                            content = f.read()
1019	                            yield pickle.loads(content), content
1020	                    except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codecache.py:1033:26
1032	                    content = base64.b64decode(data)
1033	                    yield pickle.loads(content), content
1034	            except Exception:

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codegen/common.py:2322:15
2321	
2322	        return jinja2.Environment(
2323	            undefined=jinja2.StrictUndefined,
2324	        )
2325	    except ImportError:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codegen/debug_utils.py:208:34
207	                cwd = os.getcwd()
208	                saved_dir = cwd + "/tmp/jit_inductor/"
209	                if not os.path.exists(saved_dir):

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codegen/rocm/rocm_benchmark_request.py:133:56
132	        if self.DLL is None:
133	            self.DLL, self.hash_key, self.source_file = ROCmCodeCache.load(
134	                self.source_code, "so"
135	            )
136	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codegen/wrapper.py:1693:12
1692	        try:
1693	            exec(tuning_code, scope)
1694	        except Exception as e:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/codegen/wrapper_fxir.py:208:14
207	        module_code = "\n".join([self.prologue, code])
208	        mod = PyCodeCache.load(module_code)
209	        kernel = getattr(mod, kernel_name)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/comm_analysis.py:186:9
185	
186	    fn = eval(py_kernel_name)
187	    args, kwargs = snode_args_kwargs(snode)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/compile_fx_ext.py:663:17
662	
663	        name = f"/tmp/aorenste/pytorch_compile_fx_tmp_input_{idx}.bin"
664	        with open(name, "wb") as f:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/compile_fx_ext.py:669:21
668	        if False:
669	            name = f"/tmp/aorenste/pytorch_compile_fx_tmp_actual_{idx}.bin"
670	            actual = self._run_in_child(pickled_input)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/compile_fx_ext.py:675:21
674	        elif False:
675	            name = f"/tmp/aorenste/pytorch_compile_fx_tmp_output_{idx}.bin"
676	            with open(name, "rb") as f:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/compile_worker/subproc_pool.py:114:15
113	    def loads(self, data: bytes) -> object:
114	        return pickle.loads(data)
115	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/compiler_bisector.py:288:31
287	            key, value = line.strip().split("=", 1)
288	            config_data[key] = eval(value)
289	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (output_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/cpp_builder.py:2000:24
1999	                    elif output_path.endswith(".so"):
2000	                        os.chmod(output_path, 0o755)
2001	            except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/debug.py:1177:13
1176	
1177	    folder = "/tmp/inductor_saved_args"
1178	    if not os.path.exists(folder):

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/debug.py:1220:23
1219	    with open(path, "rb") as f:
1220	        args, kwargs = pickle.load(f)
1221	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/fuzzer.py:728:20
727	        with open(filename, "rb") as f:
728	            state = pickle.load(f)
729	            self.results = state["results"]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/ops_handler.py:789:8
788	        ctx: dict[str, Any] = {}
789	        exec(code.getvalue(), ctx)
790	        for target, impl in ctx.items():

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/cache_dir_utils.py:25:54
24	    return os.path.join(
25	        tempfile.gettempdir() if not is_fbcode() else "/var/tmp",
26	        "torchinductor_" + sanitized_username,

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/compile_tasks.py:33:8
32	        mod.key = key  # type: ignore[attr-defined]
33	        exec(code, mod.__dict__, mod.__dict__)
34	        if set_sys_modules:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/triton_heuristics.py:1390:8
1389	        launcher_code = "\n".join(lines)
1390	        exec(launcher_code, scope)
1391	        return scope["launcher"]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/triton_heuristics.py:3205:12
3204	        for line in self.prefix:
3205	            exec(line, scope)
3206	        exec(f"grid_0 = {self.x_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/triton_heuristics.py:3206:8
3205	            exec(line, scope)
3206	        exec(f"grid_0 = {self.x_grid}", scope)
3207	        exec(f"grid_1 = {self.y_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/triton_heuristics.py:3207:8
3206	        exec(f"grid_0 = {self.x_grid}", scope)
3207	        exec(f"grid_1 = {self.y_grid}", scope)
3208	        exec(f"grid_2 = {self.z_grid}", scope)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/runtime/triton_heuristics.py:3208:8
3207	        exec(f"grid_1 = {self.y_grid}", scope)
3208	        exec(f"grid_2 = {self.z_grid}", scope)
3209	        return scope["grid_0"], scope["grid_1"], scope["grid_2"]

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/scheduler.py:3260:18
3259	            )
3260	            mod = PyCodeCache.load(src_code)
3261	            if not async_compile.use_process_pool():

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/select_algorithm.py:1273:15
1272	
1273	        return jinja2.Environment(
1274	            undefined=jinja2.StrictUndefined,
1275	        )
1276	    except ImportError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/select_algorithm.py:2033:20
2032	        tile = info["tile_shape"]
2033	        tile_vals = eval(tile)  # type: ignore[arg-type]
2034	        BLOCK_M = tile_vals[0]

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/select_algorithm.py:3257:24
3256	
3257	            tile_vals = eval(tile)  # type: ignore[arg-type]
3258	            BLOCK_M = tile_vals[0]

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py:112:40
111	                            with open(os.path.join(subdir, path), "rb") as f:
112	                                graph = pickle.load(f)
113	                            output_file = graph.write_to_disk()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/utils.py:646:4
645	    ctx = {"fn": fn}
646	    exec(
647	        f"""\
648	        def {name}_cache_on_self(self):
649	            try:
650	                return self.{key}
651	            except AttributeError:
652	                pass
653	            rv = fn(self)
654	            object.__setattr__(self, "{key}", rv)
655	            return rv
656	        """.lstrip(),
657	        ctx,
658	    )
659	    wrapper = functools.wraps(fn)(ctx[f"{name}_cache_on_self"])

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_inductor/utils.py:689:8
688	        ctx = {"fn": fn}
689	        exec(
690	            f"""\
691	            def inner(self: Any, *args: P.args, **kwargs: P.kwargs) -> RV:
692	                args_kwargs = (args, tuple(sorted(kwargs.items())))
693	
694	                if not hasattr(self, "{key}"):
695	                    object.__setattr__(self, "{key}", {{}})
696	
697	                cache = self.{key}
698	
699	                try:
700	                    return cache[args_kwargs]
701	                except KeyError:
702	                    pass
703	
704	                rv = fn(self, *args, **kwargs)
705	
706	                cache[args_kwargs] = rv
707	                return rv
708	            """.lstrip(),
709	            ctx,
710	        )
711	        inner = functools.wraps(fn)(ctx["inner"])

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/_library/infer_schema.py:73:19
72	        try:
73	            return eval(annotation_type, pf_globals, pf_locals)
74	        except Exception:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/_tensor_docs.py:2519:4
2518	    "index_reduce_",
2519	    r"""
2520	index_reduce_(dim, index, source, reduce, *, include_self=True) -> Tensor
2521	
2522	Accumulate the elements of ``source`` into the :attr:`self`
2523	tensor by accumulating to the indices in the order given in :attr:`index`
2524	using the reduction given by the ``reduce`` argument. For example, if ``dim == 0``,
2525	``index[i] == j``, ``reduce == prod`` and ``include_self == True`` then the ``i``\ th
2526	row of ``source`` is multiplied by the ``j``\ th row of :attr:`self`. If
2527	:obj:`include_self="True"`, the values in the :attr:`self` tensor are included
2528	in the reduction, otherwise, rows in the :attr:`self` tensor that are accumulated
2529	to are treated as if they were filled with the reduction identities.
2530	
2531	The :attr:`dim`\ th dimension of ``source`` must have the same size as the
2532	length of :attr:`index` (which must be a vector), and all other dimensions must
2533	match :attr:`self`, or an error will be raised.
2534	
2535	For a 3-D tensor with :obj:`reduce="prod"` and :obj:`include_self=True` the
2536	output is given as::
2537	
2538	    self[index[i], :, :] *= src[i, :, :]  # if dim == 0
2539	    self[:, index[i], :] *= src[:, i, :]  # if dim == 1
2540	    self[:, :, index[i]] *= src[:, :, i]  # if dim == 2
2541	
2542	Note:
2543	    {forward_reproducibility_note}
2544	
2545	.. note::
2546	
2547	    This function only supports floating point tensors.
2548	
2549	.. warning::
2550	
2551	    This function is in beta and may change in the near future.
2552	
2553	Args:
2554	    dim (int): dimension along which to index
2555	    index (Tensor): indices of ``source`` to select from,
2556	        should have dtype either `torch.int64` or `torch.int32`
2557	    source (FloatTensor): the tensor containing values to accumulate
2558	    reduce (str): the reduction operation to apply
2559	        (:obj:`"prod"`, :obj:`"mean"`, :obj:`"amax"`, :obj:`"amin"`)
2560	
2561	Keyword args:
2562	    include_self (bool): whether the elements from the ``self`` tensor are
2563	        included in the reduction
2564	
2565	Example::
2566	
2567	    >>> x = torch.empty(5, 3).fill_(2)
2568	    >>> t = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]], dtype=torch.float)
2569	    >>> index = torch.tensor([0, 4, 2, 0])
2570	    >>> x.index_reduce_(0, index, t, 'prod')
2571	    tensor([[20., 44., 72.],
2572	            [ 2.,  2.,  2.],
2573	            [14., 16., 18.],
2574	            [ 2.,  2.,  2.],
2575	            [ 8., 10., 12.]])
2576	    >>> x = torch.empty(5, 3).fill_(2)
2577	    >>> x.index_reduce_(0, index, t, 'prod', include_self=False)
2578	    tensor([[10., 22., 36.],
2579	            [ 2.,  2.,  2.],
2580	            [ 7.,  8.,  9.],
2581	            [ 2.,  2.,  2.],
2582	            [ 4.,  5.,  6.]])
2583	""".format(**reproducibility_notes),
2584	)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/torch/cuda/_memory_viz.py:101:12
100	        with tempfile.NamedTemporaryFile(mode="wb", suffix=".pl") as f:
101	            urllib.request.urlretrieve(
102	                "https://raw.githubusercontent.com/brendangregg/FlameGraph/master/flamegraph.pl",
103	                f.name,
104	            )
105	            try:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (name).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b103_set_bad_file_permissions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/cuda/_memory_viz.py:106:16
105	            try:
106	                os.chmod(f.name, 0o755)
107	                os.rename(f.name, flamegraph_script)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/cuda/_memory_viz.py:708:15
707	            f = open(name, "rb")
708	        data = pickle.load(f)
709	        if isinstance(data, list):  # segments only...

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/_serialization.py:55:18
54	    def read_from(self, f: BufferedIOBase) -> None:
55	        entries = _weights_only_unpickler.load(f)
56	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/_symmetric_memory/_nvshmem_triton.py:1158:53
1157	            for kernel in triton_kernels:
1158	                with tempfile.NamedTemporaryFile(dir="/tmp", delete=False) as f:
1159	                    f.write(kernel.asm["ptx"].encode("utf-8"))

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/_tools/memory_tracker.py:221:20
220	        with open(path, "rb") as f:
221	            stats = pickle.load(f)
222	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/_experimental/checkpoint_reader.py:81:16
80	            result: tuple[STATE_DICT, list[str]] = (
81	                torch.load(file_path, map_location=map_location),
82	                [],

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/_experimental/checkpoint_reader.py:118:28
117	        with FakeTensorMode():
118	            metadata_dict = torch.load(file_path, map_location=map_location)
119	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/_pg_transport.py:303:31
302	
303	        meta: _StateDictMeta = pickle.loads(buf.cpu().numpy().tobytes())
304	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/default_planner.py:365:16
364	                self.mappings[read_item.dest_index.fqn],
365	                torch.load(value, weights_only=False),
366	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/default_planner.py:368:56
367	        else:
368	            self.state_dict[read_item.dest_index.fqn] = torch.load(
369	                value, weights_only=False
370	            )
371	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/filesystem.py:925:23
924	        with self.fs.create_stream(path, "rb") as metadata_file:
925	            metadata = pickle.load(metadata_file)
926	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/format_utils.py:87:31
86	            assert self.checkpoint_id is not None
87	            torch_state_dict = torch.load(
88	                self.checkpoint_id, map_location="cpu", weights_only=False
89	            )
90	            if planner.flatten_state_dict:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/checkpoint/format_utils.py:236:17
235	
236	    state_dict = torch.load(torch_save_path, weights_only=False)
237	    # we don't need stateful behavior here because the expectation is anything loaded by

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:173:37
172	            if watchdog_file_path is None:
173	                watchdog_file_path = "/tmp/watchdog_timer_" + str(uuid.uuid4())
174	            logger.info("Starting a FileTimerServer with %s ...", watchdog_file_path)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:443:30
442	            try:
443	                self._state = pickle.loads(state_bits)
444	            except pickle.PickleError as exc:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/nn/api/remote_module.py:734:8
733	    f = io.BytesIO(recursive_script_module_serialized)
734	    m = torch.jit.load(f)
735	    return m

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/optim/zero_redundancy_optimizer.py:113:14
112	        buffer = io.BytesIO(data_recv_tensor.cpu().numpy())
113	        obj = torch.load(buffer, map_location=device, weights_only=False)
114	    return obj

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/distributed/rpc/internal.py:84:12
83	        f = io.BytesIO(script_module_serialized)
84	        m = torch.jit.load(f)
85	        return m

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/export/_trace.py:365:24
364	
365	                        eval(path, {"L": {"self": Path()}})
366	                        return ".".join(parts)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/export/_unlift.py:147:4
146	    namespace = {**SYMPY_INTERP}
147	    exec(code_str, namespace)
148	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/export/pt2_archive/_package.py:766:41
765	                )
766	                state_dict[weight_fqn] = torch.load(
767	                    io.BytesIO(weight_bytes), weights_only=False
768	                )
769	            else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/export/pt2_archive/_package.py:820:46
819	                    )
820	                    constants[constant_fqn] = torch.load(
821	                        io.BytesIO(constant_bytes), weights_only=False
822	                    )
823	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/export/pt2_archive/_package.py:991:32
990	                weight_bytes = archive_reader.read_bytes(file)
991	                loaded_weight = torch.load(io.BytesIO(weight_bytes))
992	                weights[weight_file_name] = loaded_weight

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py:145:11
144	    argnames = ",".join(f"arg{i}" for i in range(nargs))
145	    return eval(f"lambda {argnames}: fn({argnames})", {"fn": fn})
146	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/experimental/rewriter.py:48:8
47	        keys_before = set(globals_dict.keys())
48	        exec(code, globals_dict)
49	        new_keys = list(set(globals_dict.keys()) - keys_before)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/experimental/symbolic_shapes.py:6019:15
6018	        args = {str(e): val for e, val in self.var_to_val.items()}
6019	        return eval(code, SYMPY_INTERP, args)
6020	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/experimental/symbolic_shapes.py:6029:15
6028	        }
6029	        return eval(code, SYMPY_INTERP, args)
6030	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/experimental/symbolic_shapes.py:6037:15
6036	        arg_names = [f"t{i}" for i in range(len(args))]
6037	        return eval(code, SYMPY_INTERP, {"L": dict(zip(arg_names, args))})
6038	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/graph_module.py:94:4
93	    key = _loader.cache(src, globals, co_fields)
94	    exec(compile(src, key, "exec"), globals)
95	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/fx/operator_schemas.py:93:11
92	    """
93	    return eval(ts_type.annotation_str, _type_eval_globals)
94	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/torch/hub.py:161:17
160	        try:
161	            with urlopen(f"https://github.com/{repo_owner}/{repo_name}/tree/main/"):
162	                ref = "main"

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/torch/hub.py:185:9
184	def _read_url(url):
185	    with urlopen(url) as r:
186	        return r.read().decode(r.headers.get_content_charset("utf-8"))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/torch/hub.py:717:8
716	    req = Request(url, headers={"User-Agent": "torch.hub"})
717	    u = urlopen(req)
718	    meta = u.info()

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/hub.py:807:11
806	        extracted_file = os.path.join(model_dir, extraced_name)
807	    return torch.load(
808	        extracted_file, map_location=map_location, weights_only=weights_only
809	    )
810	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/hub.py:880:11
879	        return _legacy_zip_load(cached_file, model_dir, map_location, weights_only)
880	    return torch.load(cached_file, map_location=map_location, weights_only=weights_only)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/jit/annotations.py:209:11
208	            )
209	    return eval(bytecode, glob, loc)  # type: ignore[arg-type] # noqa: P204
210	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/jit/frontend.py:589:4
588	    g = copy.copy(globals())
589	    exec(ignore_func_str, g)  # noqa: P204
590	    # registers the custom function in the global context

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/jit/unsupported_tensor_ops.py:9:4
8	def execWrapper(code, glob, loc):
9	    exec(code, glob, loc)
10	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/multiprocessing/queue.py:21:15
20	        buf = self.recv_bytes()
21	        return pickle.loads(buf)
22	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/multiprocessing/spawn.py:217:29
216	        with open(self.error_files[error_index], "rb") as fh:
217	            original_trace = pickle.load(fh)
218	        msg = f"\n\n-- Process {error_index:d} terminated with the following error:\n"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/nn/modules/conv.py:816:8
815	    __doc__ = (
816	        r"""Applies a 1D transposed convolution operator over an input image
817	    composed of several input planes.
818	
819	    This module can be seen as the gradient of Conv1d with respect to its input.
820	    It is also known as a fractionally-strided convolution or
821	    a deconvolution (although it is not an actual deconvolution operation as it does
822	    not compute a true inverse of convolution). For more information, see the visualizations
823	    `here`_ and the `Deconvolutional Networks`_ paper.
824	
825	    This module supports :ref:`TensorFloat32<tf32_on_ampere>`.
826	
827	    On certain ROCm devices, when using float16 inputs this module will use :ref:`different precision<fp16_on_mi200>` for backward.
828	
829	    * :attr:`stride` controls the stride for the cross-correlation.
830	
831	    * :attr:`padding` controls the amount of implicit zero padding on both
832	      sides for ``dilation * (kernel_size - 1) - padding`` number of points. See note
833	      below for details.
834	
835	    * :attr:`output_padding` controls the additional size added to one side
836	      of the output shape. See note below for details.
837	"""
838	        """
839	    * :attr:`dilation` controls the spacing between the kernel points; also known as the \u00e0 trous algorithm.
840	      It is harder to describe, but the link `here`_ has a nice visualization of what :attr:`dilation` does.
841	"""
842	        r"""
843	    {groups_note}
844	
845	    Note:
846	        The :attr:`padding` argument effectively adds ``dilation * (kernel_size - 1) - padding``
847	        amount of zero padding to both sizes of the input. This is set so that
848	        when a :class:`~torch.nn.Conv1d` and a :class:`~torch.nn.ConvTranspose1d`
849	        are initialized with same parameters, they are inverses of each other in
850	        regard to the input and output shapes. However, when ``stride > 1``,
851	        :class:`~torch.nn.Conv1d` maps multiple input shapes to the same output
852	        shape. :attr:`output_padding` is provided to resolve this ambiguity by
853	        effectively increasing the calculated output shape on one side. Note
854	        that :attr:`output_padding` is only used to find output shape, but does
855	        not actually add zero-padding to output.
856	
857	    Note:
858	        In some circumstances when using the CUDA backend with CuDNN, this operator
859	        may select a nondeterministic algorithm to increase performance. If this is
860	        undesirable, you can try to make the operation deterministic (potentially at
861	        a performance cost) by setting ``torch.backends.cudnn.deterministic =
862	        True``.
863	        Please see the notes on :doc:`/notes/randomness` for background.
864	
865	
866	    Args:
867	        in_channels (int): Number of channels in the input image
868	        out_channels (int): Number of channels produced by the convolution
869	        kernel_size (int or tuple): Size of the convolving kernel
870	        stride (int or tuple, optional): Stride of the convolution. Default: 1
871	        padding (int or tuple, optional): ``dilation * (kernel_size - 1) - padding`` zero-padding
872	            will be added to both sides of the input. Default: 0
873	        output_padding (int or tuple, optional): Additional size added to one side
874	            of the output shape. Default: 0
875	        groups (int, optional): Number of blocked connections from input channels to output channels. Default: 1
876	        bias (bool, optional): If ``True``, adds a learnable bias to the output. Default: ``True``
877	        dilation (int or tuple, optional): Spacing between kernel elements. Default: 1
878	    """.format(**reproducibility_notes, **convolution_notes)
879	        + r"""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/nn/modules/rnn.py:636:18
635	            raise ValueError(
636	                f"Unknown nonlinearity '{self.nonlinearity}'. Select from 'tanh' or 'relu'."
637	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_compat.py:195:53
194	            )
195	            onnx_program = _onnx_program.ONNXProgram(ir.load(f), None)
196	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/optim/sgd.py:154:4
153	SGD.__doc__ = (
154	    r"""Implements stochastic gradient descent (optionally with momentum).
155	
156	    .. math::
157	       \begin{aligned}
158	            &\rule{110mm}{0.4pt}                                                                 \\
159	            &\textbf{input}      : \gamma \text{ (lr)}, \: \theta_0 \text{ (params)}, \: f(\theta)
160	                \text{ (objective)}, \: \lambda \text{ (weight decay)},                          \\
161	            &\hspace{13mm} \:\mu \text{ (momentum)}, \:\tau \text{ (dampening)},
162	            \:\textit{ nesterov,}\:\textit{ maximize}                                     \\[-1.ex]
163	            &\rule{110mm}{0.4pt}                                                                 \\
164	            &\textbf{for} \: t=1 \: \textbf{to} \: \ldots \: \textbf{do}                         \\
165	            &\hspace{5mm}\textbf{if} \: \textit{maximize}:                                       \\
166	            &\hspace{10mm}g_t           \leftarrow   -\nabla_{\theta} f_t (\theta_{t-1})         \\
167	            &\hspace{5mm}\textbf{else}                                                           \\
168	            &\hspace{10mm}g_t           \leftarrow   \nabla_{\theta} f_t (\theta_{t-1})          \\
169	            &\hspace{5mm}\textbf{if} \: \lambda \neq 0                                           \\
170	            &\hspace{10mm} g_t \leftarrow g_t + \lambda  \theta_{t-1}                            \\
171	            &\hspace{5mm}\textbf{if} \: \mu \neq 0                                               \\
172	            &\hspace{10mm}\textbf{if} \: t > 1                                                   \\
173	            &\hspace{15mm} \textbf{b}_t \leftarrow \mu \textbf{b}_{t-1} + (1-\tau) g_t           \\
174	            &\hspace{10mm}\textbf{else}                                                          \\
175	            &\hspace{15mm} \textbf{b}_t \leftarrow g_t                                           \\
176	            &\hspace{10mm}\textbf{if} \: \textit{nesterov}                                       \\
177	            &\hspace{15mm} g_t \leftarrow g_{t} + \mu \textbf{b}_t                               \\
178	            &\hspace{10mm}\textbf{else}                                                   \\[-1.ex]
179	            &\hspace{15mm} g_t  \leftarrow  \textbf{b}_t                                         \\
180	            &\hspace{5mm}\theta_t \leftarrow \theta_{t-1} - \gamma g_t                    \\[-1.ex]
181	            &\rule{110mm}{0.4pt}                                                          \\[-1.ex]
182	            &\bf{return} \:  \theta_t                                                     \\[-1.ex]
183	            &\rule{110mm}{0.4pt}                                                          \\[-1.ex]
184	       \end{aligned}
185	
186	    Nesterov momentum is based on the formula from
187	    `On the importance of initialization and momentum in deep learning`__.
188	    """
189	    + rf"""
190	    Args:
191	        {_params_doc}
192	        lr (float, Tensor, optional): learning rate (default: 1e-3)
193	        momentum (float, optional): momentum factor (default: 0)
194	        dampening (float, optional): dampening for momentum (default: 0)
195	        weight_decay (float, optional): weight decay (L2 penalty) (default: 0)
196	        nesterov (bool, optional): enables Nesterov momentum. Only applicable
197	            when momentum is non-zero. (default: False)
198	        {_maximize_doc}
199	        {_foreach_doc}
200	        {_differentiable_doc}
201	        {_fused_doc}
202	    """
203	    + r"""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/torch/optim/sgd.py:203:6
202	    """
203	    + r"""
204	
205	    Example:
206	        >>> # xdoctest: +SKIP
207	        >>> optimizer = torch.optim.SGD(model.parameters(), lr=0.1, momentum=0.9)
208	        >>> optimizer.zero_grad()
209	        >>> loss_fn(model(input), target).backward()
210	        >>> optimizer.step()
211	
212	    __ http://www.cs.toronto.edu/%7Ehinton/absps/momentum.pdf
213	
214	    .. note::
215	        The implementation of SGD with Momentum/Nesterov subtly differs from
216	        Sutskever et al. and implementations in some other frameworks.
217	
218	        Considering the specific case of Momentum, the update can be written as
219	
220	        .. math::
221	            \begin{aligned}
222	                v_{t+1} & = \mu * v_{t} + g_{t+1}, \\
223	                p_{t+1} & = p_{t} - \text{lr} * v_{t+1},
224	            \end{aligned}
225	
226	        where :math:`p`, :math:`g`, :math:`v` and :math:`\mu` denote the
227	        parameters, gradient, velocity, and momentum respectively.
228	
229	        This is in contrast to Sutskever et al. and
230	        other frameworks which employ an update of the form
231	
232	        .. math::
233	            \begin{aligned}
234	                v_{t+1} & = \mu * v_{t} + \text{lr} * g_{t+1}, \\
235	                p_{t+1} & = p_{t} - v_{t+1}.
236	            \end{aligned}
237	
238	        The Nesterov version is analogously modified.
239	
240	        Moreover, the initial value of the momentum buffer is set to the
241	        gradient value at the first step. This is in contrast to some other
242	        frameworks that initialize it to all zeros. One notable side effect
243	        of this decision is that the first momentum value will not be scaled
244	        by dampening. Dampening will be applied starting at the second step.
245	
246	    """
247	)
248	
249	
250	def sgd(
251	    params: list[Tensor],
252	    d_p_list: list[Tensor],
253	    momentum_buffer_list: list[Optional[Tensor]],
254	    # kwonly args with defaults are not supported by functions compiled with torchscript issue #70627
255	    # setting this as kwarg for now as functional API is compiled by torch/distributed/optim
256	    has_sparse_grad: bool = False,
257	    foreach: Optional[bool] = None,
258	    fused: Optional[bool] = None,
259	    grad_scale: Optional[Tensor] = None,
260	    found_inf: Optional[Tensor] = None,
261	    *,
262	    weight_decay: float,
263	    momentum: float,
264	    lr: float,
265	    dampening: float,
266	    nesterov: bool,
267	    maximize: bool,
268	):
269	    r"""Functional API that performs SGD algorithm computation.
270	
271	    See :class:`~torch.optim.SGD` for details.
272	    """
273	    # Respect when the user inputs False/True for foreach or fused. We only want to change
274	    # the default when neither have been user-specified. Note that we default to foreach
275	    # and pass False to use_fused. This is not a mistake--we want to give the fused impl
276	    # bake-in time before making it the default, even if it is typically faster.
277	    if foreach is None and fused is None:
278	        # why must we be explicit about an if statement for torch.jit.is_scripting here?
279	        # because JIT can't handle Optionals nor fancy conditionals when scripting
280	        if not torch.jit.is_scripting():
281	            fused, foreach = _default_to_fused_or_foreach(
282	                params, differentiable=False, use_fused=False
283	            )
284	        else:
285	            foreach = False
286	            fused = False
287	    if foreach is None:
288	        foreach = False
289	    if fused is None:
290	        fused = False
291	
292	    if foreach and torch.jit.is_scripting():
293	        raise RuntimeError("torch.jit.script not supported with foreach optimizers")
294	    if fused and torch.jit.is_scripting():
295	        raise RuntimeError("torch.jit.script not supported with fused optimizers")
296	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/package/package_importer.py:401:12
400	            code = self._compile_source(filename, mangled_filename)
401	            exec(code, ns)
402	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/serialization.py:1505:27
1504	                    opened_file.seek(orig_position)
1505	                    return torch.jit.load(opened_file, map_location=map_location)
1506	                if mmap:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/storage.py:534:11
533	def _load_from_bytes(b):
534	    return torch.load(io.BytesIO(b), weights_only=False)
535	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_jit.py:169:19
168	        buffer.seek(0)
169	        imported = torch.jit.load(buffer, map_location=map_location)
170	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_jit.py:176:19
175	            torch.jit.save(imported, fname)
176	            return torch.jit.load(fname, map_location=map_location)
177	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_nn.py:3447:34
3446	                    # weights_only=False as this is legacy code that saves the model
3447	                    module_copy = torch.load(f, weights_only=False)
3448	                    test_case.assertEqual(test_case._forward(module, input), test_case._forward(module_copy, input))

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_quantization.py:813:22
812	        # weights_only=False as we sometimes get a ScriptObect here (weird)
813	        loaded_dict = torch.load(b, weights_only=False)
814	        loaded_model.load_state_dict(loaded_dict)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_quantization.py:831:17
830	        # weights_only=False as this is legacy code that saves the model
831	        loaded = torch.load(b, weights_only=False)
832	        load_out = loaded(*x)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_quantization.py:890:21
889	        buffer.seek(0)
890	        loaded_mod = torch.jit.load(buffer)
891	        # Pending __get_state_ and __set_state__ support

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_quantization.py:1354:22
1353	        b.seek(0)
1354	        loaded_dict = torch.load(b)
1355	        embedding_unpack = torch.ops.quantized.embedding_bag_unpack

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py:1159:11
1158	    import xml.etree.ElementTree as ET
1159	    tree = ET.parse(xml_file)
1160	    for testcase in tree.iter('testcase'):

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py:4569:15
4568	    try:
4569	        data = request.urlopen(url, timeout=15).read()
4570	        with open(path, 'wb' if binary else 'w') as f:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:4271:40
4270	                            # weights_only=False as this is legacy code that saves the model
4271	                            model_DDP = torch.load(tmp, weights_only=False)
4272	                        else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:4275:40
4274	                            # weights_only=False as this is legacy code that saves the model
4275	                            model_DDP = torch.load(tmp.name, weights_only=False)
4276	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:4281:30
4280	                # weights_only=False as this is legacy code that saves the model
4281	                saved_model = torch.load(tmp_file, weights_only=False)
4282	            for k in model_DDP.state_dict():

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:4323:32
4322	                    # weights_only=False as this is legacy code that saves the model
4323	                    model_DDP = torch.load(tmp, weights_only=False)
4324	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:4327:32
4326	                    # weights_only=False as this is legacy code that saves the model
4327	                    model_DDP = torch.load(tmp.name, weights_only=False)
4328	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:5606:32
5605	                    # weights_only=False as this is legacy code that saves the model
5606	                    model_DDP = torch.load(tmp, weights_only=False)
5607	                else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:5610:32
5609	                    # weights_only=False as this is legacy code that saves the model
5610	                    model_DDP = torch.load(tmp.name, weights_only=False)
5611	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:5736:25
5735	            map_location = {"cuda:0": f"cuda:{self.rank:d}"}
5736	            checkpoint = torch.load(chkpt_file, map_location=map_location)
5737	            dummy_post_localSGD_opt.load_state_dict(checkpoint["optimizer_state_dict"])

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/distributed_test.py:10149:29
10148	            with self.assertLogs("torch.distributed") as captured:
10149	                checkpoint = torch.load(chkpt_file, map_location=map_location)
10150	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/distributed/rpc/jit/rpc_test.py:870:8
869	    f = io.BytesIO(pickled_script_module)
870	    m = torch.jit.load(f)
871	    return m()

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/inductor_utils.py:50:8
49	    try:
50	        CppCodeCache.load("")
51	        return not IS_FBCODE

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/jit_utils.py:56:4
55	def execWrapper(code, glob, loc):
56	    exec(code, glob, loc)
57	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/jit_utils.py:212:27
211	            debug_files_stream = (archive.open(f) for f in debug_files_str)
212	            debug_files = (pickle.load(f) for f in debug_files_stream)
213	            return code_files, debug_files

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/jit_utils.py:243:23
242	            buffer2 = io.BytesIO(buffer_copy)
243	            imported = torch.jit.load(buffer2)
244	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/jit_utils.py:275:19
274	        buffer.seek(0)
275	        imported = torch.jit.load(buffer, map_location=map_location)
276	        imported.apply(lambda s: s._unpack() if s._c._has_method('_unpack') else None)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/testing/_internal/jit_utils.py:288:21
287	            imported.save(f.name)
288	            result = torch.jit.load(f.name, map_location=map_location)
289	        finally:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/_config_module.py:619:21
618	        if not isinstance(maybe_pickled_config, dict):
619	            config = pickle.loads(maybe_pickled_config)
620	        else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/_traceback.py:113:29
112	                    )
113	                fake_frame = eval(
114	                    code,
115	                    frame.f_globals,
116	                    {**frame.f_locals, "__inspect_currentframe": inspect.currentframe},
117	                )
118	                fake_tb = TracebackType(None, fake_frame, tb.tb_lasti, tb.tb_lineno)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/benchmark/examples/compare.py:86:8
85	    comparison = benchmark_utils.Compare([
86	        pickle.loads(i) for i in serialized_results
87	    ])

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/benchmark/utils/common.py:314:15
313	    if use_dev_shm:
314	        root = "/dev/shm/pytorch_benchmark_utils"
315	        assert os.name == "posix", f"tmpfs (/dev/shm) is POSIX only, current platform is {os.name}"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/benchmark/utils/common.py:316:30
315	        assert os.name == "posix", f"tmpfs (/dev/shm) is POSIX only, current platform is {os.name}"
316	        assert os.path.exists("/dev/shm"), "This system does not appear to support tmpfs (/dev/shm)."
317	        os.makedirs(root, exist_ok=True)

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/benchmark/utils/cpp_jit.py:96:40
95	        if COMPAT_CALLGRIND_BINDINGS is None:
96	            COMPAT_CALLGRIND_BINDINGS = cpp_extension.load(
97	                name="callgrind_bindings",
98	                sources=[os.path.join(
99	                    SOURCE_ROOT,
100	                    "valgrind_wrapper",
101	                    "compat_bindings.cpp"
102	                )],
103	                extra_cflags=CXX_FLAGS,
104	                extra_include_paths=EXTRA_INCLUDE_PATHS,
105	            )
106	    return COMPAT_CALLGRIND_BINDINGS

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/benchmark/utils/cpp_jit.py:144:11
143	    # `cpp_extension` has its own locking scheme, so we don't need our lock.
144	    return cpp_extension.load(
145	        name=name,
146	        sources=[src_path],
147	        build_directory=build_dir,
148	        extra_cflags=CXX_FLAGS,
149	        extra_include_paths=EXTRA_INCLUDE_PATHS,
150	        is_python_module=not is_standalone,
151	        is_standalone=is_standalone,
152	    )
153	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/bottleneck/__main__.py:75:4
74	    prof.enable()
75	    exec(code, globs, None)
76	    prof.disable()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/bottleneck/__main__.py:96:12
95	        with profiler.profile(use_cuda=use_cuda) as prof:
96	            exec(code, globs, None)
97	        return prof

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/collect_env.py:124:8
123	    p = subprocess.Popen(
124	        command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=shell
125	    )
126	    raw_output, raw_err = p.communicate()
127	    rc = p.returncode

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1816:12
1815	        try:
1816	            subprocess.check_output(pch_cmd, shell=True, stderr=subprocess.STDOUT)
1817	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2599:8
2598	            command,
2599	            shell=IS_WINDOWS and IS_HIP_EXTENSION,
2600	            stdout=stdout_fileno if verbose else subprocess.PIPE,
2601	            stderr=subprocess.STDOUT,
2602	            cwd=build_directory,
2603	            check=True,
2604	            env=env)
2605	    except subprocess.CalledProcessError as e:
2606	        # Python 2 and 3 compatible way of getting the error object.
2607	        _, error, _ = sys.exc_info()

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/data/datapipes/datapipe.py:391:29
390	        if use_dill:
391	            self._datapipe = dill.loads(value)
392	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/data/datapipes/datapipe.py:393:29
392	        else:
393	            self._datapipe = pickle.loads(value)
394	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/data/datapipes/utils/decoder.py:74:15
73	    if extension in "pyd pickle".split():
74	        return pickle.loads(data)
75	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/data/datapipes/utils/decoder.py:78:15
77	        stream = io.BytesIO(data)
78	        return torch.load(stream)
79	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/torch/utils/model_dump/__init__.py:259:27
258	            # to ensure that we cover the entire source code.
259	            debug_info_t = pickle.loads(raw_debug)
260	            text_table = None

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/gen.py:241:17
240	        with open(path) as f:
241	            es = yaml.load(f, Loader=LineLoader)
242	            _GLOBAL_PARSE_TAGS_YAML_CACHE[path] = parse_tags_yaml_struct(es, path=path)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/gen.py:262:21
261	            with open(path) as f:
262	                es = yaml.load(f, Loader=LineLoader)
263	        else:

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/gen_backend_stubs.py:57:22
56	    with open(backend_yaml_path) as f:
57	        yaml_values = yaml.load(f, Loader=YamlLoader)
58	    assert isinstance(yaml_values, dict)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/gen_lazy_tensor.py:103:22
102	    with open(backend_yaml_path) as f:
103	        yaml_values = yaml.load(f, Loader=YamlLoader)
104	    assert isinstance(yaml_values, dict)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/packaged/autograd/gen_python_functions.py:604:26
603	    with open(deprecated_yaml_path) as f:
604	        deprecated_defs = yaml.load(f, Loader=YamlLoader)
605	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b506_yaml_load.html
   Location: ./.venv/lib/python3.12/site-packages/torchgen/packaged/autograd/load_derivatives.py:113:26
112	        with open(derivatives_yaml_path) as f:
113	            definitions = yaml.load(f, Loader=YamlLoader)
114	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/tqdm/cli.py:38:19
37	        if re.match(r"^\\\w+$", val):
38	            return eval(f'"{val}"').encode()
39	        raise TqdmTypeError(f"{val} : {typ}")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/chat.py:488:36
487	                filename = os.path.basename(args.generation_config)
488	                generation_config = GenerationConfig.from_pretrained(dirname, filename)
489	            else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/chat.py:490:36
489	            else:
490	                generation_config = GenerationConfig.from_pretrained(args.generation_config)
491	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/chat.py:554:20
553	    def load_model_and_tokenizer(self, args: ChatArguments) -> tuple["AutoModelForCausalLM", AutoTokenizer]:
554	        tokenizer = AutoTokenizer.from_pretrained(
555	            args.model_name_or_path_positional,
556	            revision=args.model_revision,
557	            trust_remote_code=args.trust_remote_code,
558	        )
559	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/chat.py:569:16
568	        }
569	        model = AutoModelForCausalLM.from_pretrained(
570	            args.model_name_or_path_positional, trust_remote_code=args.trust_remote_code, **model_kwargs
571	        )
572	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/chat.py:703:34
702	
703	        model_generation_config = GenerationConfig.from_pretrained(args.model_name_or_path)
704	        generation_config, model_kwargs = self.get_generation_parameterization(args, model_generation_config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/commands/serving.py:1605:25
1604	
1605	        data_processor = AutoProcessor.from_pretrained(
1606	            model_id,
1607	            revision=revision,
1608	            trust_remote_code=args.trust_remote_code,
1609	        )
1610	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/data/datasets/language_modeling.py:77:36
76	                with open(cached_features_file, "rb") as handle:
77	                    self.examples = pickle.load(handle)
78	                logger.info(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/data/datasets/language_modeling.py:401:36
400	                with open(cached_features_file, "rb") as handle:
401	                    self.examples = pickle.load(handle)
402	                logger.info(

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/integrations/integration_utils.py:537:19
536	            torch.distributed.broadcast_object_list(args_main_rank, src=0)
537	            args = pickle.loads(bytes(args_main_rank))
538	            for key, value in asdict(args).items():

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:526:15
525	            extra_args = {"mmap": True}
526	        return torch.load(
527	            checkpoint_file,
528	            map_location=map_location,
529	            weights_only=weights_only,
530	            **extra_args,
531	        )
532	    except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/bloom/tokenization_bloom_fast.py:121:47
120	            decoder_state = decoder_state.replace(b'"add_prefix_space":false', b'"add_prefix_space": true')
121	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
122	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/bloom/tokenization_bloom_fast.py:122:41
121	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
122	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)
123	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/cohere/tokenization_cohere_fast.py:158:47
157	            decoder_state = decoder_state.replace(b'"add_prefix_space":false', b'"add_prefix_space": true')
158	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
159	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/cohere/tokenization_cohere_fast.py:159:41
158	        self.backend_tokenizer.pre_tokenizer = pickle.loads(pre_tok_state)
159	        self.backend_tokenizer.decoder = pickle.loads(decoder_state)
160	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/deprecated/deta/modeling_deta.py:71:36
70	
71	    MultiScaleDeformableAttention = load(
72	        "MultiScaleDeformableAttention",
73	        src_files,
74	        with_cuda=True,
75	        extra_include_paths=[str(root)],
76	        extra_cflags=["-DWITH_CUDA=1"],
77	        extra_cuda_cflags=[
78	            "-DCUDA_HAS_FP16=1",
79	            "-D__CUDA_NO_HALF_OPERATORS__",
80	            "-D__CUDA_NO_HALF_CONVERSIONS__",
81	            "-D__CUDA_NO_HALF2_OPERATORS__",
82	        ],
83	    )
84	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/deprecated/realm/retrieval_realm.py:115:33
114	        else:
115	            block_records_path = hf_hub_download(
116	                repo_id=pretrained_model_name_or_path, filename=_REALM_BLOCK_RECORDS_FILENAME, **kwargs
117	            )
118	        if not strtobool(os.environ.get("TRUST_REMOTE_CODE", "False")):

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/deprecated/realm/retrieval_realm.py:128:20
127	
128	        tokenizer = AutoTokenizer.from_pretrained(pretrained_model_name_or_path, *init_inputs, **kwargs)
129	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/deprecated/transfo_xl/tokenization_transfo_xl.py:214:33
213	                with open(pretrained_vocab_file, "rb") as f:
214	                    vocab_dict = pickle.load(f)
215	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/deprecated/transfo_xl/tokenization_transfo_xl.py:802:21
801	        with open(fn, "rb") as fp:
802	            corpus = pickle.load(fp)
803	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/encoder_decoder/modeling_encoder_decoder.py:231:24
230	            #   (the change in `src/transformers/modeling_tf_utils.py`)
231	            _tf_model = TFEncoderDecoderModel.from_pretrained(pretrained_model_name_or_path, *model_args, **kwargs)
232	            config = _tf_model.config

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py:384:16
383	            raise NotImplementedError(
384	                "Only attn layer types 'global' and 'local' exist, but got `config.attention_layers`: "
385	                f"{config.attention_layers}. Select attn layer types from ['global', 'local'] only."
386	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/luke/tokenization_luke.py:361:18
360	            raise ValueError(
361	                f"Task {task} not supported. Select task from ['entity_classification', 'entity_pair_classification',"
362	                " 'entity_span_classification'] only."
363	            )

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/megatron_gpt2/checkpoint_reshaping_and_interoperability.py:564:16
563	
564	    tokenizer = AutoTokenizer.from_pretrained(tokenizer_name)
565	    tokenizer_class = type(tokenizer).__name__

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/megatron_gpt2/checkpoint_reshaping_and_interoperability.py:647:13
646	
647	    config = GPT2Config.from_pretrained(args.load_path)
648	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/mgp_str/processing_mgp_str.py:72:29
71	        self.char_tokenizer = tokenizer
72	        self.bpe_tokenizer = AutoTokenizer.from_pretrained("openai-community/gpt2")
73	        self.wp_tokenizer = AutoTokenizer.from_pretrained("google-bert/bert-base-uncased")

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/mgp_str/processing_mgp_str.py:73:28
72	        self.bpe_tokenizer = AutoTokenizer.from_pretrained("openai-community/gpt2")
73	        self.wp_tokenizer = AutoTokenizer.from_pretrained("google-bert/bert-base-uncased")
74	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/mluke/tokenization_mluke.py:305:18
304	            raise ValueError(
305	                f"Task {task} not supported. Select task from ['entity_classification', 'entity_pair_classification',"
306	                " 'entity_span_classification'] only."
307	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/mra/modeling_mra.py:56:22
55	
56	    mra_cuda_kernel = load("cuda_kernel", src_files, verbose=True)
57	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/oneformer/image_processing_oneformer.py:365:20
364	        try:
365	            fname = hf_hub_download(repo_id, class_info_file, repo_type="dataset")
366	        except RepositoryNotFoundError:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/oneformer/image_processing_oneformer.py:367:20
366	        except RepositoryNotFoundError:
367	            fname = hf_hub_download(repo_id, class_info_file)
368	

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/pix2struct/image_processing_pix2struct.py:129:15
128	    else:
129	        font = hf_hub_download(DEFAULT_FONT_PATH, "Arial.TTF")
130	    font = ImageFont.truetype(font, encoding="UTF-8", size=text_size)

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/rag/retrieval_rag.py:144:23
143	        with open(passages_path, "rb") as passages_file:
144	            passages = pickle.load(passages_file)
145	        return passages

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/rag/retrieval_rag.py:160:37
159	        with open(resolved_meta_path, "rb") as metadata_file:
160	            self.index_id_to_db_id = pickle.load(metadata_file)
161	        assert len(self.index_id_to_db_id) == self.index.ntotal, (

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/rag/retrieval_rag.py:284:18
283	        logger.info(f"Loading passages from {self.dataset_name}")
284	        dataset = load_dataset(
285	            self.dataset_name,
286	            with_index=False,
287	            split=self.dataset_split,
288	            dummy=self.use_dummy_dataset,
289	            revision=dataset_revision,
290	        )
291	        super().__init__(vector_size, dataset, index_initialized=False)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in load_dataset()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/rag/retrieval_rag.py:299:27
298	            logger.info(f"Loading index from {self.dataset_name} with index name {self.index_name}")
299	            self.dataset = load_dataset(
300	                self.dataset_name,
301	                with_embeddings=True,
302	                with_index=True,
303	                split=self.dataset_split,
304	                index_name=self.index_name,
305	                dummy=self.use_dummy_dataset,
306	                revision=self.dataset_revision,
307	            )
308	            self.dataset.set_format("numpy", columns=["embeddings"], output_all_columns=True)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/reformer/modeling_reformer.py:196:14
195	        raise NotImplementedError(
196	            f"Only attn layer types 'lsh' and 'local' exist, but `config.attn_layers`: {config.attn_layers}. Select "
197	            "attn layer types from ['lsh', 'local'] only."
198	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/reformer/modeling_reformer.py:212:14
211	        raise NotImplementedError(
212	            f"Only attn layer types 'lsh' and 'local' exist, but `config.attn_layers`: {config.attn_layers}. Select "
213	            "attn layer types from ['lsh', 'local'] only."
214	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/reformer/modeling_reformer.py:1395:18
1394	            raise NotImplementedError(
1395	                f"Only attn layer types 'lsh' and 'local' exist, but got `config.attn_layers`: {self.attn_layers}. "
1396	                "Select attn layer types from ['lsh', 'local'] only."
1397	            )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/rwkv/modeling_rwkv.py:69:23
68	    ]
69	    rwkv_cuda_kernel = load_kernel(
70	        name=f"wkv_{context_length}",
71	        sources=cuda_kernel_files,
72	        verbose=(logging.get_verbosity() == logging.DEBUG),
73	        extra_cuda_cflags=flags,
74	    )
75	    rwkv_cuda_kernel.max_seq_length = context_length

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/vision_encoder_decoder/modeling_vision_encoder_decoder.py:202:24
201	            #   (the change in `src/transformers/modeling_tf_utils.py`)
202	            _tf_model = TFVisionEncoderDecoderModel.from_pretrained(
203	                pretrained_model_name_or_path, *model_args, **kwargs
204	            )
205	            config = _tf_model.config

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/xcodec/configuration_xcodec.py:131:45
130	                # If the config is a path, load it using AutoConfig
131	                self.semantic_model_config = AutoConfig.from_pretrained(semantic_model_config["_name_or_path"])
132	            else:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/models/yoso/modeling_yoso.py:62:4
61	
62	    load("fast_lsh_cumulation", src_files, verbose=True)
63	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/pipelines/audio_classification.py:174:25
173	                # like http_huggingface_co.png
174	                inputs = requests.get(inputs).content
175	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/pipelines/automatic_speech_recognition.py:363:25
362	                # like http_huggingface_co.png
363	                inputs = requests.get(inputs).content
364	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/pipelines/video_classification.py:145:28
144	        if video.startswith("http://") or video.startswith("https://"):
145	            video = BytesIO(requests.get(video).content)
146	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/pipelines/zero_shot_audio_classification.py:114:24
113	                # like http_huggingface_co.png
114	                audio = requests.get(audio).content
115	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/safetensors_conversion.py:47:13
46	
47	    result = requests.post(sse_url, stream=True, json=data).json()
48	    event_id = result["event_id"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/safetensors_conversion.py:50:9
49	
50	    with requests.get(f"{sse_url}/{event_id}", stream=True) as sse_connection:
51	        try:

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/trainer.py:3255:35
3254	        with safe_globals():
3255	            checkpoint_rng_state = torch.load(rng_file)
3256	        random.setstate(checkpoint_rng_state["python"])

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/trainer.py:3561:48
3560	                        def opt_load_hook(mod, opt):
3561	                            opt.load_state_dict(smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True))
3562	

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/trainer.py:3568:36
3567	                                opt.load_state_dict(
3568	                                    smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True, back_compat=True)
3569	                                )

--------------------------------------------------
>> Issue: [B614:pytorch_load] Use of unsafe PyTorch load
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b614_pytorch_load.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/trainer.py:3571:52
3570	                            else:
3571	                                opt.load_state_dict(smp.load(os.path.join(checkpoint, OPTIMIZER_NAME), partial=True))
3572	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/attention_visualizer.py:183:29
182	            img = "https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/bee.jpg?download=true"
183	            img = Image.open(requests.get(img, stream=True).raw)
184	            image_seq_length = 5

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/backbone_utils.py:343:19
342	        # to determine whether to load the pretrained weights.
343	        backbone = AutoBackbone.from_pretrained(
344	            backbone_checkpoint,
345	            use_timm_backbone=use_timm_backbone,
346	            use_pretrained_backbone=use_pretrained_backbone,
347	            **backbone_kwargs,
348	        )
349	    elif use_pretrained_backbone:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/backbone_utils.py:352:19
351	            raise ValueError("config.backbone must be set if use_pretrained_backbone is True")
352	        backbone = AutoBackbone.from_pretrained(backbone_checkpoint, **backbone_kwargs)
353	    else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/backbone_utils.py:357:30
356	        if backbone_config is None:
357	            backbone_config = AutoConfig.from_pretrained(backbone_checkpoint, **backbone_kwargs)
358	        backbone = AutoBackbone.from_config(config=backbone_config)

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/hub.py:185:23
184	    try:
185	        snapshot_dir = snapshot_download(
186	            repo_id=repo_id, revision=revision, cache_dir=cache_dir, local_files_only=True
187	        )
188	    except LocalEntryNotFoundError:  # No local repo means no local files

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/hub.py:203:24
202	    try:
203	        instance_data = requests.get(os.environ["ECS_CONTAINER_METADATA_URI"]).json()
204	        dlc_container_used = instance_data["Image"]

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in hf_hub_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/hub.py:479:12
478	            # This is slightly better for only 1 file
479	            hf_hub_download(
480	                path_or_repo_id,
481	                filenames[0],
482	                subfolder=None if len(subfolder) == 0 else subfolder,
483	                repo_type=repo_type,
484	                revision=revision,
485	                cache_dir=cache_dir,
486	                user_agent=user_agent,
487	                force_download=force_download,
488	                proxies=proxies,
489	                resume_download=resume_download,
490	                token=token,
491	                local_files_only=local_files_only,
492	            )
493	        else:

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in snapshot_download()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/utils/hub.py:494:12
493	        else:
494	            snapshot_download(
495	                path_or_repo_id,
496	                allow_patterns=full_filenames,
497	                repo_type=repo_type,
498	                revision=revision,
499	                cache_dir=cache_dir,
500	                user_agent=user_agent,
501	                force_download=force_download,
502	                proxies=proxies,
503	                resume_download=resume_download,
504	                token=token,
505	                local_files_only=local_files_only,
506	            )
507	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Call to requests without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html
   Location: ./.venv/lib/python3.12/site-packages/transformers/video_utils.py:688:27
687	    elif video.startswith("http://") or video.startswith("https://"):
688	        file_obj = BytesIO(requests.get(video).content)
689	    elif os.path.isfile(video):

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/triton/language/__init__.py:312:21
311	            from triton.experimental.gluon.language.nvidia.hopper.tma import tensor_descriptor_type as gluon_tensor_descriptor_type
312	            layout = eval(layout, dict(NVMMASharedLayout=NVMMASharedLayout))
313	            assert isinstance(layout, NVMMASharedLayout)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/triton/profiler/proton.py:51:8
50	            code = compile(file.read(), script_path, 'exec')
51	        exec(code, clean_globals)
52	    except Exception as e:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/triton/runtime/interpreter.py:1372:8
1371	                fn_globals[key] = value
1372	        exec(compiled_code, fn_globals, local_namespace)
1373	        return local_namespace[self.fn.__name__]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/triton/runtime/jit.py:487:4
486	    # Execute the function string in func_namespace to create the function
487	    exec(func_body, func_namespace)
488	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/triton/tools/build_extern.py:315:24
314	        self._path = path
315	        self._ll_file = "/tmp/extern_lib.ll"
316	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/triton/tools/build_extern.py:362:88
361	    parser.add_argument("--lib-name", dest="lib_name", help="Name of the extern library")
362	    parser.add_argument("--output", dest="output_dir", help="Output file path", default="/tmp/")
363	    args = parser.parse_args()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:118:21
117	    script_content = get_completion_script(
118	        prog_name=prog_name, complete_var=complete_var, shell=shell
119	    )
120	    completion_path.write_text(script_content)
121	    return completion_path

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:146:21
145	    script_content = get_completion_script(
146	        prog_name=prog_name, complete_var=complete_var, shell=shell
147	    )
148	    path_obj.write_text(script_content)
149	    return path_obj

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:157:21
156	    script_content = get_completion_script(
157	        prog_name=prog_name, complete_var=complete_var, shell=shell
158	    )
159	    path_obj.write_text(f"{script_content}\n")
160	    return path_obj

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:199:21
198	    script_content = get_completion_script(
199	        prog_name=prog_name, complete_var=complete_var, shell=shell
200	    )
201	    with path_obj.open(mode="a") as f:
202	        f.write(f"{script_content}\n")

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:220:25
219	        installed_path = install_bash(
220	            prog_name=prog_name, complete_var=complete_var, shell=shell
221	        )
222	        return shell, installed_path
223	    elif shell == "zsh":

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:225:25
224	        installed_path = install_zsh(
225	            prog_name=prog_name, complete_var=complete_var, shell=shell
226	        )
227	        return shell, installed_path
228	    elif shell == "fish":

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:230:25
229	        installed_path = install_fish(
230	            prog_name=prog_name, complete_var=complete_var, shell=shell
231	        )
232	        return shell, installed_path
233	    elif shell in {"powershell", "pwsh"}:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/_completion_shared.py:235:25
234	        installed_path = install_powershell(
235	            prog_name=prog_name, complete_var=complete_var, shell=shell
236	        )
237	        return shell, installed_path
238	    else:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/completion.py:39:22
38	    if isinstance(value, str):
39	        shell, path = install(shell=value)
40	    else:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: ./.venv/lib/python3.12/site-packages/typer/completion.py:60:21
59	    script_content = get_completion_script(
60	        prog_name=prog_name, complete_var=complete_var, shell=shell
61	    )
62	    click.echo(script_content)
63	    sys.exit(0)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/typing_extensions.py:4034:53
4033	        return_value = {key:
4034	            value if not isinstance(value, str) else eval(value, globals, locals)
4035	            for key, value in ann.items() }

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: ./.venv/lib/python3.12/site-packages/typing_extensions.py:4116:20
4115	            code = forward_ref.__forward_code__
4116	            value = eval(code, globals, locals)
4117	        forward_ref.__forward_evaluated__ = True

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/typing_inspection/typing_objects.py:101:4
100	    globals_: dict[str, Any] = {'Any': Any, 'typing': typing, 'typing_extensions': typing_extensions}
101	    exec(func_code, globals_, locals_)
102	    return locals_[function_name]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b102_exec_used.html
   Location: ./.venv/lib/python3.12/site-packages/typing_inspection/typing_objects.py:133:4
132	    globals_: dict[str, Any] = {'Any': Any, 'typing': typing, 'typing_extensions': typing_extensions}
133	    exec(func_code, globals_, locals_)
134	    return locals_[function_name]

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: ./.venv/lib/python3.12/site-packages/uvicorn/server.py:204:19
203	            addr_format = "%s://%s:%d"
204	            host = "0.0.0.0" if config.host is None else config.host
205	            if ":" in host:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/websocket/_handshake.py:200:26
199	    value = f"{key}258EAFA5-E914-47DA-95CA-C5AB0DC85B11".encode("utf-8")
200	    hashed = base64encode(hashlib.sha1(value).digest()).strip().lower()
201	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/websocket/tests/test_ssl_edge_cases.py:350:56
349	        # Test with SSLKEYLOGFILE environment variable
350	        with patch.dict("os.environ", {"SSLKEYLOGFILE": "/tmp/ssl_keys.log"}):
351	            with patch("ssl.SSLContext") as mock_ssl_context:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: ./.venv/lib/python3.12/site-packages/websocket/tests/test_ssl_edge_cases.py:360:63
359	                # Should set keylog_filename
360	                self.assertEqual(mock_context.keylog_filename, "/tmp/ssl_keys.log")
361	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: ./.venv/lib/python3.12/site-packages/websockets/utils.py:32:11
31	    """
32	    sha1 = hashlib.sha1((key + GUID).encode()).digest()
33	    return base64.b64encode(sha1).decode()

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: ./raggy/utils/updates.py:101:17
100	
101	            with urllib.request.urlopen(api_url, timeout=UPDATE_TIMEOUT_SECONDS) as response:
102	                if response.status == 200:

--------------------------------------------------

Code scanned:
	Total lines of code: 8928004
	Total lines skipped (#nosec): 10
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 237031
		Medium: 1784
		High: 132
	Total issues (by confidence):
		Undefined: 0
		Low: 88
		Medium: 882
		High: 237977
Files skipped (0):
