============================= test session starts ==============================
platform linux -- Python 3.12.11, pytest-8.4.1, pluggy-1.6.0 -- /home/dimitri/.pyenv/versions/3.12.11/bin/python3.12
cachedir: .pytest_cache
rootdir: /home/dimitri/dev/raggy
configfile: pyproject.toml
testpaths: tests
plugins: cov-6.0.0, Faker-37.5.3, langsmith-0.3.45, xdist-3.6.0, anyio-4.10.0, mock-3.14.0, bdd-8.1.0, asyncio-1.1.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 280 items

tests/test_bm25.py::TestBM25Scorer::test_initialization PASSED           [  0%]
tests/test_bm25.py::TestBM25Scorer::test_initialization_custom_params PASSED [  0%]
tests/test_bm25.py::TestBM25Scorer::test_tokenize PASSED                 [  1%]
tests/test_bm25.py::TestBM25Scorer::test_fit_simple_documents PASSED     [  1%]
tests/test_bm25.py::TestBM25Scorer::test_fit_calculates_correct_doc_lengths PASSED [  1%]
tests/test_bm25.py::TestBM25Scorer::test_fit_calculates_idf_scores PASSED [  2%]
tests/test_bm25.py::TestBM25Scorer::test_score_simple_query PASSED       [  2%]
tests/test_bm25.py::TestBM25Scorer::test_score_multi_term_query PASSED   [  2%]
tests/test_bm25.py::TestBM25Scorer::test_score_nonexistent_query_term PASSED [  3%]
tests/test_bm25.py::TestBM25Scorer::test_score_invalid_document_index PASSED [  3%]
tests/test_bm25.py::TestBM25Scorer::test_score_relevance_ranking PASSED  [  3%]
tests/test_bm25.py::TestBM25Scorer::test_score_frequency_affects_ranking PASSED [  4%]
tests/test_bm25.py::TestBM25Scorer::test_empty_documents_list PASSED     [  4%]
tests/test_bm25.py::TestBM25Scorer::test_single_document PASSED          [  5%]
tests/test_bm25.py::TestBM25Scorer::test_different_parameters[1.0-0.5] PASSED [  5%]
tests/test_bm25.py::TestBM25Scorer::test_different_parameters[1.5-1.0] PASSED [  5%]
tests/test_bm25.py::TestBM25Scorer::test_different_parameters[2.0-0.0] PASSED [  6%]
tests/test_bm25.py::TestBM25Scorer::test_different_parameters[0.5-0.75] PASSED [  6%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_simple_short_text PASSED [  6%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_simple_long_text PASSED [  7%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_simple_respects_sentence_boundaries PASSED [  7%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_overlap PASSED [  7%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_smart_disabled_by_default PASSED [  8%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_smart_enabled PASSED [  8%]
tests/test_chunking.py::TestTextChunking::test_process_section_preserves_headers PASSED [  8%]
tests/test_chunking.py::TestTextChunking::test_process_section_calculates_header_depth PASSED [  9%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_empty_input PASSED [  9%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_whitespace_only PASSED [ 10%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_single_word PASSED [ 10%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_respects_custom_parameters PASSED [ 10%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_handles_unicode PASSED [ 11%]
tests/test_chunking.py::TestTextChunking::test_chunk_text_very_long_single_sentence PASSED [ 11%]
tests/test_chunking.py::TestTextChunking::test_chunk_metadata_consistency PASSED [ 11%]
tests/test_chunking.py::TestTextChunking::test_various_chunk_sizes[100-20] PASSED [ 12%]
tests/test_chunking.py::TestTextChunking::test_various_chunk_sizes[500-100] PASSED [ 12%]
tests/test_chunking.py::TestTextChunking::test_various_chunk_sizes[1000-200] PASSED [ 12%]
tests/test_chunking.py::TestTextChunking::test_various_chunk_sizes[2000-500] PASSED [ 13%]
tests/test_document_processing.py::TestDocumentProcessing::test_find_documents_empty_directory PASSED [ 13%]
tests/test_document_processing.py::TestDocumentProcessing::test_find_documents_creates_directory_if_missing PASSED [ 13%]
tests/test_document_processing.py::TestDocumentProcessing::test_find_documents_supported_formats PASSED [ 14%]
tests/test_document_processing.py::TestDocumentProcessing::test_find_documents_nested_directories PASSED [ 14%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_md PASSED [ 15%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_txt PASSED [ 15%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_txt_encoding_fallback PASSED [ 15%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_nonexistent_file PASSED [ 16%]
tests/test_document_processing.py::TestDocumentProcessing::test_get_file_hash PASSED [ 16%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_markdown PASSED [ 16%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_text_file PASSED [ 17%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_creates_proper_ids PASSED [ 17%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_chunk_indices PASSED [ 17%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_unsupported_format PASSED [ 18%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_empty_file PASSED [ 18%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_whitespace_only_file PASSED [ 18%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_pdf_success PASSED [ 19%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_pdf_error PASSED [ 19%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_docx_success PASSED [ 20%]
tests/test_document_processing.py::TestDocumentProcessing::test_extract_text_from_docx_with_tables PASSED [ 20%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_preserves_relative_path PASSED [ 20%]
tests/test_document_processing.py::TestDocumentProcessing::test_process_document_file_hash_consistency PASSED [ 21%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_init_quiet_mode PASSED [ 21%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_init_interactive_mode PASSED [ 21%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_vector_store_quiet_returns_chromadb PASSED [ 22%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_vector_store_default PASSED [ 22%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_vector_store_pinecone PASSED [ 22%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_vector_store_supabase PASSED [ 23%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_vector_store_invalid PASSED [ 23%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_embedding_provider_quiet_returns_st PASSED [ 23%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_embedding_provider_default PASSED [ 24%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_embedding_provider_openai PASSED [ 24%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_st_model_quiet_returns_default PASSED [ 25%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_st_model_accurate PASSED [ 25%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_openai_model_quiet_returns_default PASSED [ 25%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_select_openai_model_large PASSED [ 26%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_vector_store_config_chromadb PASSED [ 26%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_pinecone_config_quiet PASSED [ 26%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_pinecone_config_interactive PASSED [ 27%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_supabase_config_quiet PASSED [ 27%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_supabase_config_interactive PASSED [ 27%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_embedding_config_sentence_transformers PASSED [ 28%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_openai_config_quiet PASSED [ 28%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_collect_openai_config_interactive PASSED [ 28%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_get_embedding_dimension_sentence_transformers PASSED [ 29%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_get_embedding_dimension_openai PASSED [ 29%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_get_embedding_dimension_fallback PASSED [ 30%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_build_config_chromadb_st PASSED [ 30%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_build_config_pinecone_openai PASSED [ 30%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_is_env_var_placeholder_valid PASSED [ 31%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_is_env_var_placeholder_invalid PASSED [ 31%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_validate_url_valid PASSED [ 31%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_validate_url_invalid PASSED [ 32%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_validate_api_key_valid PASSED [ 32%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_validate_api_key_invalid PASSED [ 32%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_confirm_setup_quiet_returns_true PASSED [ 33%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_confirm_setup_yes PASSED [ 33%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_confirm_setup_no PASSED [ 33%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_confirm_setup_default_yes PASSED [ 34%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_write_config_creates_file PASSED [ 34%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_run_handles_keyboard_interrupt PASSED [ 35%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_run_handles_eof_error PASSED [ 35%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_run_quiet_mode_completes PASSED [ 35%]
tests/test_interactive_setup.py::TestInteractiveSetup::test_run_interactive_with_defaults PASSED [ 36%]
tests/test_interactive_setup.py::test_run_interactive_setup_success PASSED [ 36%]
tests/test_interactive_setup.py::test_run_interactive_setup_keyboard_interrupt PASSED [ 36%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_default_parameters PASSED [ 37%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_custom_parameters PASSED [ 37%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_db_dir_raises_valueerror[None] PASSED [ 37%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_db_dir_raises_valueerror[] PASSED [ 38%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_model_name_raises_valueerror[None] PASSED [ 38%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_model_name_raises_valueerror[] PASSED [ 38%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_collection_name_raises_valueerror[None] PASSED [ 39%]
tests/test_memory.py::TestMemoryManagerInitialization::test_init_with_invalid_collection_name_raises_valueerror[] PASSED [ 39%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_valid_decision_returns_memory_id PASSED [ 40%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[decision] PASSED [ 40%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[solution] PASSED [ 40%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[pattern] PASSED [ 41%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[learning] PASSED [ 41%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[error] PASSED [ 41%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_memory_types[note] PASSED [ 42%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_priorities[high] PASSED [ 42%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_priorities[medium] PASSED [ 42%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_all_priorities[low] PASSED [ 43%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_metadata PASSED [ 43%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_memory_type_raises_valueerror[invalid] PASSED [ 43%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_memory_type_raises_valueerror[unknown] PASSED [ 44%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_memory_type_raises_valueerror[memo] PASSED [ 44%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_priority_raises_valueerror[urgent] PASSED [ 45%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_priority_raises_valueerror[critical] PASSED [ 45%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_priority_raises_valueerror[low-priority] PASSED [ 45%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_empty_text_raises_valueerror[] PASSED [ 46%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_oversized_text_raises_valueerror PASSED [ 46%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_confidence_raises_valueerror[-0.1] PASSED [ 46%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_confidence_raises_valueerror[1.5] PASSED [ 47%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_confidence_raises_valueerror[2.0] PASSED [ 47%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_confidence_raises_valueerror[0.5] PASSED [ 47%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_confidence_raises_valueerror[invalid_conf4] PASSED [ 48%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_valid_confidence_values[0.0] PASSED [ 48%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_valid_confidence_values[0.5] PASSED [ 48%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_valid_confidence_values[1.0] PASSED [ 49%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_valid_confidence_values[0.95] PASSED [ 49%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_with_invalid_file_path_raises_valueerror PASSED [ 50%]
tests/test_memory.py::TestMemoryManagerAdd::test_add_captures_metadata PASSED [ 50%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_get_by_id_returns_memory PASSED [ 50%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_get_by_id_returns_none_for_nonexistent_id PASSED [ 51%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_get_by_id_with_empty_id_raises_valueerror PASSED [ 51%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_delete_removes_memory PASSED [ 51%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_delete_with_empty_id_raises_valueerror PASSED [ 52%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_count_returns_zero_for_empty_database PASSED [ 52%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_count_returns_correct_number PASSED [ 52%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_delete_all_removes_all_memories PASSED [ 53%]
tests/test_memory.py::TestMemoryManagerRetrievalAndDeletion::test_delete_all_returns_zero_for_empty_database PASSED [ 53%]
tests/test_memory.py::TestMemoryManagerArchive::test_archive_moves_old_memories PASSED [ 53%]
tests/test_memory.py::TestMemoryManagerArchive::test_archive_with_no_old_memories_returns_zero PASSED [ 54%]
tests/test_memory.py::TestMemoryManagerArchive::test_archive_with_invalid_date_raises_valueerror PASSED [ 54%]
tests/test_memory.py::TestMemoryManagerArchive::test_archive_with_empty_string_raises_valueerror PASSED [ 55%]
tests/test_memory.py::TestMemoryAPIInitialization::test_memory_init_with_defaults PASSED [ 55%]
tests/test_memory.py::TestMemoryAPIInitialization::test_memory_exposes_internal_attributes PASSED [ 55%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_returns_memory_id PASSED [ 56%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[decision] PASSED [ 56%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[solution] PASSED [ 56%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[pattern] PASSED [ 57%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[learning] PASSED [ 57%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[error] PASSED [ 57%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_memory_types[note] PASSED [ 58%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_priorities[high] PASSED [ 58%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_priorities[medium] PASSED [ 58%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_all_priorities[low] PASSED [ 59%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_invalid_memory_type_raises_error PASSED [ 59%]
tests/test_memory.py::TestMemoryAPIAdd::test_add_with_empty_text_raises_error PASSED [ 60%]
tests/test_memory.py::TestMemoryAPIRetrieval::test_get_by_id_returns_memory PASSED [ 60%]
tests/test_memory.py::TestMemoryAPIRetrieval::test_get_by_id_returns_none_for_missing_id PASSED [ 60%]
tests/test_memory.py::TestMemoryAPIRetrieval::test_count_returns_correct_number PASSED [ 61%]
tests/test_memory.py::TestMemoryAPIRetrieval::test_count_returns_zero_for_empty_database PASSED [ 61%]
tests/test_memory.py::TestMemoryAPIDeletion::test_delete_removes_memory PASSED [ 61%]
tests/test_memory.py::TestMemoryAPIDeletion::test_delete_all_removes_all_memories PASSED [ 62%]
tests/test_memory.py::TestMemoryAPIDeletion::test_delete_all_returns_zero_for_empty_database PASSED [ 62%]
tests/test_memory.py::TestMemoryAPIArchive::test_archive_returns_count PASSED [ 62%]
tests/test_memory.py::TestMemoryConvenienceFunctions::test_remember_adds_memory PASSED [ 63%]
tests/test_memory.py::TestMemoryConvenienceFunctions::test_remember_with_all_parameters PASSED [ 63%]
tests/test_memory.py::TestMemoryIntegrationWorkflows::test_add_then_delete_workflow PASSED [ 63%]
tests/test_memory.py::TestMemoryIntegrationWorkflows::test_add_multiple_memories_count PASSED [ 64%]
tests/test_memory.py::TestMemoryIntegrationWorkflows::test_multiple_adds_and_deletions PASSED [ 64%]
tests/test_memory.py::TestMemoryIntegrationWorkflows::test_memory_manager_and_api_interoperability PASSED [ 65%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_add_with_maximum_text_size PASSED [ 65%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_add_with_unicode_text PASSED [ 65%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_add_with_newlines_and_special_chars PASSED [ 66%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_add_with_confidence_boundaries PASSED [ 66%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_consecutive_deletes_and_adds PASSED [ 66%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_add_many_memories_performance PASSED [ 67%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_metadata_persistence PASSED [ 67%]
tests/test_memory_api.py::TestMemoryAPIEdgeCases::test_archive_with_valid_iso_dates PASSED [ 67%]
tests/test_memory_api.py::TestMemoryAPIValidation::test_get_context_with_empty_query_raises_error[] PASSED [ 68%]
tests/test_memory_api.py::TestMemoryAPIValidation::test_get_context_with_low_max_tokens_raises_error SKIPPED [ 68%]
tests/test_memory_api.py::TestMemoryAPIValidation::test_delete_with_invalid_id_types PASSED [ 68%]
tests/test_memory_api.py::TestMemoryAPIValidation::test_get_by_id_with_invalid_id_types PASSED [ 69%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_all_memory_types_stored_and_retrieved PASSED [ 69%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_all_priorities_stored_and_retrieved PASSED [ 70%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_memory_types_rejected[unknown] PASSED [ 70%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_memory_types_rejected[memo] PASSED [ 70%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_memory_types_rejected[event] PASSED [ 71%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_memory_types_rejected[] PASSED [ 71%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_priorities_rejected[urgent] PASSED [ 71%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_priorities_rejected[critical] PASSED [ 72%]
tests/test_memory_api.py::TestMemoryPriorityAndType::test_invalid_priorities_rejected[] PASSED [ 72%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_add_retrieve_delete_workflow PASSED [ 72%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_add_multiple_different_types PASSED [ 73%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_add_then_archive_workflow PASSED [ 73%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_add_recent_and_old_archive PASSED [ 73%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_delete_individual_then_delete_all PASSED [ 74%]
tests/test_memory_lifecycle.py::TestMemoryLifecycleWorkflows::test_count_after_operations PASSED [ 74%]
tests/test_memory_lifecycle.py::TestMemoryConvenienceFunctionWorkflows::test_remember_adds_to_persistent_database PASSED [ 75%]
tests/test_memory_lifecycle.py::TestMemoryConvenienceFunctionWorkflows::test_remember_with_all_features PASSED [ 75%]
tests/test_memory_lifecycle.py::TestMemoryConvenienceFunctionWorkflows::test_multiple_remember_calls_persist PASSED [ 75%]
tests/test_memory_lifecycle.py::TestMemoryTextHandling::test_very_long_text PASSED [ 76%]
tests/test_memory_lifecycle.py::TestMemoryTextHandling::test_text_with_multiple_languages PASSED [ 76%]
tests/test_memory_lifecycle.py::TestMemoryTextHandling::test_text_with_code_snippets PASSED [ 76%]
tests/test_memory_lifecycle.py::TestMemoryTextHandling::test_text_with_special_formatting PASSED [ 77%]
tests/test_memory_lifecycle.py::TestMemoryMetadataHandling::test_metadata_with_all_optional_fields PASSED [ 77%]
tests/test_memory_lifecycle.py::TestMemoryMetadataHandling::test_timestamp_is_accurate PASSED [ 77%]
tests/test_memory_lifecycle.py::TestMemoryMetadataHandling::test_memory_id_format PASSED [ 78%]
tests/test_memory_lifecycle.py::TestMemoryRobustness::test_repeated_deletes_of_same_memory PASSED [ 78%]
tests/test_memory_lifecycle.py::TestMemoryRobustness::test_get_nonexistent_memory_returns_none PASSED [ 78%]
tests/test_memory_lifecycle.py::TestMemoryRobustness::test_count_after_failed_operations PASSED [ 79%]
tests/test_memory_lifecycle.py::TestMemoryRobustness::test_empty_database_operations PASSED [ 79%]
tests/test_query_processor.py::TestQueryProcessor::test_initialization_default PASSED [ 80%]
tests/test_query_processor.py::TestQueryProcessor::test_initialization_custom_expansions PASSED [ 80%]
tests/test_query_processor.py::TestQueryProcessor::test_detect_type_keyword PASSED [ 80%]
tests/test_query_processor.py::TestQueryProcessor::test_detect_type_exact PASSED [ 81%]
tests/test_query_processor.py::TestQueryProcessor::test_detect_type_question PASSED [ 81%]
tests/test_query_processor.py::TestQueryProcessor::test_detect_type_boolean PASSED [ 81%]
tests/test_query_processor.py::TestQueryProcessor::test_expand_query_simple PASSED [ 82%]
tests/test_query_processor.py::TestQueryProcessor::test_expand_query_multiple_terms PASSED [ 82%]
tests/test_query_processor.py::TestQueryProcessor::test_expand_query_no_expansion_needed PASSED [ 82%]
tests/test_query_processor.py::TestQueryProcessor::test_extract_operators_negative_terms PASSED [ 83%]
tests/test_query_processor.py::TestQueryProcessor::test_extract_operators_and_terms PASSED [ 83%]
tests/test_query_processor.py::TestQueryProcessor::test_extract_operators_mixed PASSED [ 83%]
tests/test_query_processor.py::TestQueryProcessor::test_process_keyword_query PASSED [ 84%]
tests/test_query_processor.py::TestQueryProcessor::test_process_exact_phrase_query PASSED [ 84%]
tests/test_query_processor.py::TestQueryProcessor::test_process_question_query PASSED [ 85%]
tests/test_query_processor.py::TestQueryProcessor::test_process_boolean_query_with_negation PASSED [ 85%]
tests/test_query_processor.py::TestQueryProcessor::test_process_boolean_query_with_and PASSED [ 85%]
tests/test_query_processor.py::TestQueryProcessor::test_process_query_with_expansion PASSED [ 86%]
tests/test_query_processor.py::TestQueryProcessor::test_process_preserves_original_query PASSED [ 86%]
tests/test_query_processor.py::TestQueryProcessor::test_process_empty_query PASSED [ 86%]
tests/test_query_processor.py::TestQueryProcessor::test_process_whitespace_only_query PASSED [ 87%]
tests/test_query_processor.py::TestQueryProcessor::test_case_insensitive_expansion PASSED [ 87%]
tests/test_query_processor.py::TestQueryProcessor::test_custom_expansions_work PASSED [ 87%]
tests/test_query_processor.py::TestQueryProcessor::test_expansion_preserves_other_terms PASSED [ 88%]
tests/test_query_processor.py::TestQueryProcessor::test_multiple_exact_phrases_not_supported PASSED [ 88%]
tests/test_query_processor.py::TestQueryProcessor::test_malformed_quotes_handling PASSED [ 88%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[simple query-keyword] PASSED [ 89%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized["exact phrase"-exact] PASSED [ 89%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[How does this work?-question] PASSED [ 90%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[term1 AND term2-boolean] PASSED [ 90%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[term -exclude-boolean] PASSED [ 90%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[What is API?-question] PASSED [ 91%]
tests/test_query_processor.py::TestQueryProcessor::test_query_type_detection_parametrized[-keyword] PASSED [ 91%]
tests/test_raggy.py::TestUniversalRAG::test_initialization PASSED        [ 91%]
tests/test_raggy.py::TestUniversalRAG::test_initialization_with_defaults PASSED [ 92%]
tests/test_raggy.py::TestUniversalRAG::test_lazy_loading_client PASSED   [ 92%]
tests/test_raggy.py::TestUniversalRAG::test_lazy_loading_embedding_model PASSED [ 92%]
tests/test_raggy.py::TestUniversalRAG::test_get_stats_success PASSED     [ 93%]
tests/test_raggy.py::TestUniversalRAG::test_get_stats_no_database PASSED [ 93%]
tests/test_raggy.py::TestUniversalRAG::test_config_loading PASSED        [ 93%]
tests/test_raggy.py::TestUniversalRAG::test_query_processor_initialization PASSED [ 94%]
tests/test_raggy.py::TestUniversalRAG::test_scoring_normalizer_initialization PASSED [ 94%]
tests/test_raggy.py::TestScoringNormalizer::test_normalize_cosine_distance PASSED [ 95%]
tests/test_raggy.py::TestScoringNormalizer::test_normalize_hybrid_score PASSED [ 95%]
tests/test_raggy.py::TestScoringNormalizer::test_normalize_hybrid_score_custom_weight PASSED [ 95%]
tests/test_raggy.py::TestScoringNormalizer::test_interpret_score PASSED  [ 96%]
tests/test_raggy.py::TestScoringNormalizer::test_interpret_score_boundary_conditions PASSED [ 96%]
tests/test_raggy.py::TestRAGIntegration::test_build_no_documents PASSED  [ 96%]
tests/test_raggy.py::TestRAGIntegration::test_build_with_documents PASSED [ 97%]
tests/test_raggy.py::TestRAGIntegration::test_build_force_rebuild PASSED [ 97%]
tests/test_raggy.py::TestRAGIntegration::test_search_no_database PASSED  [ 97%]
tests/test_raggy.py::TestRAGIntegration::test_search_with_results PASSED [ 98%]
tests/test_raggy.py::TestRAGIntegration::test_search_hybrid_mode PASSED  [ 98%]
tests/test_raggy.py::TestRAGIntegration::test_highlight_matches PASSED   [ 98%]
tests/test_raggy.py::TestRAGIntegration::test_highlight_matches_no_match PASSED [ 99%]
tests/test_raggy.py::TestRAGIntegration::test_rerank_results_diversity PASSED [ 99%]
tests/test_raggy.py::TestRAGIntegration::test_interactive_search PASSED  [100%]/home/dimitri/.pyenv/versions/3.12.11/lib/python3.12/site-packages/pytest_cov/plugin.py:355: CovFailUnderWarning: Coverage failure: total of 40 is less than fail-under=85
  warnings.warn(CovFailUnderWarning(message), stacklevel=1)

ERROR: Coverage failure: total of 40 is less than fail-under=85


---------- coverage: platform linux, python 3.12.11-final-0 ----------
Name                                                 Stmts   Miss  Cover   Missing
----------------------------------------------------------------------------------
raggy/__init__.py                                       15      0   100%
raggy/cli/__init__.py                                    0      0   100%
raggy/cli/base.py                                        3      0   100%
raggy/cli/commands.py                                  508    451    11%   28-45, 58-66, 74-77, 85-146, 158-236, 244, 252-263, 271-286, 298-301, 313-331, 344-358, 372-375, 385-392, 402-411, 415-419, 429-431, 439, 447-449, 464-504, 517-543, 555-558, 570-573, 588-640, 653-660, 675-702, 714-717, 728-773, 790-845, 860-898, 910-947, 959-1000, 1011-1032, 1045-1053, 1066-1074, 1089-1119
raggy/cli/factory.py                                    10      4    60%   53-56
raggy/config/__init__.py                                 0      0   100%
raggy/config/cache.py                                   22     15    32%   17, 27-39, 49-55
raggy/config/constants.py                               26      0   100%
raggy/config/loader.py                                  25     15    40%   25-40, 53-61
raggy/config/raggy_config.py                           101     59    42%   74, 79-82, 89, 114-117, 122-123, 153-161, 173-193, 213-222, 231, 240, 249, 267-301
raggy/core/__init__.py                                   7      0   100%
raggy/core/chromadb_adapter.py                         117     60    49%   47-58, 79, 106-107, 120-127, 139-143, 180, 204, 232, 236, 252-257, 284-314, 357-360, 372-375, 395, 398-402, 424-441
raggy/core/database.py                                  47     27    43%   45, 61-88, 115-134
raggy/core/database_interface.py                         4      0   100%
raggy/core/document.py                                 258     63    76%   57, 60, 80, 83, 93-94, 98-100, 114-115, 121-125, 144-146, 225-228, 236-238, 408, 418, 426, 445, 466, 496, 515-529, 545-560, 578-582, 600-604
raggy/core/memory.py                                   359    132    63%   140, 157-159, 165-172, 195, 203-209, 254, 258-260, 272, 348-350, 363-367, 371-373, 442-449, 483-485, 545, 547, 594-641, 660-673, 697, 701-703, 735-737, 757-759, 783, 787-789, 837, 865, 871-873, 895-935, 1270-1301, 1524-1525
raggy/core/pinecone_adapter.py                         191    191     0%   7-578
raggy/core/rag.py                                      380    249    34%   120, 122, 124, 128, 130, 132, 138, 140, 144, 179, 200-201, 216-218, 222, 238, 256, 259-261, 265-271, 281-289, 302-308, 337, 339, 341, 345, 347, 349, 373, 383-397, 417-440, 449-463, 472-484, 493-505, 514-526, 539-545, 549-559, 568-573, 577-588, 597-605, 619-638, 647-658, 662-672, 681-689, 698-716, 725-737, 746-754, 763-777, 789-798, 871-881, 943-953
raggy/core/search.py                                   137     61    55%   67-90, 99-108, 121-132, 150-154, 178-186, 209-221, 247-258, 280-295, 304-310, 326, 400
raggy/core/supabase_adapter.py                         183    183     0%   7-623
raggy/core/vector_store_factory.py                      52     43    17%   46-147
raggy/embeddings/__init__.py                             5      0   100%
raggy/embeddings/factory.py                             21     10    52%   51-74
raggy/embeddings/openai_provider.py                     45     36    20%   41-62, 85-127, 136, 145
raggy/embeddings/provider.py                             4      0   100%
raggy/embeddings/sentence_transformers_provider.py      29      8    72%   35-36, 47-48, 72, 85-86, 104
raggy/query/__init__.py                                  0      0   100%
raggy/query/processor.py                                48      1    98%   91
raggy/scoring/__init__.py                                0      0   100%
raggy/scoring/bm25.py                                   46      0   100%
raggy/scoring/normalization.py                          19      1    95%   46
raggy/setup/__init__.py                                  0      0   100%
raggy/setup/dependencies.py                            132    109    17%   33-35, 45-51, 58-64, 73-96, 106-118, 130, 142, 154-159, 168-171, 182-210, 220-247, 262-263, 276-341
raggy/setup/environment.py                             163    146    10%   19-30, 47-95, 108-120, 133-165, 178-202, 212-227, 240-249, 263-324, 337-404, 409-419, 432-469
raggy/setup/interactive.py                             237     52    78%   127, 142-143, 204-205, 227-228, 250-251, 268-274, 300-303, 342-345, 354-357, 383-386, 414-417, 449-451, 491-493, 520-526, 533-535, 619-623
raggy/utils/__init__.py                                  0      0   100%
raggy/utils/logging.py                                  23     10    57%   21-25, 40-44, 58, 60
raggy/utils/patterns.py                                  7      0   100%
raggy/utils/security.py                                 23      5    78%   29, 37-41
raggy/utils/symbols.py                                  10      2    80%   24-25
raggy/utils/updates.py                                  67     49    27%   28-31, 40-47, 59-65, 74-86, 95-120, 132, 141-146, 150-153, 170-171
----------------------------------------------------------------------------------
TOTAL                                                 3324   1982    40%
Coverage HTML written to dir htmlcov

FAIL Required test coverage of 85% not reached. Total coverage: 40.37%

================== 279 passed, 1 skipped in 191.01s (0:03:11) ==================
